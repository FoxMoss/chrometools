import*as e from"../../core/common/common.js";import*as t from"../../core/host/host.js";import*as i from"../../core/i18n/i18n.js";import*as r from"../../ui/legacy/components/source_frame/source_frame.js";import*as o from"../../ui/legacy/legacy.js";import*as s from"../../core/platform/platform.js";import*as n from"../../core/sdk/sdk.js";import*as a from"../../ui/legacy/components/data_grid/data_grid.js";import*as l from"../mobile_throttling/mobile_throttling.js";import*as d from"../settings/emulation/components/components.js";import*as c from"../../models/bindings/bindings.js";import*as h from"../../models/logs/logs.js";import*as u from"../../models/workspace/workspace.js";import*as p from"./forward/forward.js";import*as m from"../../ui/legacy/components/perf_ui/perf_ui.js";import*as g from"../../ui/legacy/components/utils/utils.js";import{imageNameForResourceType as w}from"../utils/utils.js";import*as v from"../../core/root/root.js";import*as b from"./components/components.js";import*as k from"../../ui/legacy/components/cookie_table/cookie_table.js";import*as f from"../../models/issues_manager/issues_manager.js";import*as C from"../../models/persistence/persistence.js";import*as S from"../../third_party/chromium/client-variations/client-variations.js";import*as T from"../sources/sources.js";import*as y from"../../ui/legacy/components/object_ui/object_ui.js";import*as R from"../../models/text_utils/text_utils.js";import*as I from"../../ui/lit-html/lit-html.js";import*as x from"../../ui/components/helpers/helpers.js";import*as q from"../../ui/components/icon_button/icon_button.js";import*as F from"../../ui/components/data_grid/data_grid.js";import*as L from"../../models/har/har.js";import*as H from"../../ui/legacy/theme_support/theme_support.js";import*as P from"../search/search.js";const E=new CSSStyleSheet;E.replaceSync(".panel.network .toolbar.binary-view-toolbar{border-top:1px solid var(--color-details-hairline);border-bottom:0;padding-left:5px}.binary-view-copied-text{opacity:100%}.binary-view-copied-text.fadeout{opacity:0%;transition:opacity 1s}\n/*# sourceURL=binaryResourceView.css */\n");const M={copiedAsBase:"Copied as `Base64`",hexViewer:"`Hex` Viewer",copiedAsHex:"Copied as `Hex`",copiedAsUtf:"Copied as `UTF-8`",binaryViewType:"Binary view type",copyToClipboard:"Copy to clipboard",copyAsBase:"Copy as `Base64`",copyAsHex:"Copy as `Hex`",copyAsUtf:"Copy as `UTF-8`"},U=i.i18n.registerUIStrings("panels/network/BinaryResourceView.ts",M),N=i.i18n.getLocalizedString.bind(void 0,U);class A extends o.Widget.VBox{binaryResourceViewFactory;toolbar;binaryViewObjects;binaryViewTypeSetting;binaryViewTypeCombobox;copiedText;addFadeoutSettimeoutId;lastView;constructor(t,s,n){super(),this.binaryResourceViewFactory=new r.BinaryResourceViewFactory.BinaryResourceViewFactory(t,s,n),this.toolbar=new o.Toolbar.Toolbar("binary-view-toolbar",this.element),this.binaryViewObjects=[new B("base64",i.i18n.lockedString("Base64"),N(M.copiedAsBase),this.binaryResourceViewFactory.createBase64View.bind(this.binaryResourceViewFactory),this.binaryResourceViewFactory.base64.bind(this.binaryResourceViewFactory)),new B("hex",N(M.hexViewer),N(M.copiedAsHex),this.binaryResourceViewFactory.createHexView.bind(this.binaryResourceViewFactory),this.binaryResourceViewFactory.hex.bind(this.binaryResourceViewFactory)),new B("utf8",i.i18n.lockedString("UTF-8"),N(M.copiedAsUtf),this.binaryResourceViewFactory.createUtf8View.bind(this.binaryResourceViewFactory),this.binaryResourceViewFactory.utf8.bind(this.binaryResourceViewFactory))],this.binaryViewTypeSetting=e.Settings.Settings.instance().createSetting("binaryViewType","hex"),this.binaryViewTypeCombobox=new o.Toolbar.ToolbarComboBox(this.binaryViewTypeChanged.bind(this),N(M.binaryViewType));for(const e of this.binaryViewObjects)this.binaryViewTypeCombobox.addOption(this.binaryViewTypeCombobox.createOption(e.label,e.type));this.toolbar.appendToolbarItem(this.binaryViewTypeCombobox);const a=new o.Toolbar.ToolbarButton(N(M.copyToClipboard),"largeicon-copy");a.addEventListener(o.Toolbar.ToolbarButton.Events.Click,(e=>{this.copySelectedViewToClipboard()}),this),this.toolbar.appendToolbarItem(a),this.copiedText=new o.Toolbar.ToolbarText,this.copiedText.element.classList.add("binary-view-copied-text"),this.toolbar.element.appendChild(this.copiedText.element),this.addFadeoutSettimeoutId=null,this.lastView=null,this.updateView()}getCurrentViewObject(){const e=this.binaryViewObjects.find((e=>e.type===this.binaryViewTypeSetting.get()));return console.assert(Boolean(e),`No binary view found for binary view type found in setting 'binaryViewType': ${this.binaryViewTypeSetting.get()}`),e||null}async copySelectedViewToClipboard(){const e=this.getCurrentViewObject();e&&(t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText((await e.content()).content),this.copiedText.setText(e.copiedMessage),this.copiedText.element.classList.remove("fadeout"),this.addFadeoutSettimeoutId&&(clearTimeout(this.addFadeoutSettimeoutId),this.addFadeoutSettimeoutId=null),this.addFadeoutSettimeoutId=window.setTimeout(function(){this.copiedText.element.classList.add("fadeout")}.bind(this),2e3))}wasShown(){this.updateView(),this.registerCSSFiles([E])}updateView(){const e=this.getCurrentViewObject();if(!e)return;const t=e.getView();t!==this.lastView&&(this.lastView&&this.lastView.detach(),this.lastView=t,t.show(this.element,this.toolbar.element),this.binaryViewTypeCombobox.selectElement().value=this.binaryViewTypeSetting.get())}binaryViewTypeChanged(){const e=this.binaryViewTypeCombobox.selectedOption();if(!e)return;const t=e.value;this.binaryViewTypeSetting.get()!==t&&(this.binaryViewTypeSetting.set(t),this.updateView())}addCopyToContextMenu(e,i){const r=e.clipboardSection().appendSubMenuItem(i).footerSection();r.appendItem(N(M.copyAsBase),(async()=>{const e=await this.binaryResourceViewFactory.base64();t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(e.content)})),r.appendItem(N(M.copyAsHex),(async()=>{const e=await this.binaryResourceViewFactory.hex();t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(e.content)})),r.appendItem(N(M.copyAsUtf),(async()=>{const e=await this.binaryResourceViewFactory.utf8();t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(e.content)}))}}class B{type;label;copiedMessage;content;createViewFn;view;constructor(e,t,i,r,o){this.type=e,this.label=t,this.copiedMessage=i,this.content=o,this.createViewFn=r,this.view=null}getView(){return this.view||(this.view=this.createViewFn()),this.view}}var V=Object.freeze({__proto__:null,BinaryResourceView:A,BinaryViewObject:B});const W=new CSSStyleSheet;W.replaceSync(".list{border:none!important;border-top:1px solid var(--color-details-hairline)!important}.blocking-disabled{opacity:80%}.editor-container{padding:0 4px}.no-blocked-urls,\n.blocked-urls{overflow-x:hidden;overflow-y:auto}.no-blocked-urls{display:flex;justify-content:center;padding:10px}.no-blocked-urls > span{white-space:pre}.blocked-url{display:flex;flex-direction:row;align-items:center;flex:auto}.blocked-url-count{flex:none;padding-right:9px}.blocked-url-checkbox{margin-left:8px;flex:none}.blocked-url-checkbox:focus{outline:auto 5px -webkit-focus-ring-color}.blocked-url-label{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;flex:auto;padding:0 3px}.blocked-url-edit-row{flex:none;display:flex;flex-direction:row;margin:7px 5px 0;align-items:center}.blocked-url-edit-value{user-select:none;flex:1 1 0}.blocked-url-edit-row input{width:100%;text-align:inherit;height:22px}\n/*# sourceURL=blockedURLsPane.css */\n");const O={enableNetworkRequestBlocking:"Enable network request blocking",addPattern:"Add pattern",removeAllPatterns:"Remove all patterns",addNetworkRequestBlockingPattern:"Add network request blocking pattern",networkRequestsAreNotBlockedS:"Network requests are not blocked. {PH1}",dBlocked:"{PH1} blocked",textPatternToBlockMatching:"Text pattern to block matching requests; use * for wildcard",patternInputCannotBeEmpty:"Pattern input cannot be empty.",patternAlreadyExists:"Pattern already exists.",itemDeleted:"Item successfully deleted"},D=i.i18n.registerUIStrings("panels/network/BlockedURLsPane.ts",O),G=i.i18n.getLocalizedString.bind(void 0,D);let z=null;class _ extends o.Widget.VBox{manager;toolbar;enabledCheckbox;list;editor;blockedCountForUrl;updateThrottler;constructor(){super(!0),this.manager=n.NetworkManager.MultitargetNetworkManager.instance(),this.manager.addEventListener(n.NetworkManager.MultitargetNetworkManager.Events.BlockedPatternsChanged,(()=>{this.update()}),this),this.toolbar=new o.Toolbar.Toolbar("",this.contentElement),this.enabledCheckbox=new o.Toolbar.ToolbarCheckbox(G(O.enableNetworkRequestBlocking),void 0,this.toggleEnabled.bind(this)),this.toolbar.appendToolbarItem(this.enabledCheckbox),this.toolbar.appendSeparator();const t=new o.Toolbar.ToolbarButton(G(O.addPattern),"largeicon-add");t.addEventListener(o.Toolbar.ToolbarButton.Events.Click,this.addButtonClicked,this),this.toolbar.appendToolbarItem(t);const i=new o.Toolbar.ToolbarButton(G(O.removeAllPatterns),"largeicon-clear");i.addEventListener(o.Toolbar.ToolbarButton.Events.Click,this.removeAll,this),this.toolbar.appendToolbarItem(i),this.list=new o.ListWidget.ListWidget(this),this.list.element.classList.add("blocked-urls"),this.list.setEmptyPlaceholder(this.createEmptyPlaceholder()),this.list.show(this.contentElement),this.editor=null,this.blockedCountForUrl=new Map,n.TargetManager.TargetManager.instance().addModelListener(n.NetworkManager.NetworkManager,n.NetworkManager.Events.RequestFinished,this.onRequestFinished,this),this.updateThrottler=new e.Throttler.Throttler(200),this.update()}static instance(e={forceNew:null}){const{forceNew:t}=e;return z&&!t||(z=new _),z}createEmptyPlaceholder(){const e=this.contentElement.createChild("div","no-blocked-urls"),t=o.UIUtils.createTextButton(G(O.addPattern),this.addButtonClicked.bind(this),"add-button");return o.ARIAUtils.setAccessibleName(t,G(O.addNetworkRequestBlockingPattern)),e.appendChild(i.i18n.getFormatLocalizedString(D,O.networkRequestsAreNotBlockedS,{PH1:t})),e}static reset(){z&&z.reset()}addButtonClicked(){this.manager.setBlockingEnabled(!0),this.list.addNewItem(0,{url:s.DevToolsPath.EmptyUrlString,enabled:!0})}renderItem(e,t){const i=this.blockedRequestsCount(e.url),r=document.createElement("div");r.classList.add("blocked-url");const o=r.createChild("input","blocked-url-checkbox");return o.type="checkbox",o.checked=e.enabled,o.disabled=!t,r.createChild("div","blocked-url-label").textContent=e.url,r.createChild("div","blocked-url-count").textContent=G(O.dBlocked,{PH1:i}),t&&(r.addEventListener("click",(t=>this.togglePattern(e,t))),o.addEventListener("click",(t=>this.togglePattern(e,t)))),r}togglePattern(e,t){t.consume(!0);const i=this.manager.blockedPatterns();i.splice(i.indexOf(e),1,{enabled:!e.enabled,url:e.url}),this.manager.setBlockedPatterns(i)}toggleEnabled(){this.manager.setBlockingEnabled(!this.manager.blockingEnabled()),this.update()}removeItemRequested(e,t){const i=this.manager.blockedPatterns();i.splice(t,1),this.manager.setBlockedPatterns(i),o.ARIAUtils.alert(O.itemDeleted)}beginEdit(e){return this.editor=this.createEditor(),this.editor.control("url").value=e.url,this.editor}commitEdit(e,t,i){const r=t.control("url").value,o=this.manager.blockedPatterns();i?o.push({enabled:!0,url:r}):o.splice(o.indexOf(e),1,{enabled:!0,url:r}),this.manager.setBlockedPatterns(o)}createEditor(){if(this.editor)return this.editor;const e=new o.ListWidget.Editor,t=e.contentElement();t.createChild("div","blocked-url-edit-row").createChild("div").textContent=G(O.textPatternToBlockMatching);const i=t.createChild("div","blocked-url-edit-row"),r=e.createInput("url","text","",((e,t,i)=>{let r,o=!0;return i.value?this.manager.blockedPatterns().find((e=>e.url===i.value))&&(r=G(O.patternAlreadyExists),o=!1):(r=G(O.patternInputCannotBeEmpty),o=!1),{valid:o,errorMessage:r}}));return i.createChild("div","blocked-url-edit-value").appendChild(r),e}removeAll(){this.manager.setBlockedPatterns([])}update(){const e=this.manager.blockingEnabled();this.list.element.classList.toggle("blocking-disabled",!e&&Boolean(this.manager.blockedPatterns().length)),this.enabledCheckbox.setChecked(e),this.list.clear();for(const t of this.manager.blockedPatterns())this.list.appendItem(t,e);return Promise.resolve()}blockedRequestsCount(e){if(!e)return 0;let t=0;for(const i of this.blockedCountForUrl.keys())this.matches(e,i)&&(t+=this.blockedCountForUrl.get(i));return t}matches(e,t){let i=0;const r=e.split("*");for(let e=0;e<r.length;e++){const o=r[e];if(o.length){if(i=t.indexOf(o,i),-1===i)return!1;i+=o.length}}return!0}reset(){this.blockedCountForUrl.clear(),this.updateThrottler.schedule(this.update.bind(this))}onRequestFinished(e){const t=e.data;if(t.wasBlocked()){const e=this.blockedCountForUrl.get(t.url())||0;this.blockedCountForUrl.set(t.url(),e+1),this.updateThrottler.schedule(this.update.bind(this))}}wasShown(){super.wasShown(),this.list.registerCSSFiles([W]),this.registerCSSFiles([W])}}var j=Object.freeze({__proto__:null,get blockedURLsPaneInstance(){return z},BlockedURLsPane:_});const K=new CSSStyleSheet;K.replaceSync(".event-source-messages-view .data-grid{flex:auto;border:none}\n/*# sourceURL=eventSourceMessagesView.css */\n");const $={id:"Id",type:"Type",data:"Data",time:"Time",eventSource:"Event Source",copyMessage:"Copy message"},X=i.i18n.registerUIStrings("panels/network/EventSourceMessagesView.ts",$),J=i.i18n.getLocalizedString.bind(void 0,X);class Y extends o.Widget.VBox{request;dataGrid;constructor(e){super(),this.element.classList.add("event-source-messages-view"),this.request=e;const t=[{id:"id",title:J($.id),sortable:!0,weight:8},{id:"type",title:J($.type),sortable:!0,weight:8},{id:"data",title:J($.data),sortable:!1,weight:88},{id:"time",title:J($.time),sortable:!0,weight:8}];this.dataGrid=new a.SortableDataGrid.SortableDataGrid({displayName:J($.eventSource),columns:t,editCallback:void 0,deleteCallback:void 0,refreshCallback:void 0}),this.dataGrid.setStriped(!0),this.dataGrid.setStickToBottom(!0),this.dataGrid.setRowContextMenuCallback(this.onRowContextMenu.bind(this)),this.dataGrid.markColumnAsSortedBy("time",a.DataGrid.Order.Ascending),this.sortItems(),this.dataGrid.addEventListener(a.DataGrid.Events.SortingChanged,this.sortItems,this),this.dataGrid.setName("EventSourceMessagesView"),this.dataGrid.asWidget().show(this.element)}wasShown(){this.dataGrid.rootNode().removeChildren(),this.registerCSSFiles([K]);const e=this.request.eventSourceMessages();for(let t=0;t<e.length;++t)this.dataGrid.insertChild(new Q(e[t]));this.request.addEventListener(n.NetworkRequest.Events.EventSourceMessageAdded,this.messageAdded,this)}willHide(){this.request.removeEventListener(n.NetworkRequest.Events.EventSourceMessageAdded,this.messageAdded,this)}messageAdded(e){const t=e.data;this.dataGrid.insertChild(new Q(t))}sortItems(){const e=this.dataGrid.sortColumnId();if(!e)return;const t=ee[e];t&&this.dataGrid.sortNodes(t,!this.dataGrid.isSortOrderAscending())}onRowContextMenu(e,i){e.clipboardSection().appendItem(J($.copyMessage),t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText.bind(t.InspectorFrontendHost.InspectorFrontendHostInstance,i.data.data))}}class Q extends a.SortableDataGrid.SortableDataGridNode{message;constructor(e){const t=new Date(1e3*e.time),i=("0"+t.getHours()).substr(-2)+":"+("0"+t.getMinutes()).substr(-2)+":"+("0"+t.getSeconds()).substr(-2)+"."+("00"+t.getMilliseconds()).substr(-3),r=document.createElement("div");o.UIUtils.createTextChild(r,i),o.Tooltip.Tooltip.install(r,t.toLocaleString()),super({id:e.eventId,type:e.eventName,data:e.data,time:r}),this.message=e}}function Z(e,t,i){const r=e(t.message),o=e(i.message);return r<o?-1:r>o?1:0}const ee={id:Z.bind(null,(e=>e.eventId)),type:Z.bind(null,(e=>e.eventName)),time:Z.bind(null,(e=>e.time))};var te=Object.freeze({__proto__:null,EventSourceMessagesView:Y,EventSourceMessageNode:Q,EventSourceMessageNodeComparator:Z,Comparators:ee});const ie=new CSSStyleSheet;ie.replaceSync('.network-config{padding:12px;display:block}.network-config-group{display:flex;margin-bottom:10px;flex-wrap:wrap;flex:0 0 auto;min-height:30px}.network-config-title{margin-right:16px;width:130px}.network-config-fields{flex:2 0 200px}.panel-section-separator{height:1px;margin-bottom:10px;background:var(--color-details-hairline)}.network-config-disable-cache{line-height:28px;border-top:none;padding-top:0}.network-config-input-validation-error{color:var(--legacy-input-validation-error);margin:5px 0}.network-config-input-validation-error:empty{display:none}.network-config-throttling .chrome-select{width:100%;max-width:250px}.network-config-throttling > .network-config-title{line-height:24px}.network-config-ua > .network-config-title{line-height:20px}.network-config-ua span[is="dt-radio"].checked > *{display:none}.network-config-ua input{display:block;width:calc(100% - 20px)}.network-config-ua input[type="text"],\n.network-config-ua .chrome-select{margin-top:8px}.network-config-ua .chrome-select{width:calc(100% - 20px);max-width:250px}.network-config-ua span[is="dt-radio"]{display:block}.network-config-ua-custom{opacity:50%;padding-bottom:8px}.network-config-ua-custom.checked{opacity:100%}.client-hints-form{margin-top:14px;width:min(100%,400px)}.status-text{padding:10px;color:var(--color-accent-green)}\n/*# sourceURL=networkConfigView.css */\n');const re={custom:"Custom...",enterACustomUserAgent:"Enter a custom user agent",customUserAgentFieldIsRequired:"Custom user agent field is required",caching:"Caching",disableCache:"Disable cache",networkThrottling:"Network throttling",userAgent:"User agent",selectAutomatically:"Use browser default",acceptedEncoding:"Accepted `Content-Encoding`s",clientHintsStatusText:"User agent updated.",networkConditionsPanelShown:"Network conditions shown"},oe=i.i18n.registerUIStrings("panels/network/NetworkConfigView.ts",re),se=i.i18n.getLocalizedString.bind(void 0,oe);let ne;class ae extends o.Widget.VBox{constructor(){super(!0),this.contentElement.classList.add("network-config"),this.createCacheSection(),this.contentElement.createChild("div").classList.add("panel-section-separator"),this.createNetworkThrottlingSection(),this.contentElement.createChild("div").classList.add("panel-section-separator"),this.createUserAgentSection(),this.contentElement.createChild("div").classList.add("panel-section-separator"),this.createAcceptedEncodingSection()}static instance(e={forceNew:null}){const{forceNew:t}=e;return ne&&!t||(ne=new ae),ne}static createUserAgentSelectAndInput(t){const i=e.Settings.Settings.instance().createSetting("customUserAgent",""),r=e.Settings.Settings.instance().createSetting("customUserAgentMetadata",null),s=document.createElement("select");o.ARIAUtils.setAccessibleName(s,t);const a={title:se(re.custom),value:"custom"};s.appendChild(new Option(a.title,a.value));for(const e of de){const t=s.createChild("optgroup");t.label=e.title;for(const i of e.values){const e=n.NetworkManager.MultitargetNetworkManager.patchUserAgentWithChromeVersion(i.value);t.appendChild(new Option(i.title,e))}}s.selectedIndex=0;const l=o.UIUtils.createInput("","text");l.value=i.get(),o.Tooltip.Tooltip.install(l,i.get()),l.placeholder=se(re.enterACustomUserAgent),l.required=!0,o.ARIAUtils.setAccessibleName(l,l.placeholder);const d=document.createElement("div");function c(){const e=i.get(),t=s.options;let r=!1;for(let i=0;i<t.length;++i)if(t[i].value===e){s.selectedIndex=i,r=!0;break}r||(s.selectedIndex=0)}return d.classList.add("network-config-input-validation-error"),o.ARIAUtils.markAsAlert(d),l.value||(d.textContent=se(re.customUserAgentFieldIsRequired)),c(),s.addEventListener("change",(function(){const e=s.options[s.selectedIndex].value;if(e!==a.value){i.set(e),l.value=e,o.Tooltip.Tooltip.install(l,e);const t=le(e);r.set(t),n.NetworkManager.MultitargetNetworkManager.instance().setCustomUserAgentOverride(e,t)}else r.set(null),l.select();d.textContent="";const t=new CustomEvent("user-agent-change",{detail:{value:e}});s.dispatchEvent(t)}),!1),l.addEventListener("input",(function(){i.get()!==l.value&&(l.value?d.textContent="":d.textContent=se(re.customUserAgentFieldIsRequired),i.set(l.value),o.Tooltip.Tooltip.install(l,l.value),c())}),!1),{select:s,input:l,error:d}}createSection(e,t){const i=this.contentElement.createChild("section","network-config-group");return t&&i.classList.add(t),i.createChild("div","network-config-title").textContent=e,i.createChild("div","network-config-fields")}createCacheSection(){this.createSection(se(re.caching),"network-config-disable-cache").appendChild(o.SettingsUI.createSettingCheckbox(se(re.disableCache),e.Settings.Settings.instance().moduleSetting("cacheDisabled"),!0))}createNetworkThrottlingSection(){const e=se(re.networkThrottling),t=this.createSection(e,"network-config-throttling").createChild("select","chrome-select");l.ThrottlingManager.throttlingManager().decorateSelectWithNetworkThrottling(t),o.ARIAUtils.setAccessibleName(t,e)}createUserAgentSection(){const t=se(re.userAgent),i=this.createSection(t,"network-config-ua"),r=o.UIUtils.CheckboxLabel.create(se(re.selectAutomatically),!0);i.appendChild(r);const s=r.checkboxElement,a=e.Settings.Settings.instance().createSetting("customUserAgentMetadata",null),l=e.Settings.Settings.instance().createSetting("customUserAgent","");l.addChangeListener((()=>{if(s.checked)return;const e=l.get(),t=le(e);n.NetworkManager.MultitargetNetworkManager.instance().setCustomUserAgentOverride(e,t)}));const c=i.createChild("div","network-config-ua-custom");s.addEventListener("change",v);const h=ae.createUserAgentSelectAndInput(t);h.select.classList.add("chrome-select"),c.appendChild(h.select),c.appendChild(h.input),c.appendChild(h.error);const u=c.createChild("div","client-hints-form"),p=new d.UserAgentClientHintsForm.UserAgentClientHintsForm,m=a.get(),g=le(h.select.value);p.value={showMobileCheckbox:!0,showSubmitButton:!0,metaData:m||g||void 0},u.appendChild(p),h.select.addEventListener("user-agent-change",(e=>{const t=e.detail.value,i=t?le(t):null;p.value={metaData:i||void 0,showMobileCheckbox:!0,showSubmitButton:!0},w.textContent=""})),p.addEventListener("clienthintschange",(()=>{h.select.value="custom",w.textContent=""})),p.addEventListener("clienthintssubmit",(e=>{const t=e.detail.value,i=l.get();a.set(t),n.NetworkManager.MultitargetNetworkManager.instance().setCustomUserAgentOverride(i,t),w.textContent=se(re.clientHintsStatusText)}));const w=i.createChild("span","status-text");function v(){const e=!s.checked;c.classList.toggle("checked",e),h.select.disabled=!e,h.input.disabled=!e,h.error.hidden=!e,p.disabled=!e;const t=e?l.get():"",i=e?le(t):null;n.NetworkManager.MultitargetNetworkManager.instance().setCustomUserAgentOverride(t,i)}w.textContent="",v()}createAcceptedEncodingSection(){const t=se(re.acceptedEncoding),i=this.createSection(t,"network-config-accepted-encoding"),r=o.UIUtils.CheckboxLabel.create(se(re.selectAutomatically),!0);i.appendChild(r);const s=r.checkboxElement,a=e.Settings.Settings.instance().createSetting("useCustomAcceptedEncodings",!1),l=e.Settings.Settings.instance().createSetting("customAcceptedEncodings","gzip,br,deflate");function d(){a.get()?n.NetworkManager.MultitargetNetworkManager.instance().setCustomAcceptedEncodingsOverride(""===l.get()?[]:l.get().split(",")):n.NetworkManager.MultitargetNetworkManager.instance().clearCustomAcceptedEncodingsOverride()}l.addChangeListener(d),a.addChangeListener(d);const c=i.createChild("div","network-config-accepted-encoding-custom");s.checked=!a.get(),s.addEventListener("change",p);const h=new Map,u={Deflate:"deflate",Gzip:"gzip",Br:"br"};for(const e of Object.values(u)){const t=o.UIUtils.CheckboxLabel.create(e,!0);c.appendChild(t),h.set(e,t.checkboxElement)}for(const[e,t]of h)t.checked=l.get().includes(e),t.addEventListener("change",p);function p(){a.set(!s.checked);const e=[];for(const[t,i]of h)i.disabled=s.checked,i.checked&&e.push(t);l.set(e.join(","))}p()}wasShown(){super.wasShown(),this.registerCSSFiles([ie]),o.ARIAUtils.alert(se(re.networkConditionsPanelShown))}}function le(e){for(const t of de)for(const i of t.values)if(e===n.NetworkManager.MultitargetNetworkManager.patchUserAgentWithChromeVersion(i.value))return i.metadata?(n.NetworkManager.MultitargetNetworkManager.patchUserAgentMetadataWithChromeVersion(i.metadata),i.metadata):null;return null}const de=[{title:"Android",values:[{title:"Android (4.0.2) Browser — Galaxy Nexus",value:"Mozilla/5.0 (Linux; U; Android 4.0.2; en-us; Galaxy Nexus Build/ICL53F) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"Android",platformVersion:"4.0.2",architecture:"",model:"Galaxy Nexus",mobile:!0}},{title:"Android (2.3) Browser — Nexus S",value:"Mozilla/5.0 (Linux; U; Android 2.3.6; en-us; Nexus S Build/GRK39F) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"Android",platformVersion:"2.3.6",architecture:"",model:"Nexus S",mobile:!0}}]},{title:"BlackBerry",values:[{title:"BlackBerry — BB10",value:"Mozilla/5.0 (BB10; Touch) AppleWebKit/537.1+ (KHTML, like Gecko) Version/10.0.0.1337 Mobile Safari/537.1+",metadata:null},{title:"BlackBerry — PlayBook 2.1",value:"Mozilla/5.0 (PlayBook; U; RIM Tablet OS 2.1.0; en-US) AppleWebKit/536.2+ (KHTML, like Gecko) Version/7.2.1.0 Safari/536.2+",metadata:null},{title:"BlackBerry — 9900",value:"Mozilla/5.0 (BlackBerry; U; BlackBerry 9900; en-US) AppleWebKit/534.11+ (KHTML, like Gecko) Version/7.0.0.187 Mobile Safari/534.11+",metadata:null}]},{title:"Chrome",values:[{title:"Chrome — Android Mobile",value:"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Mobile Safari/537.36",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"Android",platformVersion:"6.0",architecture:"",model:"Nexus 5",mobile:!0}},{title:"Chrome — Android Mobile (high-end)",value:"Mozilla/5.0 (Linux; Android 10; Pixel 4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Mobile Safari/537.36",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"Android",platformVersion:"10",architecture:"",model:"Pixel 4",mobile:!0}},{title:"Chrome — Android Tablet",value:"Mozilla/5.0 (Linux; Android 4.3; Nexus 7 Build/JSS15Q) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Safari/537.36",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"Android",platformVersion:"4.3",architecture:"",model:"Nexus 7",mobile:!0}},{title:"Chrome — iPhone",value:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/%s Mobile/15E148 Safari/604.1",metadata:null},{title:"Chrome — iPad",value:"Mozilla/5.0 (iPad; CPU OS 13_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/%s Mobile/15E148 Safari/604.1",metadata:null},{title:"Chrome — Chrome OS",value:"Mozilla/5.0 (X11; CrOS x86_64 10066.0.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Safari/537.36",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"Chrome OS",platformVersion:"10066.0.0",architecture:"x86",model:"",mobile:!1}},{title:"Chrome — Mac",value:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Safari/537.36",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"macOS",platformVersion:"10_14_6",architecture:"x86",model:"",mobile:!1}},{title:"Chrome — Windows",value:"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Safari/537.36",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"Windows",platformVersion:"10.0",architecture:"x86",model:"",mobile:!1}}]},{title:"Firefox",values:[{title:"Firefox — Android Mobile",value:"Mozilla/5.0 (Android 4.4; Mobile; rv:70.0) Gecko/70.0 Firefox/70.0",metadata:null},{title:"Firefox — Android Tablet",value:"Mozilla/5.0 (Android 4.4; Tablet; rv:70.0) Gecko/70.0 Firefox/70.0",metadata:null},{title:"Firefox — iPhone",value:"Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) FxiOS/1.0 Mobile/12F69 Safari/600.1.4",metadata:null},{title:"Firefox — iPad",value:"Mozilla/5.0 (iPad; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) FxiOS/1.0 Mobile/12F69 Safari/600.1.4",metadata:null},{title:"Firefox — Mac",value:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:70.0) Gecko/20100101 Firefox/70.0",metadata:null},{title:"Firefox — Windows",value:"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:70.0) Gecko/20100101 Firefox/70.0",metadata:null}]},{title:"Googlebot",values:[{title:"Googlebot",value:"Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)",metadata:null},{title:"Googlebot Desktop",value:"Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko; compatible; Googlebot/2.1; +http://www.google.com/bot.html) Chrome/%s Safari/537.36",metadata:null},{title:"Googlebot Smartphone",value:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 5X Build/MMB29P) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Mobile Safari/537.36 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)",metadata:null}]},{title:"Internet Explorer",values:[{title:"Internet Explorer 11",value:"Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko",metadata:null},{title:"Internet Explorer 10",value:"Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; WOW64; Trident/6.0)",metadata:null},{title:"Internet Explorer 9",value:"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)",metadata:null},{title:"Internet Explorer 8",value:"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)",metadata:null},{title:"Internet Explorer 7",value:"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)",metadata:null}]},{title:"Microsoft Edge",values:[{title:"Microsoft Edge (Chromium) — Windows",value:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Safari/537.36 Edg/%s",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Microsoft Edge",version:"%s"}],fullVersion:"%s",platform:"Windows",platformVersion:"10.0",architecture:"x86",model:"",mobile:!1}},{title:"Microsoft Edge (Chromium) — Mac",value:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Chrome/%s Safari/604.1 Edg/%s",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Microsoft Edge",version:"%s"}],fullVersion:"%s",platform:"macOS",platformVersion:"10_14_6",architecture:"x86",model:"",mobile:!1}},{title:"Microsoft Edge — iPhone",value:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.1.1 EdgiOS/44.5.0.10 Mobile/15E148 Safari/604.1",metadata:null},{title:"Microsoft Edge — iPad",value:"Mozilla/5.0 (iPad; CPU OS 12_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0 EdgiOS/44.5.2 Mobile/15E148 Safari/605.1.15",metadata:null},{title:"Microsoft Edge — Android Mobile",value:"Mozilla/5.0 (Linux; Android 8.1.0; Pixel Build/OPM4.171019.021.D1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.109 Mobile Safari/537.36 EdgA/42.0.0.2057",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Microsoft Edge",version:"%s"}],fullVersion:"%s",platform:"Android",platformVersion:"8.1.0",architecture:"",model:"Pixel",mobile:!0}},{title:"Microsoft Edge — Android Tablet",value:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 7 Build/MOB30X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.109 Safari/537.36 EdgA/42.0.0.2057",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Microsoft Edge",version:"%s"}],fullVersion:"%s",platform:"Android",platformVersion:"6.0.1",architecture:"",model:"Nexus 7",mobile:!0}},{title:"Microsoft Edge (EdgeHTML) — Windows",value:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.19042",metadata:null},{title:"Microsoft Edge (EdgeHTML) — XBox",value:"Mozilla/5.0 (Windows NT 10.0; Win64; x64; Xbox; Xbox One) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.19041",metadata:null}]},{title:"Opera",values:[{title:"Opera — Mac",value:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.97 Safari/537.36 OPR/65.0.3467.48",metadata:null},{title:"Opera — Windows",value:"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.97 Safari/537.36 OPR/65.0.3467.48",metadata:null},{title:"Opera (Presto) — Mac",value:"Opera/9.80 (Macintosh; Intel Mac OS X 10.9.1) Presto/2.12.388 Version/12.16",metadata:null},{title:"Opera (Presto) — Windows",value:"Opera/9.80 (Windows NT 6.1) Presto/2.12.388 Version/12.16",metadata:null},{title:"Opera Mobile — Android Mobile",value:"Opera/12.02 (Android 4.1; Linux; Opera Mobi/ADR-1111101157; U; en-US) Presto/2.9.201 Version/12.02",metadata:null},{title:"Opera Mini — iOS",value:"Opera/9.80 (iPhone; Opera Mini/8.0.0/34.2336; U; en) Presto/2.8.119 Version/11.10",metadata:null}]},{title:"Safari",values:[{title:"Safari — iPad iOS 13.2",value:"Mozilla/5.0 (iPad; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1",metadata:null},{title:"Safari — iPhone iOS 13.2",value:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1",metadata:null},{title:"Safari — Mac",value:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Safari/605.1.15",metadata:null}]},{title:"UC Browser",values:[{title:"UC Browser — Android Mobile",value:"Mozilla/5.0 (Linux; U; Android 8.1.0; en-US; Nexus 6P Build/OPM7.181205.001) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 UCBrowser/12.11.1.1197 Mobile Safari/537.36",metadata:null},{title:"UC Browser — iOS",value:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_1 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/16B92 UCBrowser/12.1.7.1109 Mobile AliApp(TUnionSDK/0.1.20.3)",metadata:null},{title:"UC Browser — Windows Phone",value:"Mozilla/5.0 (compatible; MSIE 10.0; Windows Phone 8.0; Trident/6.0; IEMobile/10.0; ARM; Touch; NOKIA; Lumia 920) UCBrowser/10.1.0.563 Mobile",metadata:null}]}];var ce=Object.freeze({__proto__:null,NetworkConfigView:ae,userAgentGroups:de});const he={redirect:"Redirect",sPreflight:"{PH1} + Preflight",preflight:"Preflight",selectPreflightRequest:"Select preflight request",failed:"(failed)",data:"(data)",canceled:"(canceled)",other:"other",csp:"csp",origin:"origin",devtools:"devtools",blockeds:"(blocked:{PH1})",blockedTooltip:"This request was blocked due to misconfigured response headers, click to view the headers",corsError:"CORS error",crossoriginResourceSharingErrorS:"Cross-Origin Resource Sharing error: {PH1}",finished:"Finished",pendingq:"(pending)",unknown:"(unknown)",unknownExplanation:"The request status cannot be shown here because the page that issued it unloaded while the request was in flight. You can use chrome://net-export to capture a network log and see all request details.",push:"Push / ",parser:"Parser",script:"Script",preload:"Preload",signedexchange:"signed-exchange",selectTheRequestThatTriggered:"Select the request that triggered this preflight",otherC:"Other",memoryCache:"(memory cache)",servedFromMemoryCacheResource:"Served from memory cache, resource size: {PH1}",serviceworker:"(`ServiceWorker`)",servedFromServiceworkerResource:"Served from `ServiceWorker`, resource size: {PH1}",servedFromSignedHttpExchange:"Served from Signed HTTP Exchange, resource size: {PH1}",servedFromWebBundle:"Served from Web Bundle, resource size: {PH1}",prefetchCache:"(prefetch cache)",servedFromPrefetchCacheResource:"Served from prefetch cache, resource size: {PH1}",diskCache:"(disk cache)",servedFromDiskCacheResourceSizeS:"Served from disk cache, resource size: {PH1}",pending:"Pending",level:"level 1",webBundleError:"Web Bundle error",webBundleInnerRequest:"Served from Web Bundle",webBundle:"(Web Bundle)",timeSubtitleTooltipText:"Latency (response received time - start time)",alternativeJobWonWithoutRace:"`Chrome` used a `HTTP/3` connection induced by an '`Alt-Svc`' header without racing against establishing a connection using a different `HTTP` version.",alternativeJobWonRace:"`Chrome` used a `HTTP/3` connection induced by an '`Alt-Svc`' header because it won a race against establishing a connection using a different `HTTP` version.",mainJobWonRace:"`Chrome` used this protocol because it won a race against establishing a `HTTP/3` connection.",mappingMissing:"`Chrome` did not use an alternative `HTTP` version because no alternative protocol information was available when the request was issued, but an '`Alt-Svc`' header was present in the response.",broken:"`Chrome` did not try to establish a `HTTP/3` connection because it was marked as broken.",dnsAlpnH3JobWonWithoutRace:"`Chrome` used a `HTTP/3` connection due to the `DNS record` indicating `HTTP/3` support. There was no race against establishing a connection using a different `HTTP` version.",dnsAlpnH3JobWonRace:"`Chrome` used a `HTTP/3` connection due to the `DNS record` indicating `HTTP/3` support, which won a race against establishing a connection using a different `HTTP` version."},ue=i.i18n.registerUIStrings("panels/network/NetworkDataGridNode.ts",he),pe=i.i18n.getLocalizedString.bind(void 0,ue);var me;!function(e){e.RequestSelected="RequestSelected",e.RequestActivated="RequestActivated"}(me||(me={}));class ge extends a.SortableDataGrid.SortableDataGridNode{parentViewInternal;isHovered;showingInitiatorChainInternal;requestOrFirstKnownChildRequestInternal;constructor(e){super({}),this.parentViewInternal=e,this.isHovered=!1,this.showingInitiatorChainInternal=!1,this.requestOrFirstKnownChildRequestInternal=null}displayName(){return""}displayType(){return""}createCell(e){const t=this.createTD(e);return this.renderCell(t,e),t}renderCell(e,t){}isFailed(){return!1}backgroundColor(){const e=we,t=document.hasFocus(),i=this.dataGrid&&this.dataGrid.element===document.activeElement,r=this.isFailed();return this.selected&&t&&i&&r?e.FocusSelectedHasError:this.selected&&t&&i?e.FocusSelected:this.selected?e.Selected:this.hovered()?e.Hovered:this.isOnInitiatorPath()?e.InitiatorPath:this.isOnInitiatedPath()?e.InitiatedPath:this.isStriped()?e.Stripe:e.Default}updateBackgroundColor(){const e=this.existingElement();e&&(e.style.backgroundColor=`var(${this.backgroundColor()})`,this.parentViewInternal.stylesChanged())}setStriped(e){super.setStriped(e),this.updateBackgroundColor()}select(e){super.select(e),this.updateBackgroundColor(),this.parentViewInternal.updateNodeSelectedClass(!0)}deselect(e){super.deselect(e),this.updateBackgroundColor(),this.parentViewInternal.updateNodeSelectedClass(!1)}parentView(){return this.parentViewInternal}hovered(){return this.isHovered}showingInitiatorChain(){return this.showingInitiatorChainInternal}nodeSelfHeight(){return this.parentViewInternal.rowHeight()}setHovered(e,t){this.isHovered===e&&this.showingInitiatorChainInternal===t||(this.isHovered!==e&&(this.isHovered=e,this.attached()&&this.element().classList.toggle("hover",e)),this.showingInitiatorChainInternal!==t&&(this.showingInitiatorChainInternal=t,this.showingInitiatorChainChanged()),this.parentViewInternal.stylesChanged(),this.updateBackgroundColor())}showingInitiatorChainChanged(){}isOnInitiatorPath(){return!1}isOnInitiatedPath(){return!1}request(){return null}isNavigationRequest(){return!1}clearFlatNodes(){super.clearFlatNodes(),this.requestOrFirstKnownChildRequestInternal=null}requestOrFirstKnownChildRequest(){if(this.requestOrFirstKnownChildRequestInternal)return this.requestOrFirstKnownChildRequestInternal;let e=this.request();if(e||!this.hasChildren())return this.requestOrFirstKnownChildRequestInternal=e,this.requestOrFirstKnownChildRequestInternal;let t=null;const i=this.flatChildren();for(let r=0;r<i.length;r++)e=i[r].request(),(!t||e&&e.issueTime()<t.issueTime())&&(t=e);return this.requestOrFirstKnownChildRequestInternal=t,this.requestOrFirstKnownChildRequestInternal}}const we={Default:"--network-grid-default-color",Stripe:"--network-grid-stripe-color",Navigation:"--network-grid-navigation-color",Hovered:"--network-grid-hovered-color",InitiatorPath:"--network-grid-initiator-path-color",InitiatedPath:"--network-grid-initiated-path-color",Selected:"--network-grid-selected-color",FocusSelected:"--network-grid-focus-selected-color",FocusSelectedHasError:"--network-grid-focus-selected-color-has-error",FromFrame:"--network-grid-from-frame-color"};class ve extends ge{nameCell;initiatorCell;requestInternal;isNavigationRequestInternal;selectable;isOnInitiatorPathInternal;isOnInitiatedPathInternal;linkifiedInitiatorAnchor;constructor(e,t){super(e),this.nameCell=null,this.initiatorCell=null,this.requestInternal=t,this.isNavigationRequestInternal=!1,this.selectable=!0,this.isOnInitiatorPathInternal=!1,this.isOnInitiatedPathInternal=!1}static NameComparator(e,t){const i=e.displayName().toLowerCase(),r=t.displayName().toLowerCase();if(i===r){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();return i&&r?i.identityCompare(r):i?-1:1}return i<r?-1:1}static RemoteAddressComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;const o=i.remoteAddress(),s=r.remoteAddress();return o>s?1:s>o?-1:i.identityCompare(r)}static SizeComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();return i&&r?r.cached()&&!i.cached()?1:i.cached()&&!r.cached()?-1:i.transferSize-r.transferSize||i.resourceSize-r.resourceSize||i.identityCompare(r):i?1:-1}static TypeComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;const o=e.displayType(),s=t.displayType();return o>s?1:s>o?-1:i.identityCompare(r)}static InitiatorComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;const o=e instanceof ve&&e.initiatorCell,s=t instanceof ve&&t.initiatorCell;if(!o||!s)return o?1:-1;const n=e,a=t,l=n.linkifiedInitiatorAnchor?n.linkifiedInitiatorAnchor.textContent||"":n.initiatorCell.title,d=a.linkifiedInitiatorAnchor?a.linkifiedInitiatorAnchor.textContent||"":a.initiatorCell.title;return l.localeCompare(d)}static InitiatorAddressSpaceComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;const o=i.clientSecurityState(),s=r.clientSecurityState();return o&&s?o.initiatorIPAddressSpace.localeCompare(s.initiatorIPAddressSpace):o?1:-1}static RemoteAddressSpaceComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();return i&&r?i.remoteAddressSpace().localeCompare(r.remoteAddressSpace()):i?1:-1}static RequestCookiesCountComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;return i.includedRequestCookies().length-r.includedRequestCookies().length||i.identityCompare(r)}static ResponseCookiesCountComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;return(i.responseCookies?i.responseCookies.length:0)-(r.responseCookies?r.responseCookies.length:0)||i.identityCompare(r)}static PriorityComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;const o=i.priority();let s=o?m.NetworkPriorities.networkPriorityWeight(o):0;s=s||0;const n=r.priority();let a=n?m.NetworkPriorities.networkPriorityWeight(n):0;return a=a||0,s-a||i.identityCompare(r)}static RequestPropertyComparator(e,t,i){const r=t.requestOrFirstKnownChildRequest(),o=i.requestOrFirstKnownChildRequest();if(!r||!o)return r?1:-1;const s=r[e],n=o[e];return s===n?r.identityCompare(o):s>n?1:-1}static RequestURLComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;const o=i.url(),s=r.url();return o===s?i.identityCompare(r):o>s?1:-1}static ResponseHeaderStringComparator(e,t,i){const r=t.requestOrFirstKnownChildRequest(),o=i.requestOrFirstKnownChildRequest();if(!r||!o)return r?1:-1;const s=String(r.responseHeaderValue(e)||""),n=String(o.responseHeaderValue(e)||"");return s.localeCompare(n)||r.identityCompare(o)}static ResponseHeaderNumberComparator(e,t,i){const r=t.requestOrFirstKnownChildRequest(),o=i.requestOrFirstKnownChildRequest();if(!r||!o)return r?1:-1;const s=r.responseHeaderValue(e),n=void 0!==s?parseFloat(s):-1/0,a=o.responseHeaderValue(e),l=void 0!==a?parseFloat(a):-1/0;return n===l?r.identityCompare(o):n>l?1:-1}static ResponseHeaderDateComparator(e,t,i){const r=t.requestOrFirstKnownChildRequest(),o=i.requestOrFirstKnownChildRequest();if(!r||!o)return r?1:-1;const s=r.responseHeaderValue(e),n=o.responseHeaderValue(e),a=s?new Date(s).getTime():-1/0,l=n?new Date(n).getTime():-1/0;return a===l?r.identityCompare(o):a>l?1:-1}showingInitiatorChainChanged(){const e=this.showingInitiatorChain(),t=h.NetworkLog.NetworkLog.instance().initiatorGraphForRequest(this.requestInternal);for(const i of t.initiators){if(i===this.requestInternal)continue;const t=this.parentView().nodeForRequest(i);t&&t.setIsOnInitiatorPath(e)}for(const i of t.initiated.keys()){if(i===this.requestInternal)continue;const t=this.parentView().nodeForRequest(i);t&&t.setIsOnInitiatedPath(e)}}setIsOnInitiatorPath(e){this.isOnInitiatorPathInternal!==e&&this.attached()&&(this.isOnInitiatorPathInternal=e,this.updateBackgroundColor())}isOnInitiatorPath(){return this.isOnInitiatorPathInternal}setIsOnInitiatedPath(e){this.isOnInitiatedPathInternal!==e&&this.attached()&&(this.isOnInitiatedPathInternal=e,this.updateBackgroundColor())}isOnInitiatedPath(){return this.isOnInitiatedPathInternal}displayType(){const t=this.requestInternal.mimeType||this.requestInternal.requestContentType()||"",i=this.requestInternal.resourceType();let r=i.name();return i!==e.ResourceType.resourceTypes.Other&&i!==e.ResourceType.resourceTypes.Image||(r=t.replace(/^(application|image)\//,"")),this.requestInternal.isRedirect()&&(r+=" / "+pe(he.redirect)),r}displayName(){return this.requestInternal.name()}request(){return this.requestInternal}isNavigationRequest(){const e=n.PageLoad.PageLoad.forRequest(this.requestInternal);return!!e&&e.mainRequest===this.requestInternal}nodeSelfHeight(){return this.parentView().rowHeight()}createCells(e){this.nameCell=null,this.initiatorCell=null,e.classList.toggle("network-error-row",this.isFailed()),e.classList.toggle("network-navigation-row",this.isNavigationRequestInternal),super.createCells(e),this.updateBackgroundColor()}setTextAndTitle(e,t,i){o.UIUtils.createTextChild(e,t),o.Tooltip.Tooltip.install(e,i||t)}setTextAndTitleAsLink(e,t,i,r){const s=document.createElement("span");s.classList.add("devtools-link"),s.textContent=t,s.addEventListener("click",r),e.appendChild(s),o.Tooltip.Tooltip.install(e,i)}renderCell(e,t){const i=e;switch(t){case"name":this.renderPrimaryCell(i,t);break;case"path":this.renderPrimaryCell(i,t,this.requestInternal.pathname);break;case"url":this.renderPrimaryCell(i,t,this.requestInternal.url());break;case"method":{const e=this.requestInternal.preflightRequest();e?(this.setTextAndTitle(i,`${this.requestInternal.requestMethod} + `,pe(he.sPreflight,{PH1:this.requestInternal.requestMethod})),i.appendChild(g.Linkifier.Linkifier.linkifyRevealable(e,pe(he.preflight),void 0,pe(he.selectPreflightRequest)))):this.setTextAndTitle(i,this.requestInternal.requestMethod);break}case"status":this.renderStatusCell(i);break;case"protocol":this.renderProtocolCell(i);break;case"scheme":this.setTextAndTitle(i,this.requestInternal.scheme);break;case"domain":this.setTextAndTitle(i,this.requestInternal.domain);break;case"remoteaddress":this.setTextAndTitle(i,this.requestInternal.remoteAddress());break;case"remoteaddress-space":this.renderAddressSpaceCell(i,this.requestInternal.remoteAddressSpace());break;case"cookies":this.setTextAndTitle(i,this.arrayLength(this.requestInternal.includedRequestCookies()));break;case"setcookies":this.setTextAndTitle(i,this.arrayLength(this.requestInternal.responseCookies));break;case"priority":{const e=this.requestInternal.priority();this.setTextAndTitle(i,e?m.NetworkPriorities.uiLabelForNetworkPriority(e):"");break}case"connectionid":this.setTextAndTitle(i,"0"===this.requestInternal.connectionId?"":this.requestInternal.connectionId);break;case"type":this.setTextAndTitle(i,this.displayType());break;case"initiator":this.renderInitiatorCell(i);break;case"initiator-address-space":{const e=this.requestInternal.clientSecurityState();this.renderAddressSpaceCell(i,e?e.initiatorIPAddressSpace:"Unknown");break}case"size":this.renderSizeCell(i);break;case"time":this.renderTimeCell(i);break;case"timeline":this.setTextAndTitle(i,"");break;default:this.setTextAndTitle(i,this.requestInternal.responseHeaderValue(t)||"")}}arrayLength(e){return e?String(e.length):""}select(e){super.select(e),this.parentView().dispatchEventToListeners(me.RequestSelected,this.requestInternal)}highlightMatchedSubstring(e){if(!e||!this.nameCell||null===this.nameCell.textContent)return[];this.element();const t=[],i=this.nameCell.textContent.match(e);return i&&o.UIUtils.highlightSearchResult(this.nameCell,i.index||0,i[0].length,t),t}openInNewTab(){t.InspectorFrontendHost.InspectorFrontendHostInstance.openInNewTab(this.requestInternal.url())}isFailed(){if(this.requestInternal.failed&&!this.requestInternal.statusCode)return!0;if(this.requestInternal.statusCode>=400)return!0;const e=this.requestInternal.signedExchangeInfo();return!(null===e||!Boolean(e.errors))||(!(!this.requestInternal.webBundleInfo()?.errorMessage&&!this.requestInternal.webBundleInnerRequestInfo()?.errorMessage)||!!this.requestInternal.corsErrorStatus())}renderPrimaryCell(t,i,r){if(0===this.dataGrid.indexOfVisibleColumn(i)){const i=this.leftPadding?this.leftPadding+"px":"";let r;if(t.style.setProperty("padding-left",i),this.nameCell=t,t.addEventListener("dblclick",this.openInNewTab.bind(this),!1),t.addEventListener("mousedown",(()=>{this.select(),this.parentView().dispatchEventToListeners(me.RequestActivated,{showPanel:!0})})),this.requestInternal.resourceType()===e.ResourceType.resourceTypes.Image){const e=document.createElement("img");e.classList.add("image-network-icon-preview"),e.alt=this.requestInternal.resourceType().title(),this.requestInternal.populateImageSource(e),r=document.createElement("div"),r.classList.add("image"),r.appendChild(e)}else r=document.createElement("img"),r.alt=this.requestInternal.resourceType().title(),r.src=new URL(`../../Images/${w(this.requestInternal.resourceType())}.svg`,import.meta.url).toString();r.classList.add("icon"),t.appendChild(r)}if("name"===i){const e=this.requestInternal.webBundleInnerRequestInfo();if(e){const i=document.createElement("img");i.classList.add("icon"),i.alt=pe(he.webBundleInnerRequest),i.src=new URL("../../Images/ic_file_webbundle_inner_request.svg",import.meta.url).toString();const r=n.NetworkManager.NetworkManager.forRequest(this.requestInternal);e.bundleRequestId&&r?t.appendChild(g.Linkifier.Linkifier.linkifyRevealable(new p.NetworkRequestId.NetworkRequestId(e.bundleRequestId,r),i)):t.appendChild(i)}const i=s.StringUtilities.trimMiddle(this.requestInternal.name(),100),r=n.NetworkManager.NetworkManager.forRequest(this.requestInternal);o.UIUtils.createTextChild(t,r?r.target().decorateLabel(i):i),this.appendSubtitle(t,this.requestInternal.path()),this.requestInternal.url().startsWith("data")||o.Tooltip.Tooltip.install(t,this.requestInternal.url())}else r&&o.UIUtils.createTextChild(t,r)}renderStatusCell(e){e.classList.toggle("network-dim-cell",!this.isFailed()&&(this.requestInternal.cached()||!this.requestInternal.statusCode));const t=this.requestInternal.corsErrorStatus(),r=this.requestInternal.webBundleInfo()?.errorMessage||this.requestInternal.webBundleInnerRequestInfo()?.errorMessage;if(r)this.setTextAndTitle(e,pe(he.webBundleError),r);else if(!this.requestInternal.failed||this.requestInternal.canceled||this.requestInternal.wasBlocked()||t)if(this.requestInternal.statusCode&&this.requestInternal.statusCode>=400)o.UIUtils.createTextChild(e,String(this.requestInternal.statusCode)),this.appendSubtitle(e,this.requestInternal.statusText),o.Tooltip.Tooltip.install(e,this.requestInternal.statusCode+" "+this.requestInternal.statusText);else if(!this.requestInternal.statusCode&&this.requestInternal.parsedURL.isDataURL())this.setTextAndTitle(e,pe(he.data));else if(!this.requestInternal.statusCode&&this.requestInternal.canceled)this.setTextAndTitle(e,pe(he.canceled));else if(this.requestInternal.wasBlocked()){let t=pe(he.other),r=!1;switch(this.requestInternal.blockedReason()){case"other":t=pe(he.other);break;case"csp":t=pe(he.csp);break;case"mixed-content":t=i.i18n.lockedString("mixed-content");break;case"origin":t=pe(he.origin);break;case"inspector":t=pe(he.devtools);break;case"subresource-filter":t=i.i18n.lockedString("subresource-filter");break;case"content-type":t=i.i18n.lockedString("content-type");break;case"coep-frame-resource-needs-coep-header":r=!0,t=i.i18n.lockedString("CoepFrameResourceNeedsCoepHeader");break;case"coop-sandboxed-iframe-cannot-navigate-to-coop-page":r=!0,t=i.i18n.lockedString("CoopSandboxedIframeCannotNavigateToCoopPage");break;case"corp-not-same-origin":r=!0,t=i.i18n.lockedString("NotSameOrigin");break;case"corp-not-same-site":r=!0,t=i.i18n.lockedString("NotSameSite");break;case"corp-not-same-origin-after-defaulted-to-same-origin-by-coep":r=!0,t=i.i18n.lockedString("NotSameOriginAfterDefaultedToSameOriginByCoep")}r?this.setTextAndTitleAsLink(e,pe(he.blockeds,{PH1:t}),pe(he.blockedTooltip),(()=>{this.parentView().dispatchEventToListeners(me.RequestActivated,{showPanel:!0,tab:p.UIRequestLocation.UIRequestTabs.Headers})})):this.setTextAndTitle(e,pe(he.blockeds,{PH1:t}))}else t?this.setTextAndTitle(e,pe(he.corsError),pe(he.crossoriginResourceSharingErrorS,{PH1:t.corsError})):this.requestInternal.statusCode?(o.UIUtils.createTextChild(e,String(this.requestInternal.statusCode)),this.appendSubtitle(e,this.requestInternal.statusText),o.Tooltip.Tooltip.install(e,this.requestInternal.statusCode+" "+this.requestInternal.statusText)):this.requestInternal.finished?this.setTextAndTitle(e,pe(he.finished)):this.requestInternal.preserved?this.setTextAndTitle(e,pe(he.unknown),pe(he.unknownExplanation)):this.setTextAndTitle(e,pe(he.pendingq));else{const t=pe(he.failed);this.requestInternal.localizedFailDescription?(o.UIUtils.createTextChild(e,t),this.appendSubtitle(e,this.requestInternal.localizedFailDescription,!0),o.Tooltip.Tooltip.install(e,t+" "+this.requestInternal.localizedFailDescription)):this.setTextAndTitle(e,t)}}renderProtocolCell(e){switch(o.UIUtils.createTextChild(e,this.requestInternal.protocol),this.requestInternal.alternateProtocolUsage){case"alternativeJobWonWithoutRace":o.Tooltip.Tooltip.install(e,he.alternativeJobWonWithoutRace);break;case"alternativeJobWonRace":o.Tooltip.Tooltip.install(e,he.alternativeJobWonRace);break;case"mainJobWonRace":o.Tooltip.Tooltip.install(e,he.mainJobWonRace);break;case"mappingMissing":o.Tooltip.Tooltip.install(e,he.mappingMissing);break;case"broken":o.Tooltip.Tooltip.install(e,he.broken);break;case"dnsAlpnH3JobWonWithoutRace":o.Tooltip.Tooltip.install(e,he.dnsAlpnH3JobWonWithoutRace);break;case"dnsAlpnH3JobWonRace":o.Tooltip.Tooltip.install(e,he.dnsAlpnH3JobWonRace);break;default:o.Tooltip.Tooltip.install(e,this.requestInternal.protocol)}}renderInitiatorCell(e){this.initiatorCell=e;const t=this.requestInternal,i=h.NetworkLog.NetworkLog.instance().initiatorInfoForRequest(t),r=t.timing;switch(r&&r.pushStart&&e.appendChild(document.createTextNode(pe(he.push))),i.type){case n.NetworkRequest.InitiatorType.Parser:{const t=u.Workspace.WorkspaceImpl.instance().uiSourceCodeForURL(i.url);e.appendChild(g.Linkifier.Linkifier.linkifyURL(i.url,{text:t?t.displayName():void 0,lineNumber:i.lineNumber,columnNumber:i.columnNumber})),this.appendSubtitle(e,pe(he.parser));break}case n.NetworkRequest.InitiatorType.Redirect:{o.Tooltip.Tooltip.install(e,i.url);const r=t.redirectSource();console.assert(null!==r),this.parentView().nodeForRequest(r)?e.appendChild(g.Linkifier.Linkifier.linkifyRevealable(r,c.ResourceUtils.displayNameForURL(r.url()))):e.appendChild(g.Linkifier.Linkifier.linkifyURL(r.url())),this.appendSubtitle(e,pe(he.redirect));break}case n.NetworkRequest.InitiatorType.Script:{const r=n.NetworkManager.NetworkManager.forRequest(t)?.target()||null,s=this.parentView().linkifier();i.stack?this.linkifiedInitiatorAnchor=s.linkifyStackTraceTopFrame(r,i.stack):this.linkifiedInitiatorAnchor=s.linkifyScriptLocation(r,i.scriptId,i.url,i.lineNumber,{columnNumber:i.columnNumber,inlineFrameIndex:0}),o.Tooltip.Tooltip.install(this.linkifiedInitiatorAnchor,""),e.appendChild(this.linkifiedInitiatorAnchor),this.appendSubtitle(e,pe(he.script)),e.classList.add("network-script-initiated");break}case n.NetworkRequest.InitiatorType.Preload:o.Tooltip.Tooltip.install(e,pe(he.preload)),e.classList.add("network-dim-cell"),e.appendChild(document.createTextNode(pe(he.preload)));break;case n.NetworkRequest.InitiatorType.SignedExchange:e.appendChild(g.Linkifier.Linkifier.linkifyURL(i.url)),this.appendSubtitle(e,pe(he.signedexchange));break;case n.NetworkRequest.InitiatorType.Preflight:if(e.appendChild(document.createTextNode(pe(he.preflight))),i.initiatorRequest){const t=o.Icon.Icon.create("mediumicon-network-panel"),r=g.Linkifier.Linkifier.linkifyRevealable(i.initiatorRequest,t,void 0,pe(he.selectTheRequestThatTriggered),"trailing-link-icon");o.ARIAUtils.setAccessibleName(r,pe(he.selectTheRequestThatTriggered)),e.appendChild(r)}break;default:o.Tooltip.Tooltip.install(e,pe(he.otherC)),e.classList.add("network-dim-cell"),e.appendChild(document.createTextNode(pe(he.otherC)))}}renderAddressSpaceCell(e,t){"Unknown"!==t&&o.UIUtils.createTextChild(e,t)}renderSizeCell(e){const t=s.NumberUtilities.bytesToString(this.requestInternal.resourceSize);if(this.requestInternal.cachedInMemory())o.UIUtils.createTextChild(e,pe(he.memoryCache)),o.Tooltip.Tooltip.install(e,pe(he.servedFromMemoryCacheResource,{PH1:t})),e.classList.add("network-dim-cell");else if(this.requestInternal.fetchedViaServiceWorker)o.UIUtils.createTextChild(e,pe(he.serviceworker)),o.Tooltip.Tooltip.install(e,pe(he.servedFromServiceworkerResource,{PH1:t})),e.classList.add("network-dim-cell");else if(this.requestInternal.redirectSourceSignedExchangeInfoHasNoErrors())o.UIUtils.createTextChild(e,i.i18n.lockedString("(signed-exchange)")),o.Tooltip.Tooltip.install(e,pe(he.servedFromSignedHttpExchange,{PH1:t})),e.classList.add("network-dim-cell");else if(this.requestInternal.webBundleInnerRequestInfo())o.UIUtils.createTextChild(e,pe(he.webBundle)),o.Tooltip.Tooltip.install(e,pe(he.servedFromWebBundle,{PH1:t})),e.classList.add("network-dim-cell");else if(this.requestInternal.fromPrefetchCache())o.UIUtils.createTextChild(e,pe(he.prefetchCache)),o.Tooltip.Tooltip.install(e,pe(he.servedFromPrefetchCacheResource,{PH1:t})),e.classList.add("network-dim-cell");else if(this.requestInternal.cached())o.UIUtils.createTextChild(e,pe(he.diskCache)),o.Tooltip.Tooltip.install(e,pe(he.servedFromDiskCacheResourceSizeS,{PH1:t})),e.classList.add("network-dim-cell");else{const i=s.NumberUtilities.bytesToString(this.requestInternal.transferSize);o.UIUtils.createTextChild(e,i),o.Tooltip.Tooltip.install(e,`${i} transferred over network, resource size: ${t}`)}this.appendSubtitle(e,t)}renderTimeCell(e){this.requestInternal.duration>0?(this.setTextAndTitle(e,i.TimeUtilities.secondsToString(this.requestInternal.duration)),this.appendSubtitle(e,i.TimeUtilities.secondsToString(this.requestInternal.latency),!1,pe(he.timeSubtitleTooltipText))):this.requestInternal.preserved?this.setTextAndTitle(e,pe(he.unknown),pe(he.unknownExplanation)):(e.classList.add("network-dim-cell"),this.setTextAndTitle(e,pe(he.pending)))}appendSubtitle(e,t,i=!1,r=""){const s=document.createElement("div");s.classList.add("network-cell-subtitle"),i&&s.classList.add("network-cell-subtitle-show-inline-when-selected"),s.textContent=t,r&&o.Tooltip.Tooltip.install(s,r),e.appendChild(s)}}class be extends ge{createCells(e){super.createCells(e);const t=this.dataGrid.visibleColumnsArray[0],i=`${t.title}`,r=pe(he.level);this.nodeAccessibleText=`${r} ${i}: ${this.cellAccessibleTextMap.get(t.id)}`}renderCell(e,t){if(0===this.dataGrid.indexOfVisibleColumn(t)){const i=e,r=this.leftPadding?this.leftPadding+"px":"";i.style.setProperty("padding-left",r),i.classList.add("disclosure"),this.setCellAccessibleName(i.textContent||"",i,t)}}select(e){super.select(e);const t=this.traverseNextNode(!1,void 0,!0)?.request();t&&this.parentView().dispatchEventToListeners(me.RequestSelected,t)}}var ke=Object.freeze({__proto__:null,get Events(){return me},NetworkNode:ge,_backgroundColors:we,NetworkRequestNode:ve,NetworkGroupNode:be});const fe=new CSSStyleSheet;fe.replaceSync(".request-cookies-view{overflow:auto;padding:12px;height:100%;background-color:var(--color-background)}.request-cookies-view .request-cookies-title{font-size:12px;font-weight:bold;margin-right:30px;color:var(--color-text-primary)}.request-cookies-view .cookie-line{margin-top:6px;display:inline-block}.request-cookies-view .cookies-panel-item{margin-top:6px;margin-bottom:16px;flex:none}@media (forced-colors: active){td.flagged-cookie-attribute-cell .cookie-warning-icon{forced-color-adjust:none;filter:grayscale()}}\n/*# sourceURL=requestCookiesView.css */\n");const Ce={thisRequestHasNoCookies:"This request has no cookies.",requestCookies:"Request Cookies",cookiesThatWereSentToTheServerIn:"Cookies that were sent to the server in the 'cookie' header of the request",showFilteredOutRequestCookies:"show filtered out request cookies",noRequestCookiesWereSent:"No request cookies were sent.",responseCookies:"Response Cookies",cookiesThatWereReceivedFromThe:"Cookies that were received from the server in the '`set-cookie`' header of the response",malformedResponseCookies:"Malformed Response Cookies",cookiesThatWereReceivedFromTheServer:"Cookies that were received from the server in the '`set-cookie`' header of the response but were malformed",siteHasCookieInOtherPartition:"This site has cookies in another partition, that were not sent with this request. {PH1}",learnMore:"Learn more"},Se=i.i18n.registerUIStrings("panels/network/RequestCookiesView.ts",Ce),Te=i.i18n.getLocalizedString.bind(void 0,Se);class ye extends o.Widget.Widget{request;showFilteredOutCookiesSetting;emptyWidget;requestCookiesTitle;requestCookiesEmpty;requestCookiesTable;responseCookiesTitle;responseCookiesTable;siteHasCookieInOtherPartition;malformedResponseCookiesTitle;malformedResponseCookiesList;constructor(t){super(),this.element.classList.add("request-cookies-view"),this.request=t,this.showFilteredOutCookiesSetting=e.Settings.Settings.instance().createSetting("show-filtered-out-request-cookies",!1),this.emptyWidget=new o.EmptyWidget.EmptyWidget(Te(Ce.thisRequestHasNoCookies)),this.emptyWidget.show(this.element),this.requestCookiesTitle=this.element.createChild("div");const r=this.requestCookiesTitle.createChild("span","request-cookies-title");r.textContent=Te(Ce.requestCookies),o.Tooltip.Tooltip.install(r,Te(Ce.cookiesThatWereSentToTheServerIn));const s=o.SettingsUI.createSettingCheckbox(Te(Ce.showFilteredOutRequestCookies),this.showFilteredOutCookiesSetting,!0);s.checkboxElement.addEventListener("change",(()=>{this.refreshRequestCookiesView()})),this.requestCookiesTitle.appendChild(s),this.requestCookiesEmpty=this.element.createChild("div","cookies-panel-item"),this.requestCookiesEmpty.textContent=Te(Ce.noRequestCookiesWereSent),this.requestCookiesTable=new k.CookiesTable.CookiesTable(!0),this.requestCookiesTable.contentElement.classList.add("cookie-table","cookies-panel-item"),this.requestCookiesTable.show(this.element),this.siteHasCookieInOtherPartition=this.element.createChild("div","cookies-panel-item site-has-cookies-in-other-partition"),this.siteHasCookieInOtherPartition.appendChild(i.i18n.getFormatLocalizedString(Se,Ce.siteHasCookieInOtherPartition,{PH1:o.XLink.XLink.create("https://developer.chrome.com/en/docs/privacy-sandbox/chips/",Te(Ce.learnMore))})),this.responseCookiesTitle=this.element.createChild("div","request-cookies-title"),this.responseCookiesTitle.textContent=Te(Ce.responseCookies),this.responseCookiesTitle.title=Te(Ce.cookiesThatWereReceivedFromThe),this.responseCookiesTable=new k.CookiesTable.CookiesTable(!0),this.responseCookiesTable.contentElement.classList.add("cookie-table","cookies-panel-item"),this.responseCookiesTable.show(this.element),this.malformedResponseCookiesTitle=this.element.createChild("div","request-cookies-title"),this.malformedResponseCookiesTitle.textContent=Te(Ce.malformedResponseCookies),o.Tooltip.Tooltip.install(this.malformedResponseCookiesTitle,Te(Ce.cookiesThatWereReceivedFromTheServer)),this.malformedResponseCookiesList=this.element.createChild("div")}getRequestCookies(){const e=new Map,t=this.request.includedRequestCookies().slice();if(this.showFilteredOutCookiesSetting.get())for(const i of this.request.blockedRequestCookies())e.set(i.cookie,i.blockedReasons.map((e=>({attribute:n.NetworkRequest.cookieBlockedReasonToAttribute(e),uiString:n.NetworkRequest.cookieBlockedReasonToUiString(e)})))),t.push(i.cookie);return{requestCookies:t,requestCookieToBlockedReasons:e}}getResponseCookies(){let e=[];const t=new Map,i=[];if(this.request.responseCookies.length){const r=this.request.blockedResponseCookies().map((e=>e.cookieLine));e=this.request.responseCookies.filter((e=>{const t=r.indexOf(e.getCookieLine());return-1===t||(r[t]=null,!1)}));for(const r of this.request.blockedResponseCookies()){const o=n.CookieParser.CookieParser.parseSetCookie(r.cookieLine);if(o&&!o.length||r.blockedReasons.includes("SyntaxError")||r.blockedReasons.includes("NameValuePairExceedsMaxSize")){i.push(r);continue}let s=r.cookie;!s&&o&&(s=o[0]),s&&(t.set(s,r.blockedReasons.map((e=>({attribute:n.NetworkRequest.setCookieBlockedReasonToAttribute(e),uiString:n.NetworkRequest.setCookieBlockedReasonToUiString(e)})))),e.push(s))}}return{responseCookies:e,responseCookieToBlockedReasons:t,malformedResponseCookies:i}}refreshRequestCookiesView(){if(!this.isShowing())return;this.request.hasRequestCookies()||this.request.responseCookies.length?this.emptyWidget.hideWidget():this.emptyWidget.showWidget();const{requestCookies:e,requestCookieToBlockedReasons:t}=this.getRequestCookies(),{responseCookies:i,responseCookieToBlockedReasons:r,malformedResponseCookies:s}=this.getResponseCookies();if(e.length?(this.requestCookiesTitle.classList.remove("hidden"),this.requestCookiesEmpty.classList.add("hidden"),this.requestCookiesTable.showWidget(),this.requestCookiesTable.setCookies(e,t)):this.request.blockedRequestCookies().length?(this.requestCookiesTitle.classList.remove("hidden"),this.requestCookiesEmpty.classList.remove("hidden"),this.requestCookiesTable.hideWidget()):(this.requestCookiesTitle.classList.add("hidden"),this.requestCookiesEmpty.classList.add("hidden"),this.requestCookiesTable.hideWidget()),i.length?(this.responseCookiesTitle.classList.remove("hidden"),this.responseCookiesTable.showWidget(),this.responseCookiesTable.setCookies(i,r)):(this.responseCookiesTitle.classList.add("hidden"),this.responseCookiesTable.hideWidget()),s.length){this.malformedResponseCookiesTitle.classList.remove("hidden"),this.malformedResponseCookiesList.classList.remove("hidden"),this.malformedResponseCookiesList.removeChildren();for(const e of s){const t=this.malformedResponseCookiesList.createChild("span","cookie-line source-code"),i=o.Icon.Icon.create("smallicon-error","cookie-warning-icon");t.appendChild(i),o.UIUtils.createTextChild(t,e.cookieLine),e.blockedReasons.includes("NameValuePairExceedsMaxSize")?t.title=n.NetworkRequest.setCookieBlockedReasonToUiString("NameValuePairExceedsMaxSize"):t.title=n.NetworkRequest.setCookieBlockedReasonToUiString("SyntaxError")}}else this.malformedResponseCookiesTitle.classList.add("hidden"),this.malformedResponseCookiesList.classList.add("hidden");this.request.siteHasCookieInOtherPartition()?this.siteHasCookieInOtherPartition.classList.remove("hidden"):this.siteHasCookieInOtherPartition.classList.add("hidden")}wasShown(){super.wasShown(),this.registerCSSFiles([fe]),this.request.addEventListener(n.NetworkRequest.Events.RequestHeadersChanged,this.refreshRequestCookiesView,this),this.request.addEventListener(n.NetworkRequest.Events.ResponseHeadersChanged,this.refreshRequestCookiesView,this),this.refreshRequestCookiesView()}willHide(){this.request.removeEventListener(n.NetworkRequest.Events.RequestHeadersChanged,this.refreshRequestCookiesView,this),this.request.removeEventListener(n.NetworkRequest.Events.ResponseHeadersChanged,this.refreshRequestCookiesView,this)}}var Re=Object.freeze({__proto__:null,RequestCookiesView:ye});const Ie=new CSSStyleSheet;Ie.replaceSync('.object-properties-section-dimmed{opacity:60%}.object-properties-section{padding:0;color:var(--color-text-primary);display:flex;flex-direction:column}.object-properties-section li{user-select:text}.object-properties-section li::before{top:-1px}.object-properties-section li.editing-sub-part{padding:3px 12px 8px 6px;margin:-1px -6px -8px;text-overflow:clip}.object-properties-section li.editing{margin-left:10px;text-overflow:clip}.tree-outline ol.title-less-mode{padding-left:0}.object-properties-section .own-property{font-weight:bold}.object-properties-section .synthetic-property{color:var(--color-text-secondary)}.object-properties-section .private-property-hash{color:var(--color-text-primary)}.object-properties-section-root-element{display:flex;flex-direction:row}.object-properties-section .editable-div{overflow:hidden}.object-properties-section [data-webidl="true"] > .name-and-value > .adorner{flex-shrink:0;width:16px;height:16px;margin-right:2px}.object-properties-section [data-webidl="true"] > .name-and-value > .name{font-weight:bold}.name-and-value{overflow:hidden;line-height:16px;display:flex;white-space:nowrap}.name-and-value .separator{white-space:pre;flex-shrink:0}.editing-sub-part .name-and-value{overflow:visible;display:inline-flex}.property-prompt{margin-left:4px}.tree-outline.hide-selection-when-blurred .selected:focus-visible{background:none}.tree-outline.hide-selection-when-blurred .selected:focus-visible ::slotted(*),\n.tree-outline.hide-selection-when-blurred .selected:focus-visible .tree-element-title,\n.tree-outline.hide-selection-when-blurred .selected:focus-visible .name-and-value,\n.tree-outline.hide-selection-when-blurred .selected:focus-visible .gray-info-message{background:var(--legacy-focus-bg-color);border-radius:2px;box-shadow:0 0 0 2px var(--legacy-focus-bg-color)}@media (forced-colors: active){.object-properties-section-dimmed{opacity:100%}.tree-outline.hide-selection-when-blurred .selected:focus-visible{background:Highlight}.tree-outline li:hover .tree-element-title,\n  .tree-outline li.selected .tree-element-title{color:ButtonText}.tree-outline.hide-selection-when-blurred .selected:focus-visible .tree-element-title,\n  .tree-outline.hide-selection-when-blurred .selected:focus-visible .name-and-value{background:transparent;box-shadow:none}.tree-outline.hide-selection-when-blurred .selected:focus-visible span,\n  .tree-outline.hide-selection-when-blurred .selected:focus-visible .gray-info-message{color:HighlightText}.tree-outline-disclosure:hover li.parent::before{background-color:ButtonText}}\n/*# sourceURL=objectPropertiesSection.css */\n');const xe=new CSSStyleSheet;xe.replaceSync(".value.object-value-node:hover{background-color:var(--item-hover-color)}.object-value-function-prefix,\n.object-value-boolean{color:var(--color-syntax-3)}.object-value-function{font-style:italic}.object-value-function.linkified:hover{--override-linkified-hover-background:rgb(0 0 0/10%);background-color:var(--override-linkified-hover-background);cursor:pointer}.-theme-with-dark-background .object-value-function.linkified:hover,\n:host-context(.-theme-with-dark-background) .object-value-function.linkified:hover{--override-linkified-hover-background:rgb(230 230 230/10%)}.object-value-number{color:var(--color-syntax-3)}.object-value-bigint{color:var(--color-syntax-6)}.object-value-string,\n.object-value-regexp,\n.object-value-symbol{white-space:pre;unicode-bidi:-webkit-isolate;color:var(--color-syntax-1)}.object-value-node{position:relative;vertical-align:baseline;color:var(--color-syntax-7);white-space:nowrap}.object-value-with-memory-icon{display:inline-flex}.object-value-with-memory-icon > devtools-icon{cursor:pointer}.object-value-null,\n.object-value-undefined{color:var(--color-text-disabled)}.object-value-unavailable{color:var(--color-syntax-2)}.object-value-calculate-value-button:hover{text-decoration:underline}.object-properties-section-custom-section{display:inline-flex;flex-direction:column}.-theme-with-dark-background .object-value-number,\n:host-context(.-theme-with-dark-background) .object-value-number,\n.-theme-with-dark-background .object-value-boolean,\n:host-context(.-theme-with-dark-background) .object-value-boolean{--override-primitive-dark-mode-color:hsl(252deg 100% 75%);color:var(--override-primitive-dark-mode-color)}.object-properties-section .object-description{color:var(--color-text-secondary)}.value .object-properties-preview{white-space:nowrap}.name{color:var(--color-syntax-2);flex-shrink:0}.object-properties-preview .name{color:var(--color-text-secondary)}@media (forced-colors: active){.object-value-calculate-value-button:hover{forced-color-adjust:none;color:Highlight}}\n/*# sourceURL=objectValue.css */\n");const qe=new CSSStyleSheet;qe.replaceSync('.tree-outline{padding-left:0;--override-error-background-color:#d93025;--override-error-text-color:#fff;--override-call-to-action-border-color:#f29900;--override-header-highlight-background-color:#ffff78}.-theme-with-dark-background .tree-outline,\n:host-context(.-theme-with-dark-background) .tree-outline{--override-error-text-color:#000;--override-call-to-action-border-color:rgb(255 166 13);--override-header-highlight-background-color:rgb(135 135 0)}.tree-outline > ol{padding-bottom:5px;border-bottom:solid 1px var(--color-details-hairline)}.tree-outline > .parent{user-select:none;font-weight:bold;color:var(--color-text-primary);margin-top:-1px;display:flex;align-items:center;height:26px}.tree-outline li{display:block;padding-left:5px;line-height:20px}.tree-outline li:not(.parent){margin-left:10px}.tree-outline li:not(.parent)::before{display:none}.tree-outline .caution{margin-left:4px;display:inline-block;font-weight:bold}.tree-outline li.expanded .header-count{display:none}.tree-outline li .headers-title-left{min-width:50%;display:flex;justify-content:space-between}.tree-outline li .header-toggle{display:none}.tree-outline li .status-from-cache{color:var(--color-text-secondary)}.tree-outline li.expanded .header-toggle{display:inline;margin-left:30px;font-weight:normal;color:var(--color-text-primary)}.tree-outline li .header-toggle:hover{color:var(--color-text-secondary);cursor:pointer}.tree-outline .header-name{color:var(--color-text-secondary);display:inline-block;margin-right:0.25em;font-weight:bold;vertical-align:top;white-space:pre-wrap}.tree-outline .header-separator{user-select:none}.tree-outline .header-badge-text{font-variant:small-caps;font-weight:500;white-space:pre-wrap;word-break:break-all}.tree-outline .header-warning{color:var(--override-error-background-color)}.tree-outline .header-badge{display:inline;margin-right:0.75em;background-color:var(--override-error-background-color);color:var(--override-error-text-color);border-radius:100vh;padding-left:6px;padding-right:6px}.tree-outline .header-value{display:inline;margin-right:1em;white-space:pre-wrap;word-break:break-all;margin-top:1px}.tree-outline .call-to-action{background-color:var(--color-background-elevation-1);padding:8px;border-radius:2px}.tree-outline .selected .call-to-action{background-color:transparent;padding:8px;border-radius:2px}.tree-outline .call-to-action-body{padding:6px 0;margin-left:9.5px;border-left:2px solid var(--override-call-to-action-border-color);padding-left:18px}.tree-outline .call-to-action .explanation{font-weight:bold}.tree-outline .call-to-action code{font-size:90%}.tree-outline .call-to-action .example .comment::before{content:" — "}.tree-outline .empty-request-header{color:var(--color-text-disabled)}.request-headers-show-more-button{border:none;border-radius:3px;display:inline-block;font-size:12px;font-family:sans-serif;cursor:pointer;margin:0 4px;padding:2px 4px}.request-headers-caution{display:flex;gap:6px}.header-highlight{background-color:var(--override-header-highlight-background-color)}.header-highlight:focus{background-color:var(--legacy-selection-bg-color)}.x-client-data-details{padding-left:10px}@media (forced-colors: active){:host-context(.request-headers-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected:focus{background:Highlight}:host-context(.request-headers-tree) ol.tree-outline:not(.hide-selection-when-blurred) li::before{background-color:ButtonText}:host-context(.request-headers-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected.parent::before{background-color:HighlightText}:host-context(.request-headers-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected *,\n  :host-context(.request-headers-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected.parent,\n  :host-context(.request-headers-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected.parent span,\n  :host-context(.request-headers-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected:focus .status-from-cache{color:HighlightText}}.header-decode-error{color:var(--color-accent-red)}.headers-title{display:flex;justify-content:space-between;width:100%;padding-right:5px}.tree-outline li .headers-link{display:none}.tree-outline li.expanded .headers-link{display:inline;color:var(--color-text-primary)}\n/*# sourceURL=requestHeadersTree.css */\n');const Fe=new CSSStyleSheet;Fe.replaceSync(".request-headers-view{user-select:text;overflow:auto}.resource-status-image{margin-top:-2px;margin-right:3px}.request-headers-tree{flex-grow:1;overflow-y:auto;margin:0;background-color:var(--color-background)}\n/*# sourceURL=requestHeadersView.css */\n");const Le={general:"General",copyValue:"Copy value",learnMoreInTheIssuesTab:"Learn more in the issues tab",learnMore:"Learn more",requestUrl:"Request URL",showMore:"Show more",viewParsed:"View parsed",viewSource:"View source",requestHeaders:"Request Headers",responseHeaders:"Response Headers",statusCode:"Status Code",requestMethod:"Request Method",fromMemoryCache:"(from memory cache)",fromServiceWorker:"(from `service worker`)",fromSignedexchange:"(from signed-exchange)",fromPrefetchCache:"(from prefetch cache)",fromDiskCache:"(from disk cache)",fromWebBundle:"(from Web Bundle)",provisionalHeadersAreShownS:"Provisional headers are shown. Disable cache to see full headers.",onlyProvisionalHeadersAre:"Only provisional headers are available because this request was not sent over the network and instead was served from a local cache, which doesn’t store the original request headers. Disable cache to see full request headers.",provisionalHeadersAreShown:"Provisional headers are shown",activeClientExperimentVariation:"Active `client experiment variation IDs`.",activeClientExperimentVariationIds:"Active `client experiment variation IDs` that trigger server-side behavior.",decoded:"Decoded:",remoteAddress:"Remote Address",referrerPolicy:"Referrer Policy",toEmbedThisFrameInYourDocument:"To embed this frame in your document, the response needs to enable the cross-origin embedder policy by specifying the following response header:",toUseThisResourceFromADifferent:"To use this resource from a different origin, the server needs to specify a cross-origin resource policy in the response headers:",chooseThisOptionIfTheResourceAnd:"Choose this option if the resource and the document are served from the same site.",onlyChooseThisOptionIfAn:"Only choose this option if an arbitrary website including this resource does not impose a security risk.",thisDocumentWasBlockedFrom:"This document was blocked from loading in an `iframe` with a `sandbox` attribute because this document specified a cross-origin opener policy.",toUseThisResourceFromADifferentSite:"To use this resource from a different site, the server may relax the cross-origin resource policy response header:",toUseThisResourceFromADifferentOrigin:"To use this resource from a different origin, the server may relax the cross-origin resource policy response header:",headerOverrides:"Header overrides"},He=i.i18n.registerUIStrings("panels/network/RequestHeadersView.ts",Le),Pe=i.i18n.getLocalizedString.bind(void 0,He),Ee=i.i18n.getLazilyComputedLocalizedString.bind(void 0,He);class Me extends o.Widget.VBox{request;showRequestHeadersText;showResponseHeadersText;highlightedElement;root;urlItem;requestMethodItem;statusCodeItem;remoteAddressItem;referrerPolicyItem;responseHeadersCategory;requestHeadersCategory;#e=u.Workspace.WorkspaceImpl.instance();constructor(e){super(),this.element.classList.add("request-headers-view"),this.request=e,this.showRequestHeadersText=!1,this.showResponseHeadersText=!1,this.highlightedElement=null;const t=new o.TreeOutline.TreeOutlineInShadow;t.registerCSSFiles([xe,Ie,qe]),t.element.classList.add("request-headers-tree"),t.makeDense(),t.setUseLightSelectionColor(!0),this.element.appendChild(t.element);const i=new Ne(t,"general",Pe(Le.general));i.hidden=!1,this.root=i,this.setDefaultFocusedElement(this.root.listItemElement),this.urlItem=i.createLeaf(),this.requestMethodItem=i.createLeaf(),Ue.set(this.requestMethodItem,"Request-Method"),this.statusCodeItem=i.createLeaf(),Ue.set(this.statusCodeItem,"Status-Code"),this.remoteAddressItem=i.createLeaf(),this.remoteAddressItem.hidden=!0,this.referrerPolicyItem=i.createLeaf(),this.referrerPolicyItem.hidden=!0,this.responseHeadersCategory=new Ne(t,"responseHeaders",""),this.requestHeadersCategory=new Ne(t,"requestHeaders","")}wasShown(){this.clearHighlight(),this.registerCSSFiles([Fe]),this.request.addEventListener(n.NetworkRequest.Events.RemoteAddressChanged,this.refreshRemoteAddress,this),this.request.addEventListener(n.NetworkRequest.Events.RequestHeadersChanged,this.refreshRequestHeaders,this),this.request.addEventListener(n.NetworkRequest.Events.ResponseHeadersChanged,this.refreshResponseHeaders,this),this.request.addEventListener(n.NetworkRequest.Events.FinishedLoading,this.refreshHTTPInformation,this),this.#e.addEventListener(u.Workspace.Events.UISourceCodeAdded,this.#t,this),this.#e.addEventListener(u.Workspace.Events.UISourceCodeRemoved,this.#t,this),this.refreshURL(),this.refreshRequestHeaders(),this.refreshResponseHeaders(),this.refreshHTTPInformation(),this.refreshRemoteAddress(),this.refreshReferrerPolicy(),this.root.select(!0,!1)}willHide(){this.request.removeEventListener(n.NetworkRequest.Events.RemoteAddressChanged,this.refreshRemoteAddress,this),this.request.removeEventListener(n.NetworkRequest.Events.RequestHeadersChanged,this.refreshRequestHeaders,this),this.request.removeEventListener(n.NetworkRequest.Events.ResponseHeadersChanged,this.refreshResponseHeaders,this),this.request.removeEventListener(n.NetworkRequest.Events.FinishedLoading,this.refreshHTTPInformation,this),this.#e.removeEventListener(u.Workspace.Events.UISourceCodeAdded,this.#t,this),this.#e.removeEventListener(u.Workspace.Events.UISourceCodeRemoved,this.#t,this)}addEntryContextMenuHandler(e,i){e.listItemElement.addEventListener("contextmenu",(e=>{e.consume(!0);const r=new o.ContextMenu.ContextMenu(e),s=decodeURIComponent(i);r.clipboardSection().appendItem(Pe(Le.copyValue),(()=>{t.userMetrics.actionTaken(t.UserMetrics.Action.NetworkPanelCopyValue),t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(s)})),r.show()}))}formatHeader(e,t){const i=document.createDocumentFragment();return i.createChild("div","header-name").textContent=e+": ",i.createChild("span","header-separator"),i.createChild("div","header-value source-code").textContent=t,i}formatHeaderObject(e){const i=document.createDocumentFragment();e.headerNotSet&&(i.createChild("div","header-badge header-badge-text").textContent="not-set");const r=e.value?": ":"";if(i.createChild("div","header-name").textContent=e.name+r,i.createChild("span","header-separator"),e.value&&(e.headerValueIncorrect?i.createChild("div","header-value source-code header-warning").textContent=e.value.toString():i.createChild("div","header-value source-code").textContent=e.value.toString()),e.details){const r=i.createChild("div","header-details").createChild("div","call-to-action").createChild("div","call-to-action-body");r.createChild("div","explanation").textContent=e.details.explanation();for(const t of e.details.examples){const e=r.createChild("div","example");e.createChild("code").textContent=t.codeSnippet,t.comment&&(e.createChild("span","comment").textContent=t.comment())}if(f.RelatedIssue.hasIssueOfCategory(this.request,f.Issue.IssueCategory.CrossOriginEmbedderPolicy)){const e=document.createElement("div");e.classList.add("devtools-link"),e.onclick=()=>{t.userMetrics.issuesPanelOpenedFrom(t.UserMetrics.IssueOpener.LearnMoreLinkCOEP),f.RelatedIssue.reveal(this.request,f.Issue.IssueCategory.CrossOriginEmbedderPolicy)};const i=document.createElement("span");i.classList.add("devtools-link"),i.textContent=Pe(Le.learnMoreInTheIssuesTab),e.appendChild(i),e.prepend(o.Icon.Icon.create("largeicon-breaking-change","icon")),r.appendChild(e)}else if(e.details.link){const t=o.XLink.XLink.create(e.details.link.url,Pe(Le.learnMore),"link");t.prepend(o.Icon.Icon.create("largeicon-link")),r.appendChild(t)}}return i}refreshURL(){const e=this.request.url();this.urlItem.title=this.formatHeader(Pe(Le.requestUrl),e),this.addEntryContextMenuHandler(this.urlItem,e)}populateTreeElementWithSourceText(e,t){const i=(t||"").trim(),r=i.length>3e3,s=document.createElement("span");s.classList.add("header-value"),s.classList.add("source-code"),s.textContent=r?i.substr(0,3e3):i;const n=new o.TreeOutline.TreeElement(s);if(e.removeChildren(),e.appendChild(n),!r)return;const a=document.createElement("button");function l(){a.remove(),s.textContent=i,n.listItemElement.removeEventListener("contextmenu",d)}function d(e){const t=new o.ContextMenu.ContextMenu(e);t.newSection().appendItem(Pe(Le.showMore),l),t.show()}a.classList.add("request-headers-show-more-button"),a.textContent=Pe(Le.showMore),a.addEventListener("click",l),n.listItemElement.addEventListener("contextmenu",d),s.appendChild(a)}refreshRequestHeaders(){const e=this.requestHeadersCategory,t=this.request.requestHeaders().slice();t.sort((function(e,t){return s.StringUtilities.compare(e.name.toLowerCase(),t.name.toLowerCase())}));const i=this.request.requestHeadersText();if(this.showRequestHeadersText&&i?this.refreshHeadersText(Pe(Le.requestHeaders),t.length,i,e):this.refreshHeaders(Pe(Le.requestHeaders),t,e,!1,void 0===i),i){const t=this.createHeadersToggleButton(this.showRequestHeadersText);t.addEventListener("click",this.toggleRequestHeadersText.bind(this),!1),e.listItemElement.querySelector(".headers-title-left")?.appendChild(t)}}refreshResponseHeaders(){const e=this.responseHeadersCategory,t=this.request.sortedResponseHeaders.slice(),i=this.request.responseHeadersText;if(this.showResponseHeadersText)this.refreshHeadersText(Pe(Le.responseHeaders),t.length,i,e);else{const i=[];if(this.request.wasBlocked()){const e=Ae.get(this.request.blockedReason());e&&i.push(e)}const r=v.Runtime.experiments.isEnabled(v.Runtime.ExperimentName.HEADER_OVERRIDES);this.refreshHeaders(Pe(Le.responseHeaders),function(e,t){let i=0,r=0;const o=[];for(;i<e.length||r<t.length;)i<e.length&&(r>=t.length||e[i].name<t[r].name)?o.push({...e[i++],headerNotSet:!1}):r<t.length&&(i>=e.length||e[i].name>t[r].name)?o.push({...t[r++],headerNotSet:!0}):i<e.length&&r<t.length&&e[i].name===t[r].name&&o.push({...t[r++],...e[i++],headerNotSet:!1});return o}(t,i),e,r,!1,this.request.blockedResponseCookies())}if(i){const t=this.createHeadersToggleButton(this.showResponseHeadersText);t.addEventListener("click",this.toggleResponseHeadersText.bind(this),!1),e.listItemElement.querySelector(".headers-title-left")?.appendChild(t)}}refreshHTTPInformation(){const e=this.requestMethodItem;e.hidden=!this.request.statusCode;const t=this.statusCodeItem;if(t.hidden=!this.request.statusCode,this.request.statusCode){const i=document.createDocumentFragment();i.createChild("div","header-name").textContent=Pe(Le.statusCode)+": ",i.createChild("span","header-separator");const r=i.createChild("span","resource-status-image","dt-icon-label");o.Tooltip.Tooltip.install(r,this.request.statusCode+" "+this.request.statusText),this.request.statusCode<300||304===this.request.statusCode?r.type="smallicon-green-ball":this.request.statusCode<400?r.type="smallicon-orange-ball":r.type="smallicon-red-ball",e.title=this.formatHeader(Pe(Le.requestMethod),this.request.requestMethod);const s=i.createChild("div","header-value source-code");let n=this.request.statusCode+" "+this.request.statusText;this.request.cachedInMemory()?(n+=" "+Pe(Le.fromMemoryCache),s.classList.add("status-from-cache")):this.request.fetchedViaServiceWorker?(n+=" "+Pe(Le.fromServiceWorker),s.classList.add("status-from-cache")):this.request.redirectSourceSignedExchangeInfoHasNoErrors()?(n+=" "+Pe(Le.fromSignedexchange),s.classList.add("status-from-cache")):this.request.webBundleInnerRequestInfo()?(n+=" "+Pe(Le.fromWebBundle),s.classList.add("status-from-cache")):this.request.fromPrefetchCache()?(n+=" "+Pe(Le.fromPrefetchCache),s.classList.add("status-from-cache")):this.request.cached()&&(n+=" "+Pe(Le.fromDiskCache),s.classList.add("status-from-cache")),s.textContent=n,t.title=i}}refreshHeadersTitle(t,i,r,s){i.listItemElement.removeChildren(),i.listItemElement.createChild("div","selection fill");const n=i.listItemElement.createChild("div","headers-title"),a=n.createChild("div","headers-title-left");o.UIUtils.createTextChild(a,t);const l=` (${r})`;if(a.createChild("span","header-count").textContent=l,s&&this.#e.uiSourceCodeForURL(this.#i())){const t=e.Settings.Settings.instance().moduleSetting("persistenceNetworkOverridesEnabled").get()?o.Icon.Icon.create("mediumicon-file-sync","purple-dot"):o.Icon.Icon.create("mediumicon-file"),i=n.createChild("button","link devtools-link headers-link");i.appendChild(t),i.addEventListener("click",this.#r.bind(this));const r=document.createElement("span");r.textContent=Pe(Le.headerOverrides),i.appendChild(r)}}#i(){const e=C.NetworkPersistenceManager.NetworkPersistenceManager.instance().fileUrlFromNetworkUrl(this.request.url(),!0);return e.substring(0,e.lastIndexOf("/"))+"/"+C.NetworkPersistenceManager.HEADERS_FILENAME}#r(e){e.stopPropagation();const t=this.#e.uiSourceCodeForURL(this.#i());t&&T.SourcesPanel.SourcesPanel.instance().showUISourceCode(t)}#t(e){this.#i()===e.data.url()&&this.refreshResponseHeaders()}refreshHeaders(e,t,i,r,s,a){i.removeChildren();const l=t.length;if(this.refreshHeadersTitle(e,i,l,r),s){let e,t="";this.request.cachedInMemory()||this.request.cached()?(e=Pe(Le.provisionalHeadersAreShownS),t=Pe(Le.onlyProvisionalHeadersAre)):e=Pe(Le.provisionalHeadersAreShown);const r=document.createElement("div");r.classList.add("request-headers-caution"),o.Tooltip.Tooltip.install(r,t),r.createChild("span","","dt-icon-label").type="smallicon-warning",r.createChild("div","caution").textContent=e;const s=new o.TreeOutline.TreeElement(r);r.createChild("div","learn-more").appendChild(o.XLink.XLink.create("https://developer.chrome.com/docs/devtools/network/reference/#provisional-headers",Pe(Le.learnMore))),i.appendChild(s)}const d=new Map;a&&a.forEach((e=>{d.set(e.cookieLine,e.blockedReasons)})),i.hidden=!l&&!s;for(const e of t){const t=new o.TreeOutline.TreeElement(this.formatHeaderObject(e));Ue.set(t,e.name);const r=e.name.toLowerCase();if("set-cookie"===r){const i=d.get(e.value);if(i){const e=o.Icon.Icon.create("smallicon-warning","");t.listItemElement.appendChild(e);let r="";for(const e of i)r&&(r+="\n"),r+=n.NetworkRequest.setCookieBlockedReasonToUiString(e);o.Tooltip.Tooltip.install(e,r)}}if(this.addEntryContextMenuHandler(t,e.value),i.appendChild(t),"x-client-data"===r){const i=S.parseClientVariations(e.value),r=S.formatClientVariations(i,Pe(Le.activeClientExperimentVariation),Pe(Le.activeClientExperimentVariationIds)),s=document.createElement("div");s.classList.add("x-client-data-details"),o.UIUtils.createTextChild(s,Pe(Le.decoded));const n=s.createChild("div");n.classList.add("source-code"),n.textContent=r,t.listItemElement.appendChild(s)}}}refreshHeadersText(e,t,i,r){this.populateTreeElementWithSourceText(r,i),this.refreshHeadersTitle(e,r,t,!1)}refreshRemoteAddress(){const e=this.request.remoteAddress(),t=this.remoteAddressItem;t.hidden=!e,e&&(t.title=this.formatHeader(Pe(Le.remoteAddress),e))}refreshReferrerPolicy(){const e=this.request.referrerPolicy(),t=this.referrerPolicyItem;t.hidden=!e,e&&(t.title=this.formatHeader(Pe(Le.referrerPolicy),e))}toggleRequestHeadersText(e){this.showRequestHeadersText=!this.showRequestHeadersText,this.refreshRequestHeaders(),e.consume()}toggleResponseHeadersText(e){this.showResponseHeadersText=!this.showResponseHeadersText,this.refreshResponseHeaders(),e.consume()}createToggleButton(e){const t=document.createElement("span");return t.classList.add("header-toggle"),t.textContent=e,t}createHeadersToggleButton(e){const t=Pe(e?Le.viewParsed:Le.viewSource);return this.createToggleButton(t)}clearHighlight(){this.highlightedElement&&this.highlightedElement.listItemElement.classList.remove("header-highlight"),this.highlightedElement=null}revealAndHighlight(e,t){if(this.clearHighlight(),e){if(t)for(const i of e.children())if(Ue.get(i)?.toUpperCase()===t.toUpperCase())return this.highlightedElement=i,i.reveal(),void i.listItemElement.classList.add("header-highlight");e.childCount()>0&&e.childAt(0)?.reveal()}}getCategoryForSection(e){switch(e){case p.UIRequestLocation.UIHeaderSection.General:return this.root;case p.UIRequestLocation.UIHeaderSection.Request:return this.requestHeadersCategory;case p.UIRequestLocation.UIHeaderSection.Response:return this.responseHeadersCategory}}revealHeader(e,t){this.revealAndHighlight(this.getCategoryForSection(e),t)}}const Ue=new WeakMap;class Ne extends o.TreeOutline.TreeElement{toggleOnClick;expandedSetting;expanded;constructor(t,i,r){super(r||"",!0),this.toggleOnClick=!0,this.hidden=!0,this.expandedSetting=e.Settings.Settings.instance().createSetting("request-info-"+i+"-category-expanded",!0),this.expanded=this.expandedSetting.get(),t.appendChild(this)}createLeaf(){const e=new o.TreeOutline.TreeElement;return this.appendChild(e),e}onexpand(){this.expandedSetting.set(!0)}oncollapse(){this.expandedSetting.set(!1)}}const Ae=new Map([["coep-frame-resource-needs-coep-header",{name:"cross-origin-embedder-policy",value:null,headerValueIncorrect:null,details:{explanation:Ee(Le.toEmbedThisFrameInYourDocument),examples:[{codeSnippet:"Cross-Origin-Embedder-Policy: require-corp",comment:void 0}],link:{url:"https://web.dev/coop-coep/"}},headerNotSet:null}],["corp-not-same-origin-after-defaulted-to-same-origin-by-coep",{name:"cross-origin-resource-policy",value:null,headerValueIncorrect:null,details:{explanation:Ee(Le.toUseThisResourceFromADifferent),examples:[{codeSnippet:"Cross-Origin-Resource-Policy: same-site",comment:Ee(Le.chooseThisOptionIfTheResourceAnd)},{codeSnippet:"Cross-Origin-Resource-Policy: cross-origin",comment:Ee(Le.onlyChooseThisOptionIfAn)}],link:{url:"https://web.dev/coop-coep/"}},headerNotSet:null}],["coop-sandboxed-iframe-cannot-navigate-to-coop-page",{name:"cross-origin-opener-policy",value:null,headerValueIncorrect:!1,details:{explanation:Ee(Le.thisDocumentWasBlockedFrom),examples:[],link:{url:"https://web.dev/coop-coep/"}},headerNotSet:null}],["corp-not-same-site",{name:"cross-origin-resource-policy",value:null,headerValueIncorrect:!0,details:{explanation:Ee(Le.toUseThisResourceFromADifferentSite),examples:[{codeSnippet:"Cross-Origin-Resource-Policy: cross-origin",comment:Ee(Le.onlyChooseThisOptionIfAn)}],link:null},headerNotSet:null}],["corp-not-same-origin",{name:"cross-origin-resource-policy",value:null,headerValueIncorrect:!0,details:{explanation:Ee(Le.toUseThisResourceFromADifferentOrigin),examples:[{codeSnippet:"Cross-Origin-Resource-Policy: same-site",comment:Ee(Le.chooseThisOptionIfTheResourceAnd)},{codeSnippet:"Cross-Origin-Resource-Policy: cross-origin",comment:Ee(Le.onlyChooseThisOptionIfAn)}],link:null},headerNotSet:null}]]);var Be=Object.freeze({__proto__:null,RequestHeadersView:Me,Category:Ne});const Ve=new CSSStyleSheet;Ve.replaceSync(".tree-outline{padding-left:0;--override-error-background-color:#d93025;--override-error-text-color:#fff;--override-call-to-action-border-color:#f29900;--override-header-highlight-background-color:#ffff78}.-theme-with-dark-background .tree-outline,\n:host-context(.-theme-with-dark-background) .tree-outline{--override-error-text-color:#000;--override-call-to-action-border-color:rgb(255 166 13);--override-header-highlight-background-color:rgb(135 135 0)}.tree-outline > ol{padding-bottom:5px;border-bottom:solid 1px var(--color-details-hairline)}.tree-outline > .parent{user-select:none;font-weight:bold;color:var(--color-text-primary);margin-top:-1px;display:flex;align-items:center;height:26px}.tree-outline li{padding-left:5px;line-height:20px}.tree-outline li:not(.parent){margin-left:10px;display:block}.tree-outline li:not(.parent)::before{display:none}.tree-outline li.expanded .payload-count{display:none}.tree-outline li .payload-toggle{display:none}.tree-outline li.expanded .payload-toggle{display:inline;margin-left:30px;font-weight:normal;color:var(--color-text-primary)}.tree-outline li.expanded .payload-toggle:focus-visible{border:2px solid var(--color-button-outline-focus);border-radius:5px}.tree-outline li .header-toggle:hover{color:var(--color-text-secondary)}.tree-outline .payload-name{color:var(--color-text-secondary);display:inline-flex;margin-right:0.25em;font-weight:bold;vertical-align:top;white-space:pre-wrap}.tree-outline .payload-separator{user-select:none}.tree-outline .payload-value{display:inline;margin-right:1em;white-space:pre-wrap;word-break:break-all;margin-top:1px}.tree-outline .empty-request-payload{color:var(--color-text-disabled)}.request-payload-show-more-button{border:none;border-radius:3px;display:inline-block;font-size:12px;font-family:sans-serif;margin:0 4px;padding:2px 4px}@media (forced-colors: active){:host-context(.request-payload-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected:focus{background:Highlight}:host-context(.request-payload-tree) ol.tree-outline:not(.hide-selection-when-blurred) li::before{background-color:ButtonText}:host-context(.request-payload-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected.parent::before{background-color:HighlightText}:host-context(.request-payload-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected *,\n  :host-context(.request-payload-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected.parent,\n  :host-context(.request-payload-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected.parent span{color:HighlightText}}.payload-decode-error{color:var(--color-accent-red)}\n/*# sourceURL=requestPayloadTree.css */\n");const We=new CSSStyleSheet;We.replaceSync(".request-payload-view{user-select:text;overflow:auto}.request-payload-tree{flex-grow:1;overflow-y:auto;margin:0}\n/*# sourceURL=requestPayloadView.css */\n");const Oe={copyValue:"Copy value",requestPayload:"Request Payload",unableToDecodeValue:"(unable to decode value)",queryStringParameters:"Query String Parameters",formData:"Form Data",showMore:"Show more",viewParsed:"View parsed",empty:"(empty)",viewSource:"View source",viewUrlEncoded:"View URL-encoded",viewDecoded:"View decoded",viewUrlEncodedL:"view URL-encoded",viewDecodedL:"view decoded",viewParsedL:"view parsed",viewSourceL:"view source"},De=i.i18n.registerUIStrings("panels/network/RequestPayloadView.ts",Oe),Ge=i.i18n.getLocalizedString.bind(void 0,De);class ze extends o.Widget.VBox{request;decodeRequestParameters;queryStringCategory;formDataCategory;requestPayloadCategory;constructor(e){super(),this.element.classList.add("request-payload-view"),this.request=e,this.decodeRequestParameters=!0;const t=e.requestContentType();t&&(this.decodeRequestParameters=Boolean(t.match(/^application\/x-www-form-urlencoded\s*(;.*)?$/i)));const i=new o.TreeOutline.TreeOutlineInShadow;i.registerCSSFiles([xe,Ie,Ve]),i.element.classList.add("request-payload-tree"),i.makeDense(),this.element.appendChild(i.element),this.queryStringCategory=new je(i,"queryString",""),this.formDataCategory=new je(i,"formData",""),this.requestPayloadCategory=new je(i,"requestPayload",Ge(Oe.requestPayload))}wasShown(){this.registerCSSFiles([We]),this.request.addEventListener(n.NetworkRequest.Events.RequestHeadersChanged,this.refreshFormData,this),this.refreshQueryString(),this.refreshFormData()}willHide(){this.request.removeEventListener(n.NetworkRequest.Events.RequestHeadersChanged,this.refreshFormData,this)}addEntryContextMenuHandler(e,i){e.listItemElement.addEventListener("contextmenu",(e=>{e.consume(!0);const r=new o.ContextMenu.ContextMenu(e),s=decodeURIComponent(i);r.clipboardSection().appendItem(Ge(Oe.copyValue),(()=>{t.userMetrics.actionTaken(t.UserMetrics.Action.NetworkPanelCopyValue),t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(s)})),r.show()}))}formatParameter(e,t,i){let r=!1;if(i&&(e=e.replace(/\+/g," ")).indexOf("%")>=0)try{e=decodeURIComponent(e)}catch(e){r=!0}const o=document.createElement("div");return t&&(o.className=t),""===e&&o.classList.add("empty-value"),r?o.createChild("span","payload-decode-error").textContent=Ge(Oe.unableToDecodeValue):o.textContent=e,o}refreshQueryString(){const e=this.request.queryString(),t=this.request.queryParameters;this.queryStringCategory.hidden=!t,t&&this.refreshParams(Ge(Oe.queryStringParameters),t,e,this.queryStringCategory)}async refreshFormData(){const e=await this.request.requestFormData();if(!e)return this.formDataCategory.hidden=!0,void(this.requestPayloadCategory.hidden=!0);const t=await this.request.formParameters();if(t)this.formDataCategory.hidden=!1,this.requestPayloadCategory.hidden=!0,this.refreshParams(Ge(Oe.formData),t,e,this.formDataCategory);else{this.requestPayloadCategory.hidden=!1,this.formDataCategory.hidden=!0;try{const t=JSON.parse(e);this.refreshRequestJSONPayload(t,e)}catch(t){this.populateTreeElementWithSourceText(this.requestPayloadCategory,e)}}}populateTreeElementWithSourceText(e,t){const i=(t||"").trim(),r=i.length>3e3,s=document.createElement("span");s.classList.add("payload-value"),s.classList.add("source-code"),s.textContent=r?i.substr(0,3e3):i;const n=new o.TreeOutline.TreeElement(s);if(e.removeChildren(),e.appendChild(n),!r)return;const a=document.createElement("button");function l(){a.remove(),s.textContent=i,n.listItemElement.removeEventListener("contextmenu",d)}function d(e){const t=new o.ContextMenu.ContextMenu(e);t.newSection().appendItem(Ge(Oe.showMore),l),t.show()}a.classList.add("request-payload-show-more-button"),a.textContent=Ge(Oe.showMore),a.addEventListener("click",l),n.listItemElement.addEventListener("contextmenu",d),s.appendChild(a)}refreshParams(e,t,i,r){r.removeChildren(),r.listItemElement.removeChildren(),r.listItemElement.createChild("div","selection fill"),o.UIUtils.createTextChild(r.listItemElement,e);const s=document.createElement("span");s.classList.add("payload-count");const n=t?t.length:0;s.textContent=` (${n})`,r.listItemElement.appendChild(s);_e.has(r)?this.appendParamsSource(e,t,i,r):this.appendParamsParsed(e,t,i,r)}appendParamsSource(e,t,i,r){this.populateTreeElementWithSourceText(r,i);const s=r.listItemElement,n=function(o){s.removeEventListener("contextmenu",a),_e.delete(r),this.refreshParams(e,t,i,r),o.consume()},a=e=>{if(!r.expanded)return;const t=new o.ContextMenu.ContextMenu(e);t.newSection().appendItem(Ge(Oe.viewParsed),n.bind(this,e)),t.show()},l=this.createViewSourceToggle(!0,n.bind(this));s.appendChild(l),s.addEventListener("contextmenu",a)}appendParamsParsed(e,t,i,r){for(const e of t||[]){const t=document.createDocumentFragment();if(""!==e.name){const i=this.formatParameter(e.name+": ","payload-name",this.decodeRequestParameters),r=this.formatParameter(e.value,"payload-value source-code",this.decodeRequestParameters);t.appendChild(i),t.createChild("span","payload-separator"),t.appendChild(r)}else t.appendChild(this.formatParameter(Ge(Oe.empty),"empty-request-payload",this.decodeRequestParameters));const i=new o.TreeOutline.TreeElement(t);this.addEntryContextMenuHandler(i,e.value),r.appendChild(i)}const s=r.listItemElement,n=function(o){s.removeEventListener("contextmenu",l),_e.add(r),this.refreshParams(e,t,i,r),o.consume()},a=function(e){s.removeEventListener("contextmenu",l),this.toggleURLDecoding(e)},l=e=>{if(!r.expanded)return;const t=new o.ContextMenu.ContextMenu(e),i=t.newSection();i.appendItem(Ge(Oe.viewSource),n.bind(this,e));const s=this.decodeRequestParameters?Ge(Oe.viewUrlEncoded):Ge(Oe.viewDecoded);i.appendItem(s,a.bind(this,e)),t.show()},d=this.createViewSourceToggle(!1,n.bind(this));s.appendChild(d);const c=this.decodeRequestParameters?Ge(Oe.viewUrlEncodedL):Ge(Oe.viewDecodedL),h=this.createToggleButton(c);h.addEventListener("click",a.bind(this),!1),s.appendChild(h),s.addEventListener("contextmenu",l)}refreshRequestJSONPayload(e,t){const i=this.requestPayloadCategory;i.removeChildren();const r=i.listItemElement;r.removeChildren(),r.createChild("div","selection fill"),o.UIUtils.createTextChild(r,this.requestPayloadCategory.title.toString()),_e.has(i)?this.appendJSONPayloadSource(i,e,t):this.appendJSONPayloadParsed(i,e,t)}appendJSONPayloadSource(e,t,i){const r=e.listItemElement;this.populateTreeElementWithSourceText(e,i);const s=function(o){r.removeEventListener("contextmenu",a),_e.delete(e),this.refreshRequestJSONPayload(t,i),o.consume()},n=this.createViewSourceToggle(!0,s.bind(this));r.appendChild(n);const a=t=>{if(!e.expanded)return;const i=new o.ContextMenu.ContextMenu(t);i.newSection().appendItem(Ge(Oe.viewParsed),s.bind(this,t)),i.show()};r.addEventListener("contextmenu",a)}appendJSONPayloadParsed(e,t,i){const r=n.RemoteObject.RemoteObject.fromLocalObject(t),s=new y.ObjectPropertiesSection.RootElement(r);s.title=r.description,s.expand(),s.editable=!1,e.childrenListElement.classList.add("source-code","object-properties-section"),e.appendChild(s);const a=e.listItemElement,l=function(r){a.removeEventListener("contextmenu",d),_e.add(e),this.refreshRequestJSONPayload(t,i),r.consume()},d=t=>{if(!e.expanded)return;const i=new o.ContextMenu.ContextMenu(t);i.newSection().appendItem(Ge(Oe.viewSource),l.bind(this,t)),i.show()},c=this.createViewSourceToggle(!1,l.bind(this));a.appendChild(c),a.addEventListener("contextmenu",d)}createViewSourceToggle(e,t){const i=Ge(e?Oe.viewParsedL:Oe.viewSourceL),r=this.createToggleButton(i);return r.addEventListener("click",t,!1),r}toggleURLDecoding(e){this.decodeRequestParameters=!this.decodeRequestParameters,this.refreshQueryString(),this.refreshFormData(),e.consume()}createToggleButton(e){const t=document.createElement("span");return t.classList.add("payload-toggle"),t.tabIndex=0,t.setAttribute("role","button"),t.textContent=e,t}}const _e=new WeakSet;class je extends o.TreeOutline.TreeElement{toggleOnClick;expandedSetting;expanded;constructor(t,i,r){super(r||"",!0),this.toggleOnClick=!0,this.hidden=!0,this.expandedSetting=e.Settings.Settings.instance().createSetting("request-info-"+i+"-category-expanded",!0),this.expanded=this.expandedSetting.get(),t.appendChild(this)}createLeaf(){const e=new o.TreeOutline.TreeElement;return this.appendChild(e),e}onexpand(){this.expandedSetting.set(!0)}oncollapse(){this.expandedSetting.set(!1)}}var Ke=Object.freeze({__proto__:null,RequestPayloadView:ze,Category:je});const $e=new CSSStyleSheet;$e.replaceSync(".request-initiator-view{display:block;margin:6px}\n/*# sourceURL=requestInitiatorView.css */\n");const Xe=new CSSStyleSheet;Xe.replaceSync(".request-initiator-view-tree .fill{right:-6px}.request-initiator-view-section-title{font-weight:bold;padding:4px}.request-initiator-view-section-title:focus-visible{background-color:var(--color-background-elevation-2)}@media (forced-colors: active){.request-initiator-view-section-title:focus-visible{forced-color-adjust:none;background-color:Highlight;color:HighlightText}}\n/*# sourceURL=requestInitiatorViewTree.css */\n");const Je={thisRequestHasNoInitiatorData:"This request has no initiator data.",requestCallStack:"Request call stack",requestInitiatorChain:"Request initiator chain"},Ye=i.i18n.registerUIStrings("panels/network/RequestInitiatorView.ts",Je),Qe=i.i18n.getLocalizedString.bind(void 0,Ye);class Ze extends o.Widget.VBox{linkifier;request;emptyWidget;hasShown;constructor(e){super(),this.element.classList.add("request-initiator-view"),this.linkifier=new g.Linkifier.Linkifier,this.request=e,this.emptyWidget=new o.EmptyWidget.EmptyWidget(Qe(Je.thisRequestHasNoInitiatorData)),this.emptyWidget.show(this.element),this.hasShown=!1}static createStackTracePreview(e,t,i){const r=e.initiator();if(!r||!r.stack)return null;const o=n.NetworkManager.NetworkManager.forRequest(e),s=o?o.target():null;return g.JSPresentationUtils.buildStackTracePreviewContents(s,t,{stackTrace:r.stack,tabStops:i})}createTree(){const e=new o.TreeOutline.TreeOutlineInShadow;return e.registerCSSFiles([Xe]),e.contentElement.classList.add("request-initiator-view-tree"),e}buildRequestChainTree(e,t,i){const r=new o.TreeOutline.TreeElement(t);i.appendChild(r),r.titleElement instanceof HTMLElement&&r.titleElement.classList.add("request-initiator-view-section-title");const s=e.initiators;let n=r;for(const e of Array.from(s).reverse()){const t=new o.TreeOutline.TreeElement(e.url());n.appendChild(t),n.expand(),n=t}r.expand(),n.select();const a=n.titleElement;a instanceof HTMLElement&&(a.style.fontWeight="bold");const l=e.initiated;return this.depthFirstSearchTreeBuilder(l,n,this.request),r}depthFirstSearchTreeBuilder(e,t,i){const r=new Set;r.add(this.request);for(const s of e.keys())if(e.get(s)===i){const i=new o.TreeOutline.TreeElement(s.url());t.appendChild(i),t.expand(),r.has(s)||(r.add(s),this.depthFirstSearchTreeBuilder(e,i,s))}}buildStackTraceSection(e,t,i){const r=new o.TreeOutline.TreeElement(t);i.appendChild(r),r.titleElement instanceof HTMLElement&&r.titleElement.classList.add("request-initiator-view-section-title");const s=new o.TreeOutline.TreeElement(e,!1);s.selectable=!1,r.appendChild(s),r.expand()}wasShown(){if(this.hasShown)return;this.registerCSSFiles([$e]);let e=!1;const t=this.createTree(),i=Ze.createStackTracePreview(this.request,this.linkifier,!0);i&&(e=!0,this.buildStackTraceSection(i.element,Qe(Je.requestCallStack),t));const r=h.NetworkLog.NetworkLog.instance().initiatorGraphForRequest(this.request);(r.initiators.size>1||r.initiated.size>1)&&(e=!0,this.buildRequestChainTree(r,Qe(Je.requestInitiatorChain),t));const o=t.firstChild();o&&o.select(!0),e&&(this.element.appendChild(t.element),this.emptyWidget.hideWidget()),this.hasShown=!0}}var et=Object.freeze({__proto__:null,RequestInitiatorView:Ze});const tt=new CSSStyleSheet;tt.replaceSync(".html-preview-frame{--override-preview-frame-background:#fff;box-shadow:var(--drop-shadow);background:var(--override-preview-frame-background);flex-grow:1;margin:20px}\n/*# sourceURL=requestHTMLView.css */\n");class it extends o.Widget.VBox{dataURL;constructor(e){super(!0),this.dataURL=encodeURI(e).replace(/#/g,"%23"),this.contentElement.classList.add("html","request-view")}wasShown(){this.createIFrame(),this.registerCSSFiles([tt])}willHide(){this.contentElement.removeChildren()}createIFrame(){this.contentElement.removeChildren();const e=document.createElement("iframe");e.className="html-preview-frame",e.setAttribute("sandbox",""),e.setAttribute("csp","default-src 'none';style-src 'unsafe-inline'"),e.setAttribute("src",this.dataURL),e.tabIndex=-1,o.ARIAUtils.markAsPresentation(e),this.contentElement.appendChild(e)}}var rt=Object.freeze({__proto__:null,RequestHTMLView:it});const ot={thisRequestHasNoResponseData:"This request has no response data available.",failedToLoadResponseData:"Failed to load response data"},st=i.i18n.registerUIStrings("panels/network/RequestResponseView.ts",ot),nt=i.i18n.getLocalizedString.bind(void 0,st);class at extends o.Widget.VBox{request;contentViewPromise;constructor(e){super(),this.element.classList.add("request-view"),this.request=e,this.contentViewPromise=null}static hasTextContent(t,i){const r=t.mimeType||"";let o=e.ResourceType.ResourceType.fromMimeType(r);return o===e.ResourceType.resourceTypes.Other&&(o=t.contentType()),o===e.ResourceType.resourceTypes.Image?r.startsWith("image/svg"):!!o.isTextType()||!i.error&&(o===e.ResourceType.resourceTypes.Other&&(Boolean(i.content)&&!i.encoded))}static async sourceViewForRequest(e){let i=lt.get(e);if(void 0!==i)return i;const o=await e.contentData();if(!at.hasTextContent(e,o))return lt.delete(e),null;const s=e.resourceType().canonicalMimeType()||e.mimeType;return t.userMetrics.networkPanelResponsePreviewOpened(s),i=r.ResourceSourceFrame.ResourceSourceFrame.createSearchableView(e,s),lt.set(e,i),i}wasShown(){this.doShowPreview()}doShowPreview(){return this.contentViewPromise||(this.contentViewPromise=this.showPreview()),this.contentViewPromise}async showPreview(){const e=await this.createPreview();return e.show(this.element),e}async createPreview(){const e=await this.request.contentData(),t=await at.sourceViewForRequest(this.request);return e.content&&t||e.error?e.content&&t?t:e.error?new o.EmptyWidget.EmptyWidget(nt(ot.failedToLoadResponseData)+": "+e.error):204===this.request.statusCode?new o.EmptyWidget.EmptyWidget(nt(ot.thisRequestHasNoResponseData)):new o.EmptyWidget.EmptyWidget(nt(ot.failedToLoadResponseData)):new o.EmptyWidget.EmptyWidget(nt(ot.thisRequestHasNoResponseData))}async revealLine(e){const t=await this.doShowPreview();t instanceof r.ResourceSourceFrame.SearchableContainer&&t.revealPosition(e)}}const lt=new WeakMap;var dt=Object.freeze({__proto__:null,RequestResponseView:at});const ct=new CSSStyleSheet;ct.replaceSync(".tree-outline{padding-left:0}.tree-outline > ol{padding-bottom:5px;border-bottom:solid 1px var(--color-details-hairline)}.tree-outline > .parent{user-select:none;font-weight:bold;color:var(--color-text-primary);margin-top:-1px;display:flex;align-items:center;height:26px}.tree-outline li{padding-left:5px;line-height:20px}.tree-outline li:not(.parent){display:block;margin-left:10px}.tree-outline li:not(.parent)::before{display:none}.tree-outline .header-name{color:var(--color-text-secondary);display:inline-block;margin-right:0.25em;font-weight:bold;vertical-align:top;white-space:pre-wrap}.tree-outline .header-separator{user-select:none}.tree-outline .header-value{display:inline;margin-right:1em;white-space:pre-wrap;word-break:break-all;margin-top:1px}.tree-outline .header-toggle{display:inline;margin-left:30px;font-weight:normal;color:var(--color-text-disabled)}.tree-outline .header-toggle:hover{--override-header-hover-color:rgb(20% 20% 45%);color:var(--override-header-hover-color)}.-theme-with-dark-background .tree-outline .header-toggle:hover,\n:host-context(.-theme-with-dark-background) .tree-outline .header-toggle:hover{--override-header-hover-color:rgb(140 140 204)}.tree-outline .error-log{color:var(--color-red);display:inline-block;margin-right:0.25em;margin-left:0.25em;font-weight:bold;vertical-align:top;white-space:pre-wrap}.tree-outline .hex-data{display:block;word-break:break-word;margin-left:20px}.tree-outline .error-field{color:var(--color-red)}\n/*# sourceURL=signedExchangeInfoTree.css */\n");const ht=new CSSStyleSheet;ht.replaceSync(".signed-exchange-info-view{user-select:text;overflow:auto}.signed-exchange-info-tree{flex-grow:1;overflow-y:auto;margin:0}\n/*# sourceURL=signedExchangeInfoView.css */\n");const ut={errors:"Errors",signedHttpExchange:"Signed HTTP exchange",learnmore:"Learn more",requestUrl:"Request URL",responseCode:"Response code",headerIntegrityHash:"Header integrity hash",responseHeaders:"Response headers",signature:"Signature",label:"Label",certificateUrl:"Certificate URL",viewCertificate:"View certificate",integrity:"Integrity",certificateSha:"Certificate SHA256",validityUrl:"Validity URL",date:"Date",expires:"Expires",certificate:"Certificate",subject:"Subject",validFrom:"Valid from",validUntil:"Valid until",issuer:"Issuer"},pt=i.i18n.registerUIStrings("panels/network/SignedExchangeInfoView.ts",ut),mt=i.i18n.getLocalizedString.bind(void 0,pt);class gt extends o.Widget.VBox{responseHeadersItem;constructor(e){super(),console.assert(null!==e.signedExchangeInfo());const i=e.signedExchangeInfo();this.element.classList.add("signed-exchange-info-view");const r=new o.TreeOutline.TreeOutlineInShadow;r.registerCSSFiles([ct]),r.element.classList.add("signed-exchange-info-tree"),r.setFocusable(!1),r.makeDense(),r.expandTreeElementsWhenArrowing=!0,this.element.appendChild(r.element);const s=new Map;if(i.errors&&i.errors.length){const e=new wt(r,mt(ut.errors));for(const t of i.errors){const i=document.createDocumentFragment();if(i.appendChild(o.Icon.Icon.create("smallicon-error","prompt-icon")),i.createChild("div","error-log").textContent=t.message,e.createLeaf(i),t.errorField){let e=s.get(t.signatureIndex);e||(e=new Set,s.set(t.signatureIndex,e)),e.add(t.errorField)}}}const n=document.createDocumentFragment();n.createChild("div","header-name").textContent=mt(ut.signedHttpExchange);const a=o.XLink.XLink.create("https://github.com/WICG/webpackage",mt(ut.learnmore),"header-toggle");n.appendChild(a);const l=new wt(r,n);if(i.header){const n=i.header,a=e.redirectDestination(),d=this.formatHeader(mt(ut.requestUrl),n.requestUrl);if(a){const e=g.Linkifier.Linkifier.linkifyRevealable(a,"View request");e.classList.add("header-toggle"),d.appendChild(e)}l.createLeaf(d),l.createLeaf(this.formatHeader(mt(ut.responseCode),String(n.responseCode))),l.createLeaf(this.formatHeader(mt(ut.headerIntegrityHash),n.headerIntegrity)),this.responseHeadersItem=l.createLeaf(this.formatHeader(mt(ut.responseHeaders),""));const c=n.responseHeaders;for(const e in c){const t=new o.TreeOutline.TreeElement(this.formatHeader(e,c[e]));t.selectable=!1,this.responseHeadersItem.appendChild(t)}this.responseHeadersItem.expand();for(let e=0;e<n.signatures.length;++e){const i=s.get(e)||new Set,o=n.signatures[e],a=new wt(r,mt(ut.signature));if(a.createLeaf(this.formatHeader(mt(ut.label),o.label)),a.createLeaf(this.formatHeaderForHexData(mt(ut.signature),o.signature,i.has("signatureSig"))),o.certUrl){const e=this.formatHeader(mt(ut.certificateUrl),o.certUrl,i.has("signatureCertUrl"));if(o.certificates){const i=e.createChild("span","devtools-link header-toggle");i.textContent=mt(ut.viewCertificate),i.addEventListener("click",t.InspectorFrontendHost.InspectorFrontendHostInstance.showCertificateViewer.bind(null,o.certificates),!1)}a.createLeaf(e)}a.createLeaf(this.formatHeader(mt(ut.integrity),o.integrity,i.has("signatureIntegrity"))),o.certSha256&&a.createLeaf(this.formatHeaderForHexData(mt(ut.certificateSha),o.certSha256,i.has("signatureCertSha256"))),a.createLeaf(this.formatHeader(mt(ut.validityUrl),o.validityUrl,i.has("signatureValidityUrl"))),a.createLeaf().title=this.formatHeader(mt(ut.date),new Date(1e3*o.date).toUTCString(),i.has("signatureTimestamps")),a.createLeaf().title=this.formatHeader(mt(ut.expires),new Date(1e3*o.expires).toUTCString(),i.has("signatureTimestamps"))}}if(i.securityDetails){const e=i.securityDetails,t=new wt(r,mt(ut.certificate));t.createLeaf(this.formatHeader(mt(ut.subject),e.subjectName)),t.createLeaf(this.formatHeader(mt(ut.validFrom),new Date(1e3*e.validFrom).toUTCString())),t.createLeaf(this.formatHeader(mt(ut.validUntil),new Date(1e3*e.validTo).toUTCString())),t.createLeaf(this.formatHeader(mt(ut.issuer),e.issuer))}}formatHeader(e,t,i){const r=document.createDocumentFragment(),o=r.createChild("div","header-name");o.textContent=e+": ",r.createChild("span","header-separator");const s=r.createChild("div","header-value source-code");return s.textContent=t,i&&(o.classList.add("error-field"),s.classList.add("error-field")),r}formatHeaderForHexData(e,t,i){const r=document.createDocumentFragment(),o=r.createChild("div","header-name");o.textContent=e+": ",r.createChild("span","header-separator");const s=r.createChild("div","header-value source-code hex-data");return s.textContent=t.replace(/(.{2})/g,"$1 "),i&&(o.classList.add("error-field"),s.classList.add("error-field")),r}wasShown(){super.wasShown(),this.registerCSSFiles([ht])}}class wt extends o.TreeOutline.TreeElement{toggleOnClick;expanded;constructor(e,t){super(t,!0),this.selectable=!1,this.toggleOnClick=!0,this.expanded=!0,e.appendChild(this)}createLeaf(e){const t=new o.TreeOutline.TreeElement(e);return t.selectable=!1,this.appendChild(t),t}}var vt=Object.freeze({__proto__:null,SignedExchangeInfoView:gt,Category:wt});const bt=new CSSStyleSheet;bt.replaceSync(":host{--icon-padding:4px}.header{display:flex;font-weight:bold;padding:calc(2 * var(--icon-padding)) var(--icon-padding)}.icon{margin:0 var(--icon-padding)}\n/*# sourceURL=WebBundleInfoView.css */\n");const{render:kt,html:ft}=I,Ct={bundledResource:"Bundled resource"},St=i.i18n.registerUIStrings("panels/network/components/WebBundleInfoView.ts",Ct),Tt=i.i18n.getLocalizedString.bind(void 0,St);class yt extends o.Widget.VBox{constructor(e){super();const t=e.webBundleInfo();if(!t)throw new Error("Trying to render a Web Bundle info without providing data");const i=new Rt(t,e.parsedURL.lastPathComponent);this.contentElement.appendChild(i),i.render()}}class Rt extends HTMLElement{static litTagName=I.literal`devtools-web-bundle-info`;#o=this.attachShadow({mode:"open"});#s;#n;constructor(e,t){super(),this.#s=e,this.#n=t}connectedCallback(){this.#o.adoptedStyleSheets=[bt]}render(){const t=this.#s.resourceUrls?.map((t=>{const i=e.ResourceType.ResourceType.mimeFromURL(t)||null,r=e.ResourceType.ResourceType.fromMimeTypeOverride(i)||e.ResourceType.ResourceType.fromMimeType(i),o=w(r);return{cells:[{columnId:"url",value:null,renderer:()=>ft` <div style="display: flex;"> <${q.Icon.Icon.litTagName} class="icon" .data="${{color:"",iconName:o,width:"18px"}}"> </${q.Icon.Icon.litTagName}> <span>${t}</span> </div>`}]}}));kt(ft` <div class="header"> <${q.Icon.Icon.litTagName} class="icon" .data="${{color:"",iconName:"resourceWebBundle",width:"16px"}}"> </${q.Icon.Icon.litTagName}> <span>${this.#n}</span> <x-link href="https://web.dev/web-bundles/#explaining-web-bundles"> <${q.Icon.Icon.litTagName} class="icon" .data="${{color:"var(--color-text-secondary)",iconName:"help_outline",width:"16px"}}"> </${q.Icon.Icon.litTagName}> </x-link> </div> <div> <${F.DataGrid.DataGrid.litTagName} .data="${{columns:[{id:"url",title:Tt(Ct.bundledResource),widthWeighting:1,visible:!0,hideable:!1}],rows:t,activeSort:null}}"> </${F.DataGrid.DataGrid.litTagName}> </div>`,this.#o,{host:this})}}x.CustomElements.defineComponent("devtools-web-bundle-info",Rt);const It={failedToLoadResponseData:"Failed to load response data",previewNotAvailable:"Preview not available"},xt=i.i18n.registerUIStrings("panels/network/RequestPreviewView.ts",It),qt=i.i18n.getLocalizedString.bind(void 0,xt);class Ft extends at{constructor(e){super(e)}async showPreview(){const e=await super.showPreview();if(!(e instanceof o.View.SimpleView))return e;const t=new o.Toolbar.Toolbar("network-item-preview-toolbar",this.element);return e.toolbarItems().then((e=>{e.map((e=>t.appendToolbarItem(e)))})),e}async htmlPreview(){const e=await this.request.contentData();if(e.error)return new o.EmptyWidget.EmptyWidget(qt(It.failedToLoadResponseData)+": "+e.error);if(!new Set(["text/html","text/plain","application/xhtml+xml"]).has(this.request.mimeType))return null;const t=e.encoded?window.atob(e.content):e.content,i=await r.JSONView.JSONView.createView(t);if(i)return i;const s=R.ContentProvider.contentAsDataURL(e.content,this.request.mimeType,e.encoded,this.request.charset());return s?new it(s):null}async createPreview(){if(this.request.signedExchangeInfo())return new gt(this.request);if(this.request.webBundleInfo())return new yt(this.request);const e=await this.htmlPreview();if(e)return e;const t=await r.PreviewFactory.PreviewFactory.createPreview(this.request,this.request.mimeType);return t||new o.EmptyWidget.EmptyWidget(qt(It.previewNotAvailable))}}var Lt=Object.freeze({__proto__:null,RequestPreviewView:Ft});const Ht={sLatencySDownloadSTotal:"{PH1} latency, {PH2} download ({PH3} total)",sLatency:"{PH1} latency",sDownload:"{PH1} download",sFromServiceworker:"{PH1} (from `ServiceWorker`)",sFromCache:"{PH1} (from cache)"},Pt=i.i18n.registerUIStrings("panels/network/NetworkTimeCalculator.ts",Ht),Et=i.i18n.getLocalizedString.bind(void 0,Pt);class Mt{minimum;maximum;constructor(e,t){this.minimum=e,this.maximum=t}equals(e){return this.minimum===e.minimum&&this.maximum===e.maximum}}class Ut extends e.ObjectWrapper.ObjectWrapper{startAtZero;minimumBoundaryInternal;maximumBoundaryInternal;boundryChangedEventThrottler;window;workingArea;constructor(t){super(),this.startAtZero=t,this.minimumBoundaryInternal=-1,this.maximumBoundaryInternal=-1,this.boundryChangedEventThrottler=new e.Throttler.Throttler(0),this.window=null}setWindow(e){this.window=e,this.boundaryChanged()}setInitialUserFriendlyBoundaries(){this.minimumBoundaryInternal=0,this.maximumBoundaryInternal=1}computePosition(e){return(e-this.minimumBoundary())/this.boundarySpan()*(this.workingArea||0)}formatValue(e,t){return i.TimeUtilities.secondsToString(e,Boolean(t))}minimumBoundary(){return this.window?this.window.minimum:this.minimumBoundaryInternal}zeroTime(){return this.minimumBoundaryInternal}maximumBoundary(){return this.window?this.window.maximum:this.maximumBoundaryInternal}boundary(){return new Mt(this.minimumBoundary(),this.maximumBoundary())}boundarySpan(){return this.maximumBoundary()-this.minimumBoundary()}reset(){this.minimumBoundaryInternal=-1,this.maximumBoundaryInternal=-1,this.boundaryChanged()}value(){return 0}setDisplayWidth(e){this.workingArea=e}computeBarGraphPercentages(e){let t,i,r;return t=-1!==e.startTime?(e.startTime-this.minimumBoundary())/this.boundarySpan()*100:0,i=-1!==e.responseReceivedTime?(e.responseReceivedTime-this.minimumBoundary())/this.boundarySpan()*100:this.startAtZero?t:100,r=-1!==e.endTime?(e.endTime-this.minimumBoundary())/this.boundarySpan()*100:this.startAtZero?i:100,this.startAtZero&&(r-=t,i-=t,t=0),{start:t,middle:i,end:r}}computePercentageFromEventTime(e){return-1===e||this.startAtZero?0:(e-this.minimumBoundary())/this.boundarySpan()*100}percentageToTime(e){return e*this.boundarySpan()/100+this.minimumBoundary()}boundaryChanged(){this.boundryChangedEventThrottler.schedule((async()=>{this.dispatchEventToListeners(At.BoundariesChanged)}))}updateBoundariesForEventTime(e){-1===e||this.startAtZero||(void 0===this.maximumBoundaryInternal||e>this.maximumBoundaryInternal)&&(this.maximumBoundaryInternal=e,this.boundaryChanged())}computeBarGraphLabels(e){let t="";-1!==e.responseReceivedTime&&-1!==e.endTime&&(t=i.TimeUtilities.secondsToString(e.endTime-e.responseReceivedTime));const r=e.latency>0,o=r?i.TimeUtilities.secondsToString(e.latency):t;if(e.timing)return{left:o,right:t,tooltip:void 0};let s;if(r&&t){const r=i.TimeUtilities.secondsToString(e.duration);s=Et(Ht.sLatencySDownloadSTotal,{PH1:o,PH2:t,PH3:r})}else r?s=Et(Ht.sLatency,{PH1:o}):t&&(s=Et(Ht.sDownload,{PH1:t}));return e.fetchedViaServiceWorker?s=Et(Ht.sFromServiceworker,{PH1:String(s)}):e.cached()&&(s=Et(Ht.sFromCache,{PH1:String(s)})),{left:o,right:t,tooltip:s}}updateBoundaries(e){const t=this.lowerBound(e),i=this.upperBound(e);let r=!1;(-1!==t||this.startAtZero)&&(r=this.extendBoundariesToIncludeTimestamp(this.startAtZero?0:t)),-1!==i&&(r=this.extendBoundariesToIncludeTimestamp(i)||r),r&&this.boundaryChanged()}extendBoundariesToIncludeTimestamp(e){const t=this.minimumBoundaryInternal,i=this.maximumBoundaryInternal,r=Nt;return-1===this.minimumBoundaryInternal||-1===this.maximumBoundaryInternal?(this.minimumBoundaryInternal=e,this.maximumBoundaryInternal=e+r):(this.minimumBoundaryInternal=Math.min(e,this.minimumBoundaryInternal),this.maximumBoundaryInternal=Math.max(e,this.minimumBoundaryInternal+r,this.maximumBoundaryInternal)),t!==this.minimumBoundaryInternal||i!==this.maximumBoundaryInternal}lowerBound(e){return 0}upperBound(e){return 0}}const Nt=.1;var At;!function(e){e.BoundariesChanged="BoundariesChanged"}(At||(At={}));class Bt extends Ut{constructor(){super(!1)}formatValue(e,t){return i.TimeUtilities.secondsToString(e-this.zeroTime(),Boolean(t))}lowerBound(e){return e.issueTime()}upperBound(e){return e.endTime}}class Vt extends Ut{constructor(){super(!0)}formatValue(e,t){return i.TimeUtilities.secondsToString(e,Boolean(t))}upperBound(e){return e.duration}}var Wt=Object.freeze({__proto__:null,NetworkTimeBoundary:Mt,NetworkTimeCalculator:Ut,_minimumSpread:Nt,get Events(){return At},NetworkTransferTimeCalculator:Bt,NetworkTransferDurationCalculator:Vt});const Ot=new CSSStyleSheet;Ot.replaceSync('.network-timing-table{width:380px;border-spacing:0;padding-left:10px;padding-right:10px;line-height:initial;table-layout:fixed}.network-timing-start{border-top:5px solid transparent}.network-timing-start th span.network-timing-hidden-header{height:1px;width:1px;position:absolute;overflow:hidden}.network-timing-table-header td,\n.network-timing-footer td{border-top:10px solid transparent}.network-timing-table-header td{color:var(--color-text-secondary)}.network-timing-table td{padding:4px 0}.network-timing-table-header td:last-child{text-align:right}.network-timing-footer td:last-child{font-weight:bold;text-align:right}table.network-timing-table > tr:not(.network-timing-table-header):not(.network-timing-footer) > td:first-child{padding-left:12px}.network-timing-table col.labels{width:156px}.network-timing-table col.duration{width:80px}.network-timing-table td.caution{font-weight:bold;color:var(--issue-color-yellow);padding:2px 0}.network-timing-table hr.break{border:0;height:1px;background-image:linear-gradient(to right,var(--color-background-elevation-0),var(--color-text-secondary),var(--color-background-elevation-0))}.network-timing-row{position:relative;height:15px}.network-timing-bar{position:absolute;min-width:1px;top:0;bottom:0}.network-timing-bar-title{color:var(--color-text-primary);white-space:nowrap;text-align:right}.network-timing-bar.queueing,\n.network-timing-bar.total{border:1px solid var(--color-text-secondary)}.network-timing-bar.blocking,\n.-theme-preserve{background-color:var(--override-network-overview-blocking)}.network-timing-bar.proxy,\n.-theme-preserve{background-color:var(--override-network-overview-proxy)}.network-timing-bar.dns,\n.-theme-preserve{background-color:var(--override-network-overview-dns)}.network-timing-bar.connecting,\n.network-timing-bar.serviceworker,\n.network-timing-bar.serviceworker-preparation,\n.-theme-preserve{background-color:var(--override-network-overview-service-worker)}.network-timing-bar.ssl,\n.-theme-preserve{background-color:var(--override-network-overview-ssl)}.network-timing-bar.serviceworker-respondwith,\n.-theme-preserve{background-color:var(--override-network-overview-service-worker-respond-with)}.network-fetch-timing-bar-clickable::before{user-select:none;-webkit-mask-image:var(--image-file-treeoutlineTriangles);-webkit-mask-position:0 0;-webkit-mask-size:32px 24px;float:left;width:8px;height:12px;margin-right:2px;content:"";position:relative;top:3px;background-color:var(--color-text-secondary)}.network-fetch-timing-bar-clickable{position:relative;left:-12px}.network-fetch-timing-bar-clickable:focus-visible{background-color:var(--color-background-elevation-1)}.network-fetch-timing-bar-clickable[aria-checked="true"]::before{-webkit-mask-position:-16px 0}.network-fetch-timing-bar-details-collapsed{display:none}.network-fetch-timing-bar-details-expanded{display:block}.network-fetch-timing-bar-details{padding-left:11px;width:fit-content}.network-fetch-details-treeitem{width:max-content}.network-timing-bar.sending,\n.-theme-preserve{background-color:var(--override-network-overview-sending)}.network-timing-bar.waiting,\n.-theme-preserve{background-color:var(--override-network-overview-waiting)}.network-timing-bar.receiving,\n.network-timing-bar.receiving-push,\n.-theme-preserve{background-color:var(--override-network-overview-receiving)}.network-timing-bar.push,\n.-theme-preserve{background-color:var(--override-network-overview-push)}.server-timing-row:nth-child(even){background:var(--color-background-elevation-0)}.network-timing-bar.server-timing,\n.-theme-preserve{background-color:var(--color-background-elevation-2)}.network-timing-table td.network-timing-metric{white-space:nowrap;max-width:150px;overflow-x:hidden;text-overflow:ellipsis}.network-timing-bar.proxy,\n.network-timing-bar.dns,\n.network-timing-bar.ssl,\n.network-timing-bar.connecting,\n.network-timing-bar.blocking{height:10px;margin:auto}@media (forced-colors: active){.network-timing-bar.blocking,\n  .network-timing-bar.proxy,\n  .network-timing-bar.dns,\n  .network-timing-bar.connecting,\n  .network-timing-bar.serviceworker,\n  .network-timing-bar.serviceworker-preparation,\n  .network-timing-bar.ssl,\n  .network-timing-bar.sending,\n  .network-timing-bar.waiting,\n  .network-timing-bar.receiving,\n  .network-timing-bar.receiving-push,\n  .network-timing-bar.push,\n  .network-timing-bar.server-timing,\n  .-theme-preserve{forced-color-adjust:none}.network-timing-table-header td,\n  .network-timing-footer td{forced-color-adjust:none;color:ButtonText}}\n/*# sourceURL=networkTimingTable.css */\n');const Dt={receivingPush:"Receiving `Push`",queueing:"Queueing",stalled:"Stalled",initialConnection:"Initial connection",dnsLookup:"DNS Lookup",proxyNegotiation:"Proxy negotiation",readingPush:"Reading `Push`",contentDownload:"Content Download",requestSent:"Request sent",requestToServiceworker:"Request to `ServiceWorker`",startup:"Startup",respondwith:"respondWith",ssl:"SSL",total:"Total",waitingTtfb:"Waiting for server response",label:"Label",waterfall:"Waterfall",duration:"Duration",queuedAtS:"Queued at {PH1}",startedAtS:"Started at {PH1}",serverPush:"Server Push",resourceScheduling:"Resource Scheduling",connectionStart:"Connection Start",requestresponse:"Request/Response",cautionRequestIsNotFinishedYet:"CAUTION: request is not finished yet!",explanation:"Explanation",serverTiming:"Server Timing",time:"TIME",theServerTimingApi:"the Server Timing API",duringDevelopmentYouCanUseSToAdd:"During development, you can use {PH1} to add insights into the server-side timing of this request.",durationC:"DURATION",originalRequest:"Original Request",responseReceived:"Response Received",unknown:"Unknown",sourceOfResponseS:"Source of response: {PH1}",cacheStorageCacheNameS:"Cache storage cache name: {PH1}",cacheStorageCacheNameUnknown:"Cache storage cache name: Unknown",retrievalTimeS:"Retrieval Time: {PH1}",serviceworkerCacheStorage:"`ServiceWorker` cache storage",fromHttpCache:"From HTTP cache",networkFetch:"Network fetch",fallbackCode:"Fallback code"},Gt=i.i18n.registerUIStrings("panels/network/RequestTimingView.ts",Dt),zt=i.i18n.getLocalizedString.bind(void 0,Gt);class _t extends o.Widget.VBox{request;calculator;lastMinimumBoundary;tableElement;constructor(e,t){super(),this.element.classList.add("resource-timing-view"),this.request=e,this.calculator=t,this.lastMinimumBoundary=-1}static timeRangeTitle(e){switch(e){case jt.Push:return zt(Dt.receivingPush);case jt.Queueing:return zt(Dt.queueing);case jt.Blocking:return zt(Dt.stalled);case jt.Connecting:return zt(Dt.initialConnection);case jt.DNS:return zt(Dt.dnsLookup);case jt.Proxy:return zt(Dt.proxyNegotiation);case jt.ReceivingPush:return zt(Dt.readingPush);case jt.Receiving:return zt(Dt.contentDownload);case jt.Sending:return zt(Dt.requestSent);case jt.ServiceWorker:return zt(Dt.requestToServiceworker);case jt.ServiceWorkerPreparation:return zt(Dt.startup);case jt.ServiceWorkerRespondWith:return zt(Dt.respondwith);case jt.SSL:return zt(Dt.ssl);case jt.Total:return zt(Dt.total);case jt.Waiting:return zt(Dt.waitingTtfb);default:return e}}static calculateRequestTimeRanges(e,t){const i=[];function r(e,t,r){t<Number.MAX_VALUE&&t<=r&&i.push({name:e,start:t,end:r})}function o(e){for(let t=0;t<e.length;++t)if(e[t]>0)return e[t]}function s(e,t,i){t>=0&&i>=0&&r(e,l+t/1e3,l+i/1e3)}const n=e.timing;if(!n){const t=-1!==e.issueTime()?e.issueTime():-1!==e.startTime?e.startTime:0,o=-1!==e.issueTime()&&-1!==e.startTime&&e.issueTime()!==e.startTime,s=-1===e.responseReceivedTime?o?e.startTime:Number.MAX_VALUE:e.responseReceivedTime,n=-1===e.endTime?Number.MAX_VALUE:e.endTime;r(jt.Total,t,n),r(jt.Blocking,t,s);return r(-1===e.responseReceivedTime?jt.Connecting:jt.Receiving,s,n),i}const a=e.issueTime(),l=n.requestTime,d=o([e.endTime,e.responseReceivedTime])||l;if(r(jt.Total,a<l?a:l,d),n.pushStart){const e=n.pushEnd||d;e>t&&r(jt.Push,Math.max(n.pushStart,t),e)}a<l&&r(jt.Queueing,a,l);const c=1e3*(e.responseReceivedTime-l);if(e.fetchedViaServiceWorker)s(jt.Blocking,0,n.workerStart),s(jt.ServiceWorkerPreparation,n.workerStart,n.workerReady),s(jt.ServiceWorkerRespondWith,n.workerFetchStart,n.workerRespondWithSettled),s(jt.ServiceWorker,n.workerReady,n.sendEnd),s(jt.Waiting,n.sendEnd,c);else if(!n.pushStart){const e=o([n.dnsStart,n.connectStart,n.sendStart,c])||0;s(jt.Blocking,0,e),s(jt.Proxy,n.proxyStart,n.proxyEnd),s(jt.DNS,n.dnsStart,n.dnsEnd),s(jt.Connecting,n.connectStart,n.connectEnd),s(jt.SSL,n.sslStart,n.sslEnd),s(jt.Sending,n.sendStart,n.sendEnd),s(jt.Waiting,Math.max(n.sendEnd,n.connectEnd,n.dnsEnd,n.proxyEnd,e),c)}return-1!==e.endTime&&r(n.pushStart?jt.ReceivingPush:jt.Receiving,e.responseReceivedTime,d),i}static createTimingTable(t,r){const s=document.createElement("table");s.classList.add("network-timing-table");const n=s.createChild("colgroup");n.createChild("col","labels"),n.createChild("col","bars"),n.createChild("col","duration");const a=_t.calculateRequestTimeRanges(t,r.minimumBoundary()),l=a.map((e=>e.start)).reduce(((e,t)=>Math.min(e,t))),d=a.map((e=>e.end)).reduce(((e,t)=>Math.max(e,t))),c=100/(d-l);let h,u,p,m,g=0;const w=s.createChild("thead","network-timing-start"),v=w.createChild("tr"),b=v.createChild("th");b.createChild("span","network-timing-hidden-header").textContent=zt(Dt.label),b.scope="col";const k=v.createChild("th");k.createChild("span","network-timing-hidden-header").textContent=zt(Dt.waterfall),k.scope="col";const f=v.createChild("th");f.createChild("span","network-timing-hidden-header").textContent=zt(Dt.duration),f.scope="col";const C=w.createChild("tr").createChild("td"),S=w.createChild("tr").createChild("td");let T;C.colSpan=S.colSpan=3,o.UIUtils.createTextChild(C,zt(Dt.queuedAtS,{PH1:r.formatValue(t.issueTime(),2)})),o.UIUtils.createTextChild(S,zt(Dt.startedAtS,{PH1:r.formatValue(t.startTime,2)}));for(let e=0;e<a.length;++e){const t=a[e],n=t.name;if(n===jt.Total){g=t.end-t.start;continue}n===jt.Push?H(zt(Dt.serverPush)):n===jt.Queueing?m||(m=H(zt(Dt.resourceScheduling))):$t.has(n)?h||(h=H(zt(Dt.connectionStart))):Kt.has(n)?u||(u=H("Service Worker")):p||(p=H(zt(Dt.requestresponse)));const w=c*(t.start-l);T=c*(d-t.end);const v=t.end-t.start,b=s.createChild("tr"),k=b.createChild("td");o.UIUtils.createTextChild(k,_t.timeRangeTitle(n));const f=b.createChild("td").createChild("div","network-timing-row"),C=f.createChild("span","network-timing-bar "+n);C.style.left=w+"%",C.style.right=T+"%",C.textContent="​",o.ARIAUtils.setAccessibleName(f,zt(Dt.startedAtS,{PH1:r.formatValue(t.start,2)}));b.createChild("td").createChild("div","network-timing-bar-title").textContent=i.TimeUtilities.secondsToString(v,!0),"serviceworker-respondwith"===t.name&&(k.classList.add("network-fetch-timing-bar-clickable"),s.createChild("tr","network-fetch-timing-bar-details"),k.setAttribute("tabindex","0"),k.setAttribute("role","switch"),o.ARIAUtils.setChecked(k,!1))}if(!t.finished&&!t.preserved){const e=s.createChild("tr").createChild("td","caution");e.colSpan=3,o.UIUtils.createTextChild(e,zt(Dt.cautionRequestIsNotFinishedYet))}const y=s.createChild("tr","network-timing-footer"),R=y.createChild("td");R.colSpan=1,R.appendChild(o.XLink.XLink.create("https://developer.chrome.com/docs/devtools/network/reference/#timing-explanation",zt(Dt.explanation))),y.createChild("td"),o.UIUtils.createTextChild(y.createChild("td"),i.TimeUtilities.secondsToString(g,!0));const I=t.serverTimings,x=void 0===T?100:T,q=s.createChild("tr","network-timing-table-header").createChild("td");q.colSpan=3,q.createChild("hr","break");const F=s.createChild("tr","network-timing-table-header");if(o.UIUtils.createTextChild(F.createChild("td"),zt(Dt.serverTiming)),F.createChild("td"),o.UIUtils.createTextChild(F.createChild("td"),zt(Dt.time)),!I){const e=s.createChild("tr").createChild("td");e.colSpan=3;const t=o.XLink.XLink.create("https://web.dev/custom-metrics/#server-timing-api",zt(Dt.theServerTimingApi));return e.appendChild(i.i18n.getFormatLocalizedString(Gt,Dt.duringDevelopmentYouCanUseSToAdd,{PH1:t})),s}return I.filter((e=>"total"!==e.metric.toLowerCase())).forEach((e=>L(e,x))),I.filter((e=>"total"===e.metric.toLowerCase())).forEach((e=>L(e,x))),s;function L(t,r){const n=new e.Color.Generator({min:0,max:360,count:36},{min:50,max:80,count:void 0},80),a="total"===t.metric.toLowerCase(),h=s.createChild("tr",a?"network-timing-footer":"server-timing-row"),u=h.createChild("td","network-timing-metric"),p=t.description||t.metric;o.UIUtils.createTextChild(u,p),o.Tooltip.Tooltip.install(u,p);const m=h.createChild("td").createChild("div","network-timing-row");if(null===t.value)return;const g=c*(d-l-t.value/1e3);if(g>=0){const e=m.createChild("span","network-timing-bar server-timing");e.style.left=g+"%",e.style.right=r+"%",e.textContent="​",a||(e.style.backgroundColor=n.colorForID(t.metric))}h.createChild("td").createChild("div","network-timing-bar-title").textContent=i.TimeUtilities.millisToString(t.value,!0)}function H(e){const t=s.createChild("tr","network-timing-table-header"),i=t.createChild("td");return o.UIUtils.createTextChild(i,e),o.ARIAUtils.markAsHeading(i,2),o.UIUtils.createTextChild(t.createChild("td"),""),o.UIUtils.createTextChild(t.createChild("td"),zt(Dt.durationC)),t}}constructFetchDetailsView(){if(!this.tableElement)return;const e=this.tableElement.ownerDocument,t=e.querySelector(".network-fetch-timing-bar-details");if(!t)return;t.classList.add("network-fetch-timing-bar-details-collapsed"),self.onInvokeElement(this.tableElement,this.onToggleFetchDetails.bind(this,t));const i=new o.TreeOutline.TreeOutlineInShadow;t.appendChild(i.element);const r=h.NetworkLog.NetworkLog.instance().originalRequestForURL(this.request.url());if(r){const e=n.RemoteObject.RemoteObject.fromLocalObject(r),t=new y.ObjectPropertiesSection.RootElement(e);t.title=zt(Dt.originalRequest),i.appendChild(t)}const s=h.NetworkLog.NetworkLog.instance().originalResponseForURL(this.request.url());if(s){const e=n.RemoteObject.RemoteObject.fromLocalObject(s),t=new y.ObjectPropertiesSection.RootElement(e);t.title=zt(Dt.responseReceived),i.appendChild(t)}const a=e.createElement("div");a.classList.add("network-fetch-details-treeitem");let l=zt(Dt.unknown);const d=this.request.serviceWorkerResponseSource();d&&(l=this.getLocalizedResponseSourceForCode(d)),a.textContent=zt(Dt.sourceOfResponseS,{PH1:l});const c=new o.TreeOutline.TreeElement(a);i.appendChild(c);const u=e.createElement("div");u.classList.add("network-fetch-details-treeitem");const p=this.request.getResponseCacheStorageCacheName();u.textContent=p?zt(Dt.cacheStorageCacheNameS,{PH1:p}):zt(Dt.cacheStorageCacheNameUnknown);const m=new o.TreeOutline.TreeElement(u);i.appendChild(m);const g=this.request.getResponseRetrievalTime();if(g){const t=e.createElement("div");t.classList.add("network-fetch-details-treeitem"),t.textContent=zt(Dt.retrievalTimeS,{PH1:g.toString()});const r=new o.TreeOutline.TreeElement(t);i.appendChild(r)}}getLocalizedResponseSourceForCode(e){switch(e){case"cache-storage":return zt(Dt.serviceworkerCacheStorage);case"http-cache":return zt(Dt.fromHttpCache);case"network":return zt(Dt.networkFetch);default:return zt(Dt.fallbackCode)}}onToggleFetchDetails(e,i){if(!i.target)return;const r=i.target;if(r.classList.contains("network-fetch-timing-bar-clickable")){e.classList.contains("network-fetch-timing-bar-details-collapsed")&&t.userMetrics.actionTaken(t.UserMetrics.Action.NetworkPanelServiceWorkerRespondWith);const i="true"===r.getAttribute("aria-checked");r.setAttribute("aria-checked",String(!i)),e.classList.toggle("network-fetch-timing-bar-details-collapsed"),e.classList.toggle("network-fetch-timing-bar-details-expanded")}}wasShown(){this.request.addEventListener(n.NetworkRequest.Events.TimingChanged,this.refresh,this),this.request.addEventListener(n.NetworkRequest.Events.FinishedLoading,this.refresh,this),this.calculator.addEventListener(At.BoundariesChanged,this.boundaryChanged,this),this.registerCSSFiles([Ot]),this.refresh()}willHide(){this.request.removeEventListener(n.NetworkRequest.Events.TimingChanged,this.refresh,this),this.request.removeEventListener(n.NetworkRequest.Events.FinishedLoading,this.refresh,this),this.calculator.removeEventListener(At.BoundariesChanged,this.boundaryChanged,this)}refresh(){this.tableElement&&this.tableElement.remove(),this.tableElement=_t.createTimingTable(this.request,this.calculator),this.tableElement.classList.add("resource-timing-table"),this.element.appendChild(this.tableElement),this.request.fetchedViaServiceWorker&&this.constructFetchDetailsView()}boundaryChanged(){const e=this.calculator.minimumBoundary();e!==this.lastMinimumBoundary&&(this.lastMinimumBoundary=e,this.refresh())}}var jt;!function(e){e.Push="push",e.Queueing="queueing",e.Blocking="blocking",e.Connecting="connecting",e.DNS="dns",e.Proxy="proxy",e.Receiving="receiving",e.ReceivingPush="receiving-push",e.Sending="sending",e.ServiceWorker="serviceworker",e.ServiceWorkerPreparation="serviceworker-preparation",e.ServiceWorkerRespondWith="serviceworker-respondwith",e.SSL="ssl",e.Total="total",e.Waiting="waiting"}(jt||(jt={}));const Kt=new Set([jt.ServiceWorker,jt.ServiceWorkerPreparation,jt.ServiceWorkerRespondWith]),$t=new Set([jt.Queueing,jt.Blocking,jt.Connecting,jt.DNS,jt.Proxy,jt.SSL]);var Xt=Object.freeze({__proto__:null,RequestTimingView:_t,get RequestTimeRangeNames(){return jt},ServiceWorkerRangeNames:Kt,ConnectionSetupRangeNames:$t});const Jt=new CSSStyleSheet;Jt.replaceSync('.websocket-frame-view{--override-icon-color-when-row-selected:#fff;--override-send-row-background-color:rgb(226 247 218);--override-error-row-background-color:rgb(255 237 237);user-select:text}.-theme-with-dark-background .websocket-frame-view,\n:host-context(.-theme-with-dark-background) .websocket-frame-view{--override-icon-color-when-row-selected:#000;--override-send-row-background-color:rgb(16 37 8);--override-error-row-background-color:rgb(18 0 0)}.websocket-frame-view .data-grid{flex:auto;border:none}.websocket-frame-view .data-grid .data{background-image:none}.websocket-frame-view-td{border-bottom:1px solid var(--color-details-hairline)}.websocket-frame-view .data-grid td,\n.websocket-frame-view .data-grid th{border-left-color:var(--color-details-hairline)}.websocket-frame-view-row-send td:first-child::before{content:"\\2B06";color:var(--color-green);padding-right:4px}.websocket-frame-view-row-receive td:first-child::before{content:"\\2B07";color:var(--color-red);padding-right:4px}.data-grid:focus .websocket-frame-view-row-send.selected td:first-child::before,\n.data-grid:focus .websocket-frame-view-row-receive.selected td:first-child::before{color:var(--override-icon-color-when-row-selected)}.websocket-frame-view-row-send{background-color:var(--override-send-row-background-color)}.websocket-frame-view-row-error{background-color:var(--override-error-row-background-color);color:var(--color-accent-red)}.websocket-frame-view .toolbar{border-bottom:var(--legacy-divider-border)}\n/*# sourceURL=webSocketFrameView.css */\n');const Yt={data:"Data",length:"Length",time:"Time",webSocketFrame:"Web Socket Frame",clearAll:"Clear All",filter:"Filter",selectMessageToBrowseItsContent:"Select message to browse its content.",copyMessageD:"Copy message...",copyMessage:"Copy message",clearAllL:"Clear all",sOpcodeSMask:"{PH1} (Opcode {PH2}, mask)",sOpcodeS:"{PH1} (Opcode {PH2})",continuationFrame:"Continuation Frame",textMessage:"Text Message",binaryMessage:"Binary Message",connectionCloseMessage:"Connection Close Message",pingMessage:"Ping Message",pongMessage:"Pong Message",all:"All",send:"Send",receive:"Receive",na:"N/A",enterRegex:"Enter regex, for example: (web)?socket"},Qt=i.i18n.registerUIStrings("panels/network/ResourceWebSocketFrameView.ts",Yt),Zt=i.i18n.getLocalizedString.bind(void 0,Qt),ei=i.i18n.getLazilyComputedLocalizedString.bind(void 0,Qt);class ti extends o.Widget.VBox{request;splitWidget;dataGrid;timeComparator;mainToolbar;clearAllButton;filterTypeCombobox;filterType;filterTextInput;filterRegex;frameEmptyWidget;selectedNode;currentSelectedNode;messageFilterSetting=e.Settings.Settings.instance().createSetting("networkWebSocketMessageFilter","");constructor(e){super(),this.element.classList.add("websocket-frame-view"),this.request=e,this.splitWidget=new o.SplitWidget.SplitWidget(!1,!0,"resourceWebSocketFrameSplitViewState"),this.splitWidget.show(this.element);const i=[{id:"data",title:Zt(Yt.data),sortable:!1,weight:88},{id:"length",title:Zt(Yt.length),sortable:!1,align:a.DataGrid.Align.Right,weight:5},{id:"time",title:Zt(Yt.time),sortable:!0,weight:7}];this.dataGrid=new a.SortableDataGrid.SortableDataGrid({displayName:Zt(Yt.webSocketFrame),columns:i,editCallback:void 0,deleteCallback:void 0,refreshCallback:void 0}),this.dataGrid.setRowContextMenuCallback(function(e,i){const r=i,o=r.binaryView();o?o.addCopyToContextMenu(e,Zt(Yt.copyMessageD)):e.clipboardSection().appendItem(Zt(Yt.copyMessage),t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText.bind(t.InspectorFrontendHost.InspectorFrontendHostInstance,r.data.data));e.footerSection().appendItem(Zt(Yt.clearAllL),this.clearFrames.bind(this))}.bind(this)),this.dataGrid.setStickToBottom(!0),this.dataGrid.setCellClass("websocket-frame-view-td"),this.timeComparator=ni,this.dataGrid.sortNodes(this.timeComparator,!1),this.dataGrid.markColumnAsSortedBy("time",a.DataGrid.Order.Ascending),this.dataGrid.addEventListener(a.DataGrid.Events.SortingChanged,this.sortItems,this),this.dataGrid.setName("ResourceWebSocketFrameView"),this.dataGrid.addEventListener(a.DataGrid.Events.SelectedNode,(e=>{this.onFrameSelected(e)}),this),this.dataGrid.addEventListener(a.DataGrid.Events.DeselectedNode,this.onFrameDeselected,this),this.mainToolbar=new o.Toolbar.Toolbar(""),this.clearAllButton=new o.Toolbar.ToolbarButton(Zt(Yt.clearAll),"largeicon-clear"),this.clearAllButton.addEventListener(o.Toolbar.ToolbarButton.Events.Click,this.clearFrames,this),this.mainToolbar.appendToolbarItem(this.clearAllButton),this.filterTypeCombobox=new o.Toolbar.ToolbarComboBox(this.updateFilterSetting.bind(this),Zt(Yt.filter));for(const e of oi){const t=this.filterTypeCombobox.createOption(e.label(),e.name);this.filterTypeCombobox.addOption(t)}this.mainToolbar.appendToolbarItem(this.filterTypeCombobox),this.filterType=null;const r=Zt(Yt.enterRegex);this.filterTextInput=new o.Toolbar.ToolbarInput(r,"",.4),this.filterTextInput.addEventListener(o.Toolbar.ToolbarInput.Event.TextChanged,this.updateFilterSetting,this);const s=this.messageFilterSetting.get();s&&this.filterTextInput.setValue(s),this.filterRegex=null,this.mainToolbar.appendToolbarItem(this.filterTextInput);const n=new o.Widget.VBox;n.element.appendChild(this.mainToolbar.element),this.dataGrid.asWidget().show(n.element),n.setMinimumSize(0,72),this.splitWidget.setMainWidget(n),this.frameEmptyWidget=new o.EmptyWidget.EmptyWidget(Zt(Yt.selectMessageToBrowseItsContent)),this.splitWidget.setSidebarWidget(this.frameEmptyWidget),this.selectedNode=null,s&&this.applyFilter(s)}static opCodeDescription(e,t){const i=ri[e]||(()=>"");return Zt(t?Yt.sOpcodeSMask:Yt.sOpcodeS,{PH1:i(),PH2:e})}wasShown(){this.refresh(),this.registerCSSFiles([Jt]),this.request.addEventListener(n.NetworkRequest.Events.WebsocketFrameAdded,this.frameAdded,this)}willHide(){this.request.removeEventListener(n.NetworkRequest.Events.WebsocketFrameAdded,this.frameAdded,this)}frameAdded(e){const t=e.data;this.frameFilter(t)&&this.dataGrid.insertChild(new si(this.request.url(),t))}frameFilter(e){return(!this.filterType||e.type===this.filterType)&&(!this.filterRegex||this.filterRegex.test(e.text))}clearFrames(){ai.set(this.request,this.request.frames().length),this.refresh()}updateFilterSetting(){const e=this.filterTextInput.value();this.messageFilterSetting.set(e),this.applyFilter(e)}applyFilter(e){const t=this.filterTypeCombobox.selectedOption().value;this.filterRegex=e?new RegExp(e,"i"):null,this.filterType="all"===t?null:t,this.refresh()}async onFrameSelected(t){this.currentSelectedNode=t.data;const i=this.currentSelectedNode.dataText(),o=this.currentSelectedNode.binaryView();if(o)return void this.splitWidget.setSidebarWidget(o);const s=await r.JSONView.JSONView.createView(i);s?this.splitWidget.setSidebarWidget(s):this.splitWidget.setSidebarWidget(new r.ResourceSourceFrame.ResourceSourceFrame(R.StaticContentProvider.StaticContentProvider.fromString(this.request.url(),e.ResourceType.resourceTypes.WebSocket,i),""))}onFrameDeselected(){this.currentSelectedNode=null,this.splitWidget.setSidebarWidget(this.frameEmptyWidget)}refresh(){this.dataGrid.rootNode().removeChildren();const e=this.request.url();let t=this.request.frames();const i=ai.get(this.request)||0;t=t.slice(i),t=t.filter(this.frameFilter.bind(this)),t.forEach((t=>this.dataGrid.insertChild(new si(e,t))))}sortItems(){this.dataGrid.sortNodes(this.timeComparator,!this.dataGrid.isSortOrderAscending())}}var ii;!function(e){e[e.ContinuationFrame=0]="ContinuationFrame",e[e.TextFrame=1]="TextFrame",e[e.BinaryFrame=2]="BinaryFrame",e[e.ConnectionCloseFrame=8]="ConnectionCloseFrame",e[e.PingFrame=9]="PingFrame",e[e.PongFrame=10]="PongFrame"}(ii||(ii={}));const ri=function(){const e=ii,t=[];return t[e.ContinuationFrame]=ei(Yt.continuationFrame),t[e.TextFrame]=ei(Yt.textMessage),t[e.BinaryFrame]=ei(Yt.binaryMessage),t[e.ConnectionCloseFrame]=ei(Yt.connectionCloseMessage),t[e.PingFrame]=ei(Yt.pingMessage),t[e.PongFrame]=ei(Yt.pongMessage),t}(),oi=[{name:"all",label:ei(Yt.all),title:void 0},{name:"send",label:ei(Yt.send),title:void 0},{name:"receive",label:ei(Yt.receive),title:void 0}];class si extends a.SortableDataGrid.SortableDataGridNode{url;frame;isTextFrame;dataTextInternal;binaryViewInternal;constructor(e,t){let i=String(t.text.length);const r=new Date(1e3*t.time),a=("0"+r.getHours()).substr(-2)+":"+("0"+r.getMinutes()).substr(-2)+":"+("0"+r.getSeconds()).substr(-2)+"."+("00"+r.getMilliseconds()).substr(-3),l=document.createElement("div");o.UIUtils.createTextChild(l,a),o.Tooltip.Tooltip.install(l,r.toLocaleString());let d=t.text,c=ti.opCodeDescription(t.opCode,t.mask);const h=t.opCode===ii.TextFrame;t.type===n.NetworkRequest.WebSocketFrameType.Error?(c=d,i=Zt(Yt.na)):h?c=d:t.opCode===ii.BinaryFrame?(i=s.NumberUtilities.bytesToString(s.StringUtilities.base64ToSize(t.text)),c=ri[t.opCode]()):d=c,super({data:c,length:i,time:l}),this.url=e,this.frame=t,this.isTextFrame=h,this.dataTextInternal=d,this.binaryViewInternal=null}createCells(e){e.classList.toggle("websocket-frame-view-row-error",this.frame.type===n.NetworkRequest.WebSocketFrameType.Error),e.classList.toggle("websocket-frame-view-row-send",this.frame.type===n.NetworkRequest.WebSocketFrameType.Send),e.classList.toggle("websocket-frame-view-row-receive",this.frame.type===n.NetworkRequest.WebSocketFrameType.Receive),super.createCells(e)}nodeSelfHeight(){return 21}dataText(){return this.dataTextInternal}opCode(){return this.frame.opCode}binaryView(){return this.isTextFrame||this.frame.type===n.NetworkRequest.WebSocketFrameType.Error?null:(this.binaryViewInternal||this.dataTextInternal.length>0&&(this.binaryViewInternal=new A(this.dataTextInternal,s.DevToolsPath.EmptyUrlString,e.ResourceType.resourceTypes.WebSocket)),this.binaryViewInternal)}}function ni(e,t){return e.frame.time-t.frame.time}const ai=new WeakMap;var li=Object.freeze({__proto__:null,ResourceWebSocketFrameView:ti,get OpCodes(){return ii},opCodeDescriptions:ri,_filterTypes:oi,ResourceWebSocketFrameNode:si,ResourceWebSocketFrameNodeTimeComparator:ni});const di={headers:"Headers",payload:"Payload",messages:"Messages",websocketMessages:"WebSocket messages",eventstream:"EventStream",preview:"Preview",responsePreview:"Response preview",signedexchangeError:"SignedExchange error",response:"Response",rawResponseData:"Raw response data",initiator:"Initiator",requestInitiatorCallStack:"Request initiator call stack",timing:"Timing",requestAndResponseTimeline:"Request and response timeline",trustTokens:"Trust Tokens",trustTokenOperationDetails:"Trust Token operation details",cookies:"Cookies",requestAndResponseCookies:"Request and response cookies"},ci=i.i18n.registerUIStrings("panels/network/NetworkItemView.ts",di),hi=i.i18n.getLocalizedString.bind(void 0,ci);class ui extends o.TabbedPane.TabbedPane{requestInternal;resourceViewTabSetting;headersView;headersViewComponent;payloadView;responseView;cookiesView;initialTab;constructor(t,i,r){if(super(),this.requestInternal=t,this.element.classList.add("network-item-view"),this.resourceViewTabSetting=e.Settings.Settings.instance().createSetting("resourceViewTab",p.UIRequestLocation.UIRequestTabs.Headers),this.headersView=new Me(t),this.headersViewComponent=new b.RequestHeadersView.RequestHeadersView(t),v.Runtime.experiments.isEnabled(v.Runtime.ExperimentName.HEADER_OVERRIDES)?this.appendTab(p.UIRequestLocation.UIRequestTabs.HeadersComponent,hi(di.headers),this.headersViewComponent,hi(di.headers)):this.appendTab(p.UIRequestLocation.UIRequestTabs.Headers,hi(di.headers),this.headersView,hi(di.headers)),this.payloadView=null,this.maybeAppendPayloadPanel(),this.addEventListener(o.TabbedPane.Events.TabSelected,this.tabSelected,this),t.resourceType()===e.ResourceType.resourceTypes.WebSocket){const e=new ti(t);this.appendTab(p.UIRequestLocation.UIRequestTabs.WsFrames,hi(di.messages),e,hi(di.websocketMessages))}else if(t.mimeType===n.NetworkRequest.MIME_TYPE.EVENTSTREAM)this.appendTab(p.UIRequestLocation.UIRequestTabs.EventSource,hi(di.eventstream),new Y(t));else{this.responseView=new at(t);const e=new Ft(t);this.appendTab(p.UIRequestLocation.UIRequestTabs.Preview,hi(di.preview),e,hi(di.responsePreview));const i=t.signedExchangeInfo();if(i&&i.errors&&i.errors.length){const e=o.Icon.Icon.create("smallicon-error");o.Tooltip.Tooltip.install(e,hi(di.signedexchangeError)),this.setTabIcon(p.UIRequestLocation.UIRequestTabs.Preview,e)}this.appendTab(p.UIRequestLocation.UIRequestTabs.Response,hi(di.response),this.responseView,hi(di.rawResponseData))}this.appendTab(p.UIRequestLocation.UIRequestTabs.Initiator,hi(di.initiator),new Ze(t),hi(di.requestInitiatorCallStack)),this.appendTab(p.UIRequestLocation.UIRequestTabs.Timing,hi(di.timing),new _t(t,i),hi(di.requestAndResponseTimeline)),t.trustTokenParams()&&this.appendTab(p.UIRequestLocation.UIRequestTabs.TrustTokens,hi(di.trustTokens),new b.RequestTrustTokensView.RequestTrustTokensView(t),hi(di.trustTokenOperationDetails)),this.cookiesView=null,this.initialTab=r||this.resourceViewTabSetting.get(),this.setAutoSelectFirstItemOnShow(!1)}wasShown(){super.wasShown(),this.requestInternal.addEventListener(n.NetworkRequest.Events.RequestHeadersChanged,this.requestHeadersChanged,this),this.requestInternal.addEventListener(n.NetworkRequest.Events.ResponseHeadersChanged,this.maybeAppendCookiesPanel,this),this.requestInternal.addEventListener(n.NetworkRequest.Events.TrustTokenResultAdded,this.maybeShowErrorIconInTrustTokenTabHeader,this),this.maybeAppendCookiesPanel(),this.maybeShowErrorIconInTrustTokenTabHeader(),this.initialTab&&(this.selectTabInternal(this.initialTab),this.initialTab=void 0)}willHide(){this.requestInternal.removeEventListener(n.NetworkRequest.Events.RequestHeadersChanged,this.requestHeadersChanged,this),this.requestInternal.removeEventListener(n.NetworkRequest.Events.ResponseHeadersChanged,this.maybeAppendCookiesPanel,this),this.requestInternal.removeEventListener(n.NetworkRequest.Events.TrustTokenResultAdded,this.maybeShowErrorIconInTrustTokenTabHeader,this)}async requestHeadersChanged(){this.maybeAppendCookiesPanel(),this.maybeAppendPayloadPanel()}maybeAppendCookiesPanel(){const e=this.requestInternal.hasRequestCookies()||this.requestInternal.responseCookies.length>0;console.assert(e||!this.cookiesView,"Cookies were introduced in headers and then removed!"),e&&!this.cookiesView&&(this.cookiesView=new ye(this.requestInternal),this.appendTab(p.UIRequestLocation.UIRequestTabs.Cookies,hi(di.cookies),this.cookiesView,hi(di.requestAndResponseCookies)))}async maybeAppendPayloadPanel(){this.hasTab("payload")||(this.requestInternal.queryParameters||await this.requestInternal.requestFormData())&&(this.payloadView=new ze(this.requestInternal),this.appendTab(p.UIRequestLocation.UIRequestTabs.Payload,hi(di.payload),this.payloadView,hi(di.payload),void 0,void 0,void 0,1))}maybeShowErrorIconInTrustTokenTabHeader(){const e=this.requestInternal.trustTokenOperationDoneEvent();e&&!b.RequestTrustTokensView.statusConsideredSuccess(e.status)&&this.setTabIcon(p.UIRequestLocation.UIRequestTabs.TrustTokens,o.Icon.Icon.create("smallicon-error"))}selectTabInternal(e){this.selectTab(e)||window.setTimeout((()=>{this.selectTab(e)||this.selectTab("headers")}),0)}tabSelected(e){e.data.isUserGesture&&this.resourceViewTabSetting.set(e.data.tabId)}request(){return this.requestInternal}async revealResponseBody(e){this.selectTabInternal(p.UIRequestLocation.UIRequestTabs.Response),this.responseView&&"number"==typeof e&&await this.responseView.revealLine(e)}revealHeader(e,t){v.Runtime.experiments.isEnabled(v.Runtime.ExperimentName.HEADER_OVERRIDES)?(this.selectTabInternal(p.UIRequestLocation.UIRequestTabs.HeadersComponent),this.headersViewComponent.revealHeader(e,t)):(this.selectTabInternal(p.UIRequestLocation.UIRequestTabs.Headers),this.headersView.revealHeader(e,t))}getHeadersView(){return this.headersView}getHeadersViewComponent(){return this.headersViewComponent}}var pi=Object.freeze({__proto__:null,NetworkItemView:ui});const mi=new CSSStyleSheet;mi.replaceSync('.network-log-grid.data-grid{border:none!important;flex:auto}.network-log-grid.data-grid.no-selection:focus-visible{border:none!important}#network-container{border:1px solid var(--color-details-hairline);overflow:hidden}#network-container.grid-focused.no-node-selected:focus-within{border:1px solid var(--legacy-accent-color)}.network-summary-bar{flex:0 0 27px;line-height:27px;padding-left:5px;background-color:var(--color-background-elevation-1);border-top:1px solid var(--color-details-hairline);white-space:nowrap;text-overflow:ellipsis;overflow:hidden;user-select:text}.panel.network .toolbar.network-summary-bar{border-bottom:0}.network-summary-bar span[is="dt-icon-label"]{margin-right:6px}.network-summary-bar > *{flex:none}.network-log-grid.data-grid tbody{background:transparent}.network-log-grid.data-grid td{height:41px;border-left:1px solid var(--color-details-hairline);vertical-align:middle}.network-log-grid.data-grid .corner{display:none}.network-log-grid.data-grid.small td{height:21px}.network-log-grid.data-grid th{border-bottom:none}.network-waterfall-header,\n.network-log-grid.data-grid thead th{border-bottom:1px solid var(--color-details-hairline);border-left:1px solid var(--color-details-hairline)}.network-waterfall-header,\n.network-log-grid.data-grid thead{height:31px;background-color:var(--color-background-elevation-1)}.network-waterfall-header.small,\n.network-log-grid.data-grid.small thead{height:27px}.network-log-grid.data-grid select{appearance:none;border:none;width:100%;color:inherit}.network-log-grid.data-grid .waterfall-column{padding:1px 0}.network-log-grid.data-grid .waterfall-column .sort-order-icon-container{right:15px;pointer-events:none}.network-log-grid.data-grid th.sortable:active{background-image:none!important}.network-cell-subtitle{font-weight:normal;color:var(--color-text-secondary)}.network-badge{margin-right:4px}.status-column .devtools-link{color:inherit}.initiator-column .devtools-link{color:inherit}.network-error-row,\n.network-error-row .network-cell-subtitle{color:var(--color-red)!important}.network-log-grid.data-grid tr.selected.network-error-row,\n.network-log-grid.data-grid tr.selected.network-error-row .network-cell-subtitle,\n.network-log-grid.data-grid tr.selected.network-error-row .network-dim-cell,\n.network-log-grid.data-grid:focus-within tr.selected.network-error-row .devtools-link,\n.network-log-grid.data-grid:focus-within tr.selected.network-error-row,\n.network-log-grid.data-grid:focus-within tr.selected.network-error-row .network-cell-subtitle,\n.network-log-grid.data-grid:focus-within tr.selected.network-error-row .network-dim-cell{color:var(--color-accent-red)}.network-log-grid.data-grid tr.selected,\n.network-log-grid.data-grid tr.selected .network-cell-subtitle,\n.network-log-grid.data-grid tr.selected .network-dim-cell{color:inherit}.network-log-grid.data-grid:focus tr.selected,\n.network-log-grid.data-grid:focus tr.selected .network-cell-subtitle,\n.network-log-grid.data-grid:focus tr.selected .network-dim-cell{color:var(--legacy-selection-fg-color)}.network-header-subtitle{color:var(--color-text-secondary)}.network-log-grid.data-grid.small .network-cell-subtitle,\n.network-log-grid.data-grid.small .network-header-subtitle{display:none}.network-log-grid.data-grid.small tr.selected .network-cell-subtitle-show-inline-when-selected{display:inline;margin-left:4px}.network-log-grid tr.highlighted-row{--override-highlight-fade-from:rgb(255 255 120/100%);--override-highlight-fade-to:rgb(255 255 120/0%);animation:network-row-highlight-fadeout 2s 0s}@keyframes network-row-highlight-fadeout{from{background-color:var(--override-highlight-fade-from)}to{background-color:var(--override-highlight-fade-to)}}.network-log-grid.data-grid .icon.image{position:relative}.network-log-grid.data-grid .icon{float:left;width:32px;height:32px;margin-top:1px;margin-right:3px}.network-log-grid.data-grid:focus-within .data-grid-data-grid-node.selected img.icon{filter:brightness(0) invert(1)}.network-log-grid.data-grid:focus-within .data-grid-data-grid-node.selected [is="ui-icon"].icon-mask{--network-grid-selected-color:#dadce0;--override-icon-mask-background-color:var(--network-grid-selected-color)}.network-log-grid.data-grid .network-error-row.data-grid-data-grid-node img.icon,\n.network-log-grid.data-grid .network-error-row.data-grid-data-grid-node.selected img.icon{filter:brightness(0) saturate(100%) invert(35%) sepia(76%) saturate(1413%) hue-rotate(338deg) brightness(92%) contrast(103%)}.network-log-grid.data-grid.small .icon{margin-top:0;width:18px;height:18px}.image-network-icon-preview{background:var(--color-image-preview-background);border:1px solid var(--color-details-hairline);bottom:0;left:0;margin:auto;overflow:hidden;right:0;top:0}.network-log-grid.data-grid .image-network-icon-preview{position:absolute;max-width:18px;max-height:21px;min-width:1px;min-height:1px}.network-log-grid.data-grid.small .image-network-icon-preview{left:2px;right:2px;max-width:10px;max-height:12px}.network-log-grid.data-grid .trailing-link-icon{padding-left:0.5ex}.network-dim-cell{color:var(--color-text-secondary)}.network-frame-divider{--override-frame-divider:#fccc49;width:2px;background-color:var(--override-frame-divider);z-index:10;visibility:hidden}.-theme-with-dark-background .network-frame-divider,\n:host-context(.-theme-with-dark-background) .network-frame-divider{--override-frame-divider:rgb(182 134 3)}#network-container:not(.brief-mode) .data-container{overflow:hidden}.network-log-grid.data-grid .resources-dividers{z-index:0}.network-log-grid.data-grid .resources-dividers-label-bar{background-color:transparent;border:none;height:30px;pointer-events:none}.network-log-grid.data-grid span.separator-in-cell{user-select:none;min-width:1ex;display:inline-block}.network-status-pane{color:var(--color-text-secondary);background-color:var(--color-background);z-index:500;display:flex;justify-content:center;align-items:center;text-align:center;padding:0 20px;overflow:auto}.network-status-pane > .recording-hint{font-size:14px;text-align:center;line-height:28px}.network-waterfall-header{position:absolute;border-left:0;width:100%;display:table;z-index:200}.network-waterfall-header:hover{background-color:var(--color-background-highlight)}.network-waterfall-header div{display:table-cell;line-height:14px;margin:auto 0;vertical-align:middle;text-align:left;font-weight:normal;padding:0 4px}.network-waterfall-header .sort-order-icon-container{position:absolute;top:1px;right:0;bottom:1px;display:flex;align-items:center}.network-waterfall-header .sort-order-icon{align-items:center;margin-right:4px;margin-bottom:-2px}.network-frame-group-icon{display:inline-block;margin:-8px -2px}.network-frame-group-badge{margin-right:4px}@media (forced-colors: active){.network-status-pane > .recording-hint{color:canvastext}.initiator-column .devtools-link{color:linktext}.network-log-grid.data-grid tbody tr.revealed.selected,\n  .network-log-grid.data-grid:focus-within tbody tr.revealed.selected,\n  .network-log-grid.data-grid:focus-within tr.selected .network-dim-cell,\n  .network-log-grid.data-grid tr.selected .network-dim-cell,\n  .network-log-grid.data-grid:focus-within tr.selected .initiator-column .devtools-link,\n  .network-log-grid.data-grid tr.selected .initiator-column .devtools-link,\n  .network-waterfall-header:hover *{color:HighlightText}.network-log-grid{--network-grid-default-color:canvas;--network-grid-stripe-color:canvas;--network-grid-hovered-color:Highlight;--network-grid-selected-color:ButtonText;--network-grid-focus-selected-color:Highlight}#network-container.no-node-selected:focus-within,\n  .network-status-pane{forced-color-adjust:none;border-color:Highlight;background-color:canvas!important}.network-waterfall-header:hover{forced-color-adjust:none;background-color:Highlight}.network-waterfall-header.small,\n  .network-log-grid.data-grid.small thead .network-waterfall-header,\n  .network-log-grid.data-grid thead{background-color:canvas}.network-waterfall-header:hover .sort-order-icon-container [is="ui-icon"].icon-mask{background-color:HighlightText}}\n/*# sourceURL=networkLogView.css */\n');class gi{parentView;activeGroups;constructor(e){this.parentView=e,this.activeGroups=new Map}groupNodeForRequest(e){const t=n.ResourceTreeModel.ResourceTreeModel.frameForRequest(e);if(!t||t.isTopFrame())return null;let i=this.activeGroups.get(t);return i||(i=new wi(this.parentView,t),this.activeGroups.set(t,i),i)}reset(){this.activeGroups.clear()}}class wi extends be{frame;constructor(e,t){super(e),this.frame=t}displayName(){return new e.ParsedURL.ParsedURL(this.frame.url).domain()||this.frame.name||"<iframe>"}renderCell(e,t){super.renderCell(e,t);if(0===this.dataGrid.indexOfVisibleColumn(t)){const i=this.displayName();e.appendChild(o.Icon.Icon.create("largeicon-navigator-frame","network-frame-group-icon")),o.UIUtils.createTextChild(e,i),o.Tooltip.Tooltip.install(e,i),this.setCellAccessibleName(e.textContent||"",e,t)}}}var vi=Object.freeze({__proto__:null,NetworkFrameGrouper:gi,FrameGroupNode:wi});const bi=new CSSStyleSheet;bi.replaceSync(".custom-headers-list{height:272px;width:250px}.custom-headers-wrapper{margin:10px}.header{padding:0 0 6px;font-size:18px;font-weight:normal;flex:none}.custom-headers-header{padding:2px}.custom-headers-list-item{padding-left:5px}.editor-container{padding:5px 0 0 5px}.add-button{width:150px;margin:auto;margin-top:5px}\n/*# sourceURL=networkManageCustomHeadersView.css */\n");const ki={manageHeaderColumns:"Manage Header Columns",noCustomHeaders:"No custom headers",addCustomHeader:"Add custom header…",headerName:"Header Name"},fi=i.i18n.registerUIStrings("panels/network/NetworkManageCustomHeadersView.ts",ki),Ci=i.i18n.getLocalizedString.bind(void 0,fi);class Si extends o.Widget.VBox{list;columnConfigs;addHeaderColumnCallback;changeHeaderColumnCallback;removeHeaderColumnCallback;editor;constructor(e,t,i,r){super(!0),this.contentElement.classList.add("custom-headers-wrapper"),this.contentElement.createChild("div","header").textContent=Ci(ki.manageHeaderColumns),this.list=new o.ListWidget.ListWidget(this),this.list.element.classList.add("custom-headers-list");const s=document.createElement("div");s.classList.add("custom-headers-list-list-empty"),s.textContent=Ci(ki.noCustomHeaders),this.list.setEmptyPlaceholder(s),this.list.show(this.contentElement),this.contentElement.appendChild(o.UIUtils.createTextButton(Ci(ki.addCustomHeader),this.addButtonClicked.bind(this),"add-button")),this.columnConfigs=new Map,e.forEach((e=>this.columnConfigs.set(e.title.toLowerCase(),e))),this.addHeaderColumnCallback=t,this.changeHeaderColumnCallback=i,this.removeHeaderColumnCallback=r,this.contentElement.tabIndex=0}wasShown(){this.headersUpdated(),this.list.registerCSSFiles([bi]),this.registerCSSFiles([bi])}headersUpdated(){this.list.clear(),this.columnConfigs.forEach((e=>this.list.appendItem({header:e.title},e.editable)))}addButtonClicked(){this.list.addNewItem(this.columnConfigs.size,{header:""})}renderItem(e,t){const i=document.createElement("div");i.classList.add("custom-headers-list-item");const r=i.createChild("div","custom-header-name");return r.textContent=e.header,o.Tooltip.Tooltip.install(r,e.header),i}removeItemRequested(e,t){this.removeHeaderColumnCallback(e.header),this.columnConfigs.delete(e.header.toLowerCase()),this.headersUpdated()}commitEdit(e,t,i){const r=t.control("header").value.trim();let o;o=i?this.addHeaderColumnCallback(r):this.changeHeaderColumnCallback(e.header,r),o&&!i&&this.columnConfigs.delete(e.header.toLowerCase()),o&&this.columnConfigs.set(r.toLowerCase(),{title:r,editable:!0}),this.headersUpdated()}beginEdit(e){const t=this.createEditor();return t.control("header").value=e.header,t}createEditor(){if(this.editor)return this.editor;const e=new o.ListWidget.Editor;this.editor=e;const t=e.contentElement();t.createChild("div","custom-headers-edit-row").createChild("div","custom-headers-header").textContent=Ci(ki.headerName);return t.createChild("div","custom-headers-edit-row").createChild("div","custom-headers-header").appendChild(e.createInput("header","text","x-custom-header",function(t,i,r){let o=!0;const s=e.control("header").value.trim().toLowerCase();this.columnConfigs.has(s)&&t.header!==s&&(o=!1);return{valid:o,errorMessage:void 0}}.bind(this))),e}}var Ti=Object.freeze({__proto__:null,NetworkManageCustomHeadersView:Si});const yi=new CSSStyleSheet;yi.replaceSync(".network-waterfall-v-scroll{position:absolute;top:0;right:0;bottom:0;overflow-x:hidden;margin-top:31px;z-index:200}.-theme-with-dark-background .network-waterfall-v-scroll{background:rgb(0 0 0/1%)}.network-waterfall-v-scroll.small{margin-top:27px}.network-waterfall-v-scroll-content{width:15px;pointer-events:none}\n/*# sourceURL=networkWaterfallColumn.css */\n");class Ri extends m.TimelineOverviewPane.TimelineOverviewBase{selectedFilmStripTime;numBands;updateScheduled;highlightedRequest;loadEvents;domContentLoadedEvents;nextBand;bandMap;requestsList;requestsSet;span;filmStripModel;lastBoundary;constructor(){super(),this.selectedFilmStripTime=-1,this.element.classList.add("network-overview"),this.numBands=1,this.updateScheduled=!1,this.highlightedRequest=null,n.TargetManager.TargetManager.instance().addModelListener(n.ResourceTreeModel.ResourceTreeModel,n.ResourceTreeModel.Events.Load,this.loadEventFired,this),n.TargetManager.TargetManager.instance().addModelListener(n.ResourceTreeModel.ResourceTreeModel,n.ResourceTreeModel.Events.DOMContentLoaded,this.domContentLoadedEventFired,this),this.reset()}setHighlightedRequest(e){this.highlightedRequest=e,this.scheduleUpdate()}setFilmStripModel(e){this.filmStripModel=e,this.scheduleUpdate()}selectFilmStripFrame(e){this.selectedFilmStripTime=e,this.scheduleUpdate()}clearFilmStripFrame(){this.selectedFilmStripTime=-1,this.scheduleUpdate()}loadEventFired(e){const t=e.data.loadTime;t&&this.loadEvents.push(1e3*t),this.scheduleUpdate()}domContentLoadedEventFired(e){const{data:t}=e;t&&this.domContentLoadedEvents.push(1e3*t),this.scheduleUpdate()}bandId(e){if(!e||"0"===e)return-1;if(this.bandMap.has(e))return this.bandMap.get(e);const t=this.nextBand++;return this.bandMap.set(e,t),t}updateRequest(e){this.requestsSet.has(e)||(this.requestsSet.add(e),this.requestsList.push(e)),this.scheduleUpdate()}wasShown(){this.onResize()}calculator(){return super.calculator()}onResize(){const e=this.element.offsetWidth,t=this.element.offsetHeight;this.calculator().setDisplayWidth(e),this.resetCanvas();const i=(t-qi-1)/xi-1|0;this.numBands=i>0?i:1,this.scheduleUpdate()}reset(){this.filmStripModel=null,this.span=1,this.lastBoundary=null,this.nextBand=0,this.bandMap=new Map,this.requestsList=[],this.requestsSet=new Set,this.loadEvents=[],this.domContentLoadedEvents=[],this.resetCanvas()}scheduleUpdate(){!this.updateScheduled&&this.isShowing()&&(this.updateScheduled=!0,this.element.window().requestAnimationFrame(this.update.bind(this)))}update(){this.updateScheduled=!1;const e=this.calculator(),t=new Mt(e.minimumBoundary(),e.maximumBoundary());if(!this.lastBoundary||!t.equals(this.lastBoundary)){const t=e.boundarySpan();for(;this.span<t;)this.span*=1.25;e.setBounds(e.minimumBoundary(),e.minimumBoundary()+this.span),this.lastBoundary=new Mt(e.minimumBoundary(),e.maximumBoundary())}const i=this.context(),r=new Map,o=qi;function s(t){const s=r.get(t);if(!s)return;const n=s.length;i.beginPath(),i.strokeStyle=H.ThemeSupport.instance().getComputedValue("--color-background-opacity-80"),i.lineWidth=Fi,i.fillStyle=H.ThemeSupport.instance().getComputedValue(Ii[t]);for(let t=0;t<n;){const r=s[t++]*xi+o,n=s[t++];let a=s[t++];a===Number.MAX_VALUE&&(a=e.maximumBoundary());const l=e.computePosition(n),d=e.computePosition(a)+1;i.fillRect(l,r,d-l,xi),i.strokeRect(l,r,d-l,xi)}}function n(e,t,i,o){let s=r.get(e);s||(s=[],r.set(e,s)),s.push(t,i,o)}const a=this.requestsList,l=a.length;for(let e=0;e<l;++e){const t=a[e],i=this.bandId(t.connectionId),r=-1===i?0:i%this.numBands+1,o=_t.calculateRequestTimeRanges(t,this.calculator().minimumBoundary());for(let e=0;e<o.length;++e){const t=o[e].name;-1===i&&t!==jt.Total||n(t,r,1e3*o[e].start,1e3*o[e].end)}}if(i.clearRect(0,0,this.width(),this.height()),i.save(),i.scale(window.devicePixelRatio,window.devicePixelRatio),i.lineWidth=2,s(jt.Total),s(jt.Blocking),s(jt.Connecting),s(jt.ServiceWorker),s(jt.ServiceWorkerPreparation),s(jt.ServiceWorkerRespondWith),s(jt.Push),s(jt.Proxy),s(jt.DNS),s(jt.SSL),s(jt.Sending),s(jt.Waiting),s(jt.Receiving),this.highlightedRequest){const t=5,r=2,s=this.highlightedRequest,n=this.bandId(s.connectionId),a=(-1===n?0:n%this.numBands+1)*xi+o,l=_t.calculateRequestTimeRanges(s,this.calculator().minimumBoundary());i.fillStyle=H.ThemeSupport.instance().getComputedValue("--legacy-selection-bg-color");const d=1e3*l[0].start,c=1e3*l[0].end;i.fillRect(e.computePosition(d)-r,a-t/2-r,e.computePosition(c)-e.computePosition(d)+1+2*r,t*r);for(let r=0;r<l.length;++r){const o=l[r].name;if(-1!==n||o===jt.Total){i.beginPath(),i.strokeStyle=H.ThemeSupport.instance().getComputedValue(Ii[o]),i.lineWidth=t;const s=1e3*l[r].start,n=1e3*l[r].end;i.moveTo(e.computePosition(s)-0,a),i.lineTo(e.computePosition(n)+1,a),i.stroke()}}}const d=this.element.offsetHeight;i.lineWidth=1,i.beginPath(),i.strokeStyle=$i.getDCLEventColor();for(let t=this.domContentLoadedEvents.length-1;t>=0;--t){const r=Math.round(e.computePosition(this.domContentLoadedEvents[t]))+.5;i.moveTo(r,0),i.lineTo(r,d)}i.stroke(),i.beginPath(),i.strokeStyle=$i.getLoadEventColor();for(let t=this.loadEvents.length-1;t>=0;--t){const r=Math.round(e.computePosition(this.loadEvents[t]))+.5;i.moveTo(r,0),i.lineTo(r,d)}if(i.stroke(),-1!==this.selectedFilmStripTime){i.lineWidth=2,i.beginPath(),i.strokeStyle=H.ThemeSupport.instance().getComputedValue("--network-frame-divider-color");const t=Math.round(e.computePosition(this.selectedFilmStripTime));i.moveTo(t,0),i.lineTo(t,d),i.stroke()}i.restore()}}const Ii={[jt.Total]:"--override-network-overview-total",[jt.Blocking]:"--override-network-overview-blocking",[jt.Connecting]:"--override-network-overview-connecting",[jt.ServiceWorker]:"--override-network-overview-service-worker",[jt.ServiceWorkerPreparation]:"--override-network-overview-service-worker",[jt.ServiceWorkerRespondWith]:"--override-network-overview-service-worker-respond-with",[jt.Push]:"--override-network-overview-push",[jt.Proxy]:"--override-network-overview-proxy",[jt.DNS]:"--override-network-overview-dns",[jt.SSL]:"--override-network-overview-ssl",[jt.Sending]:"--override-network-overview-sending",[jt.Waiting]:"--override-network-overview-waiting",[jt.Receiving]:"--override-network-overview-receiving",[jt.Queueing]:"--override-network-overview-queueing"},xi=3,qi=5,Fi=1;var Li=Object.freeze({__proto__:null,NetworkOverview:Ri,RequestTimeRangeNameToColor:Ii,_bandHeight:xi,_padding:qi});class Hi extends o.Widget.VBox{canvas;canvasPosition;leftPadding;fontSize;rightPadding;scrollTop;headerHeight;calculator;rawRowHeight;rowHeight;offsetWidth;offsetHeight;startTime;endTime;popoverHelper;nodes;hoveredNode;eventDividers;updateRequestID;styleForTimeRangeName;styleForWaitingResourceType;styleForDownloadingResourceType;wiskerStyle;hoverDetailsStyle;pathForStyle;textLayers;constructor(e){super(!1),this.canvas=this.contentElement.createChild("canvas"),this.canvas.tabIndex=-1,this.setDefaultFocusedElement(this.canvas),this.canvasPosition=this.canvas.getBoundingClientRect(),this.leftPadding=5,this.fontSize=10,this.rightPadding=0,this.scrollTop=0,this.headerHeight=0,this.calculator=e,this.rawRowHeight=0,this.rowHeight=0,this.offsetWidth=0,this.offsetHeight=0,this.startTime=this.calculator.minimumBoundary(),this.endTime=this.calculator.maximumBoundary(),this.popoverHelper=new o.PopoverHelper.PopoverHelper(this.element,this.getPopoverRequest.bind(this)),this.popoverHelper.setHasPadding(!0),this.popoverHelper.setTimeout(300,300),this.nodes=[],this.hoveredNode=null,this.eventDividers=new Map,this.element.addEventListener("mousemove",this.onMouseMove.bind(this),!0),this.element.addEventListener("mouseleave",(e=>this.setHoveredNode(null,!1)),!0),this.element.addEventListener("click",this.onClick.bind(this),!0),this.styleForTimeRangeName=Hi.buildRequestTimeRangeStyle();const t=Hi.buildResourceTypeStyle();this.styleForWaitingResourceType=t[0],this.styleForDownloadingResourceType=t[1];const i=H.ThemeSupport.instance().getComputedValue("--color-text-disabled");this.wiskerStyle={borderColor:i,lineWidth:1,fillStyle:void 0},this.hoverDetailsStyle={fillStyle:i,lineWidth:1,borderColor:i},this.pathForStyle=new Map,this.textLayers=[]}static buildRequestTimeRangeStyle(){const e=jt,t=new Map;return t.set(e.Connecting,{fillStyle:Ii[e.Connecting]}),t.set(e.SSL,{fillStyle:Ii[e.SSL]}),t.set(e.DNS,{fillStyle:Ii[e.DNS]}),t.set(e.Proxy,{fillStyle:Ii[e.Proxy]}),t.set(e.Blocking,{fillStyle:Ii[e.Blocking]}),t.set(e.Push,{fillStyle:Ii[e.Push]}),t.set(e.Queueing,{fillStyle:Ii[e.Queueing],lineWidth:2,borderColor:"lightgrey"}),t.set(e.Receiving,{fillStyle:Ii[e.Receiving],lineWidth:2,borderColor:"#03A9F4"}),t.set(e.Waiting,{fillStyle:Ii[e.Waiting]}),t.set(e.ReceivingPush,{fillStyle:Ii[e.ReceivingPush]}),t.set(e.ServiceWorker,{fillStyle:Ii[e.ServiceWorker]}),t.set(e.ServiceWorkerPreparation,{fillStyle:Ii[e.ServiceWorkerPreparation]}),t.set(e.ServiceWorkerRespondWith,{fillStyle:Ii[e.ServiceWorkerRespondWith]}),t}static buildResourceTypeStyle(){const t=new Map([["document","hsl(215, 100%, 80%)"],["font","hsl(8, 100%, 80%)"],["media","hsl(90, 50%, 80%)"],["image","hsl(90, 50%, 80%)"],["script","hsl(31, 100%, 80%)"],["stylesheet","hsl(272, 64%, 80%)"],["texttrack","hsl(8, 100%, 80%)"],["websocket","hsl(0, 0%, 95%)"],["xhr","hsl(53, 100%, 80%)"],["fetch","hsl(53, 100%, 80%)"],["other","hsl(0, 0%, 95%)"]]),i=new Map,r=new Map;for(const n of Object.values(e.ResourceType.resourceTypes)){let e=t.get(n.name());e||(e=t.get("other"));const a=o(e);i.set(n,{fillStyle:s(e),lineWidth:1,borderColor:a}),r.set(n,{fillStyle:e,lineWidth:1,borderColor:a})}return[i,r];function o(t){const i=e.Color.parse(t)?.as("hsl");if(!i)return"";let{s:r,l:o}=i;return r/=2,o-=Math.min(o,.2),new e.Color.HSL(i.h,r,o,i.alpha).asString()}function s(t){const i=e.Color.parse(t)?.as("hsl");if(!i)return"";let{l:r}=i;return r*=1.1,new e.Color.HSL(i.h,i.s,r,i.alpha).asString()}}resetPaths(){this.pathForStyle.clear(),this.pathForStyle.set(this.wiskerStyle,new Path2D),this.styleForTimeRangeName.forEach((e=>this.pathForStyle.set(e,new Path2D))),this.styleForWaitingResourceType.forEach((e=>this.pathForStyle.set(e,new Path2D))),this.styleForDownloadingResourceType.forEach((e=>this.pathForStyle.set(e,new Path2D))),this.pathForStyle.set(this.hoverDetailsStyle,new Path2D)}willHide(){this.popoverHelper.hidePopover()}wasShown(){this.update(),this.registerCSSFiles([yi])}onMouseMove(e){this.setHoveredNode(this.getNodeFromPoint(e.offsetX,e.offsetY),e.shiftKey)}onClick(e){this.setSelectedNode(this.getNodeFromPoint(e.offsetX,e.offsetY))&&e.consume(!0)}getPopoverRequest(t){if(!this.hoveredNode)return null;const i=this.hoveredNode.request();if(!i)return null;let r,o,s;if(!e.Settings.Settings.instance().moduleSetting("networkColorCodeResourceTypes").get()&&!this.calculator.startAtZero?(r=_t.calculateRequestTimeRanges(i,0).find((e=>e.name===jt.Total)),o=this.timeToPosition(r.start),s=this.timeToPosition(r.end)):(r=this.getSimplifiedBarRange(i,0),o=r.start,s=r.end),s-o<50){const e=(s-o)/2;o=o+e-25,s=s-e+25}if(t.clientX<this.canvasPosition.left+o||t.clientX>this.canvasPosition.left+s)return null;const n=this.nodes.findIndex((e=>e.hovered())),a=this.getBarHeight(r.name),l=this.headerHeight+(this.rowHeight*n-this.scrollTop)+(this.rowHeight-a)/2;if(t.clientY<this.canvasPosition.top+l||t.clientY>this.canvasPosition.top+l+a)return null;const d=this.element.boxInWindow();return d.x+=o,d.y+=l,d.width=s-o,d.height=a,{box:d,show:e=>{const t=_t.createTimingTable(i,this.calculator);return e.registerCSSFiles([Ot]),e.contentElement.appendChild(t),Promise.resolve(!0)},hide:void 0}}setHoveredNode(e,t){this.hoveredNode&&this.hoveredNode.setHovered(!1,!1),this.hoveredNode=e,this.hoveredNode&&this.hoveredNode.setHovered(!0,t)}setSelectedNode(e){return!(!e||!e.dataGrid)&&(e.select(),e.dataGrid.element.focus(),!0)}setRowHeight(e){this.rawRowHeight=e,this.updateRowHeight()}updateRowHeight(){this.rowHeight=Math.round(this.rawRowHeight*window.devicePixelRatio)/window.devicePixelRatio}setHeaderHeight(e){this.headerHeight=e}setRightPadding(e){this.rightPadding=e,this.calculateCanvasSize()}setCalculator(e){this.calculator=e}getNodeFromPoint(e,t){return t<=this.headerHeight?null:this.nodes[Math.floor((this.scrollTop+t-this.headerHeight)/this.rowHeight)]}scheduleDraw(){this.updateRequestID||(this.updateRequestID=this.element.window().requestAnimationFrame((()=>this.update())))}update(e,t,i){void 0!==e&&this.scrollTop!==e&&(this.popoverHelper.hidePopover(),this.scrollTop=e),i&&(this.nodes=i,this.calculateCanvasSize()),void 0!==t&&(this.eventDividers=t),this.updateRequestID&&(this.element.window().cancelAnimationFrame(this.updateRequestID),delete this.updateRequestID),this.startTime=this.calculator.minimumBoundary(),this.endTime=this.calculator.maximumBoundary(),this.resetCanvas(),this.resetPaths(),this.textLayers=[],this.draw()}resetCanvas(){const e=window.devicePixelRatio;this.canvas.width=this.offsetWidth*e,this.canvas.height=this.offsetHeight*e,this.canvas.style.width=this.offsetWidth+"px",this.canvas.style.height=this.offsetHeight+"px"}onResize(){super.onResize(),this.updateRowHeight(),this.calculateCanvasSize(),this.scheduleDraw()}calculateCanvasSize(){this.offsetWidth=this.contentElement.offsetWidth-this.rightPadding,this.offsetHeight=this.contentElement.offsetHeight,this.calculator.setDisplayWidth(this.offsetWidth),this.canvasPosition=this.canvas.getBoundingClientRect()}timeToPosition(e){const t=(this.offsetWidth-this.leftPadding)/(this.endTime-this.startTime);return Math.floor(this.leftPadding+(e-this.startTime)*t)}didDrawForTest(){}draw(){const t=!e.Settings.Settings.instance().moduleSetting("networkColorCodeResourceTypes").get()&&!this.calculator.startAtZero,i=this.nodes,r=this.canvas.getContext("2d");if(!r)return;r.save(),r.scale(window.devicePixelRatio,window.devicePixelRatio),r.translate(0,this.headerHeight),r.rect(0,0,this.offsetWidth,this.offsetHeight),r.clip();const o=Math.floor(this.scrollTop/this.rowHeight),s=Math.min(i.length,o+Math.ceil(this.offsetHeight/this.rowHeight));for(let e=o;e<s;e++){const o=this.rowHeight*e,s=i[e];this.decorateRow(r,s,o-this.scrollTop);let n=[];s.hasChildren()&&!s.expanded&&(n=s.flatChildren()),n.push(s);for(const e of n)t?this.buildTimingBarLayers(e,o-this.scrollTop):this.buildSimplifiedBarLayers(r,e,o-this.scrollTop)}this.drawLayers(r,t),r.save(),r.fillStyle=H.ThemeSupport.instance().getComputedValue("--color-text-disabled");for(const e of this.textLayers)r.fillText(e.text,e.x,e.y);r.restore(),this.drawEventDividers(r),r.restore();const n=m.TimelineGrid.TimelineGrid.calculateGridOffsets(this.calculator);m.TimelineGrid.TimelineGrid.drawCanvasGrid(r,n),m.TimelineGrid.TimelineGrid.drawCanvasHeaders(r,n,(e=>this.calculator.formatValue(e,n.precision)),this.fontSize,this.headerHeight,75),r.save(),r.scale(window.devicePixelRatio,window.devicePixelRatio),r.clearRect(this.offsetWidth-18,0,18,this.headerHeight),r.restore(),this.didDrawForTest()}drawLayers(e,t){for(const i of this.pathForStyle){const r=i[0],o=i[1];e.save(),e.beginPath(),r.lineWidth&&(e.lineWidth=r.lineWidth,r.borderColor&&(e.strokeStyle=r.borderColor),e.stroke(o)),r.fillStyle&&(e.fillStyle=t?H.ThemeSupport.instance().getComputedValue(r.fillStyle):r.fillStyle,e.fill(o)),e.restore()}}drawEventDividers(e){e.save(),e.lineWidth=1;for(const t of this.eventDividers.keys()){e.strokeStyle=t;for(const i of this.eventDividers.get(t)||[]){e.beginPath();const t=this.timeToPosition(i);e.moveTo(t,0),e.lineTo(t,this.offsetHeight)}e.stroke()}e.restore()}getBarHeight(e){const t=jt;switch(e){case t.Connecting:case t.SSL:case t.DNS:case t.Proxy:case t.Blocking:case t.Push:case t.Queueing:return 7;default:return 13}}getSimplifiedBarRange(e,t){const i=this.offsetWidth-this.leftPadding,r=this.calculator.computeBarGraphPercentages(e);return{start:this.leftPadding+Math.floor(r.start/100*i)+t,mid:this.leftPadding+Math.floor(r.middle/100*i)+t,end:this.leftPadding+Math.floor(r.end/100*i)+t}}buildSimplifiedBarLayers(e,t,i){const r=t.request();if(!r)return;const o=.5,s=this.getSimplifiedBarRange(r,o),n=this.getBarHeight();i+=Math.floor(this.rowHeight/2-n/2+1)-.5;const a=this.styleForWaitingResourceType.get(r.resourceType());this.pathForStyle.get(a).rect(s.start,i,s.mid-s.start,n-1);const l=Math.max(2,s.end-s.mid),d=this.styleForDownloadingResourceType.get(r.resourceType());this.pathForStyle.get(d).rect(s.mid,i,l,n-1);let c=null;if(t.hovered()){c=this.calculator.computeBarGraphLabels(r);const t=10,a=e.measureText(c.left).width,d=e.measureText(c.right).width,h=this.pathForStyle.get(this.hoverDetailsStyle);if(a<s.mid-s.start){const e=s.start+(s.mid-s.start-a)/2;this.textLayers.push({text:c.left,x:e,y:i+this.fontSize})}else t+a+this.leftPadding<s.start&&(this.textLayers.push({text:c.left,x:s.start-a-t-1,y:i+this.fontSize}),h.moveTo(s.start-t,i+Math.floor(n/2)),h.arc(s.start,i+Math.floor(n/2),2,0,2*Math.PI),h.moveTo(s.start-t,i+Math.floor(n/2)),h.lineTo(s.start,i+Math.floor(n/2)));const u=s.mid+l+o;if(d<u-s.mid){const e=s.mid+(u-s.mid-d)/2;this.textLayers.push({text:c.right,x:e,y:i+this.fontSize})}else u+t+d<this.offsetWidth-this.leftPadding&&(this.textLayers.push({text:c.right,x:u+t+1,y:i+this.fontSize}),h.moveTo(u,i+Math.floor(n/2)),h.arc(u,i+Math.floor(n/2),2,0,2*Math.PI),h.moveTo(u,i+Math.floor(n/2)),h.lineTo(u+t,i+Math.floor(n/2)))}if(!this.calculator.startAtZero){const t=_t.calculateRequestTimeRanges(r,0).find((e=>e.name===jt.Total)),a=c?e.measureText(c.left).width:0,l=a<s.mid-s.start,d=13,h=c&&!l?a+d:0,u=this.timeToPosition(t.start);if(s.start-h>u){const e=this.pathForStyle.get(this.wiskerStyle);e.moveTo(u,i+Math.floor(n/2)),e.lineTo(s.start-h,i+Math.floor(n/2));const t=n/2;e.moveTo(u+o,i+t/2),e.lineTo(u+o,i+n-t/2-1)}}}buildTimingBarLayers(e,t){const i=e.request();if(!i)return;const r=_t.calculateRequestTimeRanges(i,0);let o=0;for(const e of r){if(e.name===jt.Total||e.name===jt.Sending||e.end-e.start==0)continue;const i=this.styleForTimeRangeName.get(e.name),r=this.pathForStyle.get(i),s=i.lineWidth||0,n=this.getBarHeight(e.name),a=t+Math.floor(this.rowHeight/2-n/2)+s/2,l=this.timeToPosition(e.start),d=this.timeToPosition(e.end);r.rect(l+1*o,a,d-l,n-s),o++}}decorateRow(e,t,i){const r=t.backgroundColor();e.save(),e.beginPath(),e.fillStyle=H.ThemeSupport.instance().getComputedValue(r),e.rect(0,i,this.offsetWidth,this.rowHeight),e.fill(),e.restore()}}var Pi=Object.freeze({__proto__:null,NetworkWaterfallColumn:Hi});const Ei={networkLog:"Network Log",waterfall:"Waterfall",responseHeaders:"Response Headers",manageHeaderColumns:"Manage Header Columns…",startTime:"Start Time",responseTime:"Response Time",endTime:"End Time",totalDuration:"Total Duration",latency:"Latency",name:"Name",path:"Path",url:"Url",method:"Method",status:"Status",text:"Text",protocol:"Protocol",scheme:"Scheme",domain:"Domain",remoteAddress:"Remote Address",type:"Type",initiator:"Initiator",initiatorAddressSpace:"Initiator Address Space",cookies:"Cookies",setCookies:"Set Cookies",size:"Size",content:"Content",time:"Time",priority:"Priority",connectionId:"Connection ID",remoteAddressSpace:"Remote Address Space"},Mi=i.i18n.registerUIStrings("panels/network/NetworkLogViewColumns.ts",Ei),Ui=i.i18n.getLocalizedString.bind(void 0,Mi),Ni=i.i18n.getLazilyComputedLocalizedString.bind(void 0,Mi);class Ai{networkLogView;persistantSettings;networkLogLargeRowsSetting;eventDividers;eventDividersShown;gridMode;columns;waterfallRequestsAreStale;waterfallScrollerWidthIsStale;popupLinkifier;calculatorsMap;lastWheelTime;dataGridInternal;splitWidget;waterfallColumn;activeScroller;dataGridScroller;waterfallScroller;waterfallScrollerContent;waterfallHeaderElement;waterfallColumnSortIcon;activeWaterfallSortId;popoverHelper;hasScrollerTouchStarted;scrollerTouchStartPos;constructor(t,i,r,o){this.networkLogView=t,this.persistantSettings=e.Settings.Settings.instance().createSetting("networkLogColumns",{}),this.networkLogLargeRowsSetting=o,this.networkLogLargeRowsSetting.addChangeListener(this.updateRowsSize,this),this.eventDividers=new Map,this.eventDividersShown=!1,this.gridMode=!0,this.columns=[],this.waterfallRequestsAreStale=!1,this.waterfallScrollerWidthIsStale=!0,this.popupLinkifier=new g.Linkifier.Linkifier,this.calculatorsMap=new Map,this.calculatorsMap.set(Vi.Time,i),this.calculatorsMap.set(Vi.Duration,r),this.lastWheelTime=0,this.setupDataGrid(),this.setupWaterfall(),H.ThemeSupport.instance().addEventListener(H.ThemeChangeEvent.eventName,(()=>{this.scheduleRefresh()}))}static convertToDataGridDescriptor(e){const t=e.title instanceof Function?e.title():e.title;return{id:e.id,title:t,sortable:e.sortable,align:e.align,nonSelectable:e.nonSelectable,weight:e.weight,allowInSortByEvenWhenHidden:e.allowInSortByEvenWhenHidden}}wasShown(){this.updateRowsSize()}willHide(){this.popoverHelper&&this.popoverHelper.hidePopover()}reset(){this.popoverHelper&&this.popoverHelper.hidePopover(),this.eventDividers.clear()}setupDataGrid(){const e=Oi,t=Wi;this.columns=[];for(const i of e){const e=Object.assign({},t,i);if(e.id=e.id,e.subtitle){const t=e.title instanceof Function?e.title():e.title,i=e.subtitle instanceof Function?e.subtitle():e.subtitle;e.titleDOMFragment=this.makeHeaderFragment(t,i)}this.columns.push(e)}this.loadCustomColumnsAndSettings(),this.popoverHelper=new o.PopoverHelper.PopoverHelper(this.networkLogView.element,this.getPopoverRequest.bind(this)),this.popoverHelper.setHasPadding(!0),this.popoverHelper.setTimeout(300,300),this.dataGridInternal=new a.SortableDataGrid.SortableDataGrid({displayName:Ui(Ei.networkLog),columns:this.columns.map(Ai.convertToDataGridDescriptor),editCallback:void 0,deleteCallback:void 0,refreshCallback:void 0}),this.dataGridInternal.element.addEventListener("mousedown",(e=>{!this.dataGridInternal.selectedNode&&e.button&&e.consume()}),!0),this.dataGridScroller=this.dataGridInternal.scrollContainer,this.updateColumns(),this.dataGridInternal.addEventListener(a.DataGrid.Events.SortingChanged,this.sortHandler,this),this.dataGridInternal.setHeaderContextMenuCallback(this.innerHeaderContextMenu.bind(this)),this.activeWaterfallSortId=Gi.StartTime,this.dataGridInternal.markColumnAsSortedBy(Bi,a.DataGrid.Order.Ascending),this.splitWidget=new o.SplitWidget.SplitWidget(!0,!0,"networkPanelSplitViewWaterfall",200);const i=this.dataGridInternal.asWidget();i.setMinimumSize(150,0),this.splitWidget.setMainWidget(i)}setupWaterfall(){this.waterfallColumn=new Hi(this.networkLogView.calculator()),this.waterfallColumn.element.addEventListener("contextmenu",function(e){const t=e,i=this.waterfallColumn.getNodeFromPoint(t.offsetX,t.offsetY);if(!i)return;const r=i.request();if(!r)return;const s=new o.ContextMenu.ContextMenu(t);this.networkLogView.handleContextMenuForRequest(s,r),s.show()}.bind(this)),this.waterfallColumn.element.addEventListener("wheel",this.onMouseWheel.bind(this,!1),{passive:!0}),this.waterfallColumn.element.addEventListener("touchstart",this.onTouchStart.bind(this)),this.waterfallColumn.element.addEventListener("touchmove",this.onTouchMove.bind(this)),this.waterfallColumn.element.addEventListener("touchend",this.onTouchEnd.bind(this)),this.dataGridScroller.addEventListener("wheel",this.onMouseWheel.bind(this,!0),!0),this.dataGridScroller.addEventListener("touchstart",this.onTouchStart.bind(this)),this.dataGridScroller.addEventListener("touchmove",this.onTouchMove.bind(this)),this.dataGridScroller.addEventListener("touchend",this.onTouchEnd.bind(this)),this.waterfallScroller=this.waterfallColumn.contentElement.createChild("div","network-waterfall-v-scroll"),this.waterfallScrollerContent=this.waterfallScroller.createChild("div","network-waterfall-v-scroll-content"),this.dataGridInternal.addEventListener(a.DataGrid.Events.PaddingChanged,(()=>{this.waterfallScrollerWidthIsStale=!0,this.syncScrollers()})),this.dataGridInternal.addEventListener(a.ViewportDataGrid.Events.ViewportCalculated,this.redrawWaterfallColumn.bind(this)),this.createWaterfallHeader(),this.waterfallColumn.contentElement.classList.add("network-waterfall-view"),this.waterfallColumn.setMinimumSize(100,0),this.splitWidget.setSidebarWidget(this.waterfallColumn),this.switchViewMode(!1)}onMouseWheel(e,t){e&&t.consume(!0);const i=t,r=Date.now()-this.lastWheelTime<80;this.activeScroller.scrollBy({top:i.deltaY,behavior:r?"auto":"smooth"}),this.syncScrollers(),this.lastWheelTime=Date.now()}onTouchStart(e){const t=e;this.hasScrollerTouchStarted=!0,this.scrollerTouchStartPos=t.changedTouches[0].pageY}onTouchMove(e){if(!this.hasScrollerTouchStarted)return;const t=e.changedTouches[0].pageY,i=this.scrollerTouchStartPos-t;this.activeScroller.scrollBy({top:i,behavior:"auto"}),this.syncScrollers(),this.scrollerTouchStartPos=t}onTouchEnd(){this.hasScrollerTouchStarted=!1}syncScrollers(){this.waterfallColumn.isShowing()&&(this.waterfallScrollerContent.style.height=this.dataGridScroller.scrollHeight-this.dataGridInternal.headerHeight()+"px",this.updateScrollerWidthIfNeeded(),this.dataGridScroller.scrollTop=this.waterfallScroller.scrollTop)}updateScrollerWidthIfNeeded(){this.waterfallScrollerWidthIsStale&&(this.waterfallScrollerWidthIsStale=!1,this.waterfallColumn.setRightPadding(this.waterfallScroller.offsetWidth-this.waterfallScrollerContent.offsetWidth))}redrawWaterfallColumn(){if(!this.waterfallRequestsAreStale)return this.updateScrollerWidthIfNeeded(),void this.waterfallColumn.update(this.activeScroller.scrollTop,this.eventDividersShown?this.eventDividers:void 0);this.syncScrollers();const e=this.networkLogView.flatNodesList();this.waterfallColumn.update(this.activeScroller.scrollTop,this.eventDividers,e)}createWaterfallHeader(){this.waterfallHeaderElement=this.waterfallColumn.contentElement.createChild("div","network-waterfall-header"),this.waterfallHeaderElement.addEventListener("click",function(){const e=a.DataGrid.Order,t="waterfall"===this.dataGridInternal.sortColumnId(),i=this.dataGridInternal.isSortOrderAscending(),r=t&&i?e.Descending:e.Ascending;this.dataGridInternal.markColumnAsSortedBy("waterfall",r),this.sortHandler()}.bind(this)),this.waterfallHeaderElement.addEventListener("contextmenu",(e=>this.innerHeaderContextMenu(new o.ContextMenu.ContextMenu(e))));this.waterfallHeaderElement.createChild("div").textContent=Ui(Ei.waterfall),this.waterfallColumnSortIcon=o.Icon.Icon.create("","sort-order-icon"),this.waterfallHeaderElement.createChild("div","sort-order-icon-container").appendChild(this.waterfallColumnSortIcon)}setCalculator(e){this.waterfallColumn.setCalculator(e)}scheduleRefresh(){this.waterfallColumn.scheduleDraw()}updateRowsSize(){const e=Boolean(this.networkLogLargeRowsSetting.get());this.dataGridInternal.element.classList.toggle("small",!e),this.dataGridInternal.scheduleUpdate(),this.waterfallScrollerWidthIsStale=!0,this.waterfallColumn.setRowHeight(e?41:21),this.waterfallScroller.classList.toggle("small",!e),this.waterfallHeaderElement.classList.toggle("small",!e),window.requestAnimationFrame((()=>{this.waterfallColumn.setHeaderHeight(this.waterfallScroller.offsetTop),this.waterfallColumn.scheduleDraw()}))}show(e){this.splitWidget.show(e)}setHidden(e){o.ARIAUtils.setHidden(this.splitWidget.element,e)}dataGrid(){return this.dataGridInternal}sortByCurrentColumn(){this.sortHandler()}sortHandler(){const e=this.dataGridInternal.sortColumnId();if(this.networkLogView.removeAllNodeHighlights(),this.waterfallRequestsAreStale=!0,"waterfall"===e){this.dataGridInternal.sortOrder()===a.DataGrid.Order.Ascending?this.waterfallColumnSortIcon.setIconType("smallicon-triangle-up"):this.waterfallColumnSortIcon.setIconType("smallicon-triangle-down");const e=ve.RequestPropertyComparator.bind(null,this.activeWaterfallSortId);return this.dataGridInternal.sortNodes(e,!this.dataGridInternal.isSortOrderAscending()),void this.dataGridSortedForTest()}this.waterfallColumnSortIcon.setIconType("");const t=this.columns.find((t=>t.id===e));if(!t||!t.sortingFunction)return;const i=t.sortingFunction;i&&(this.dataGridInternal.sortNodes(i,!this.dataGridInternal.isSortOrderAscending()),this.dataGridSortedForTest())}dataGridSortedForTest(){}updateColumns(){if(!this.dataGridInternal)return;const e=new Set;if(this.gridMode)for(const t of this.columns)t.visible&&e.add(t.id);else{const t=this.columns.find((e=>"path"===e.hideableGroup&&e.visible));t?e.add(t.id):e.add("name")}this.dataGridInternal.setColumnsVisiblity(e)}switchViewMode(e){this.gridMode!==e&&(this.gridMode=e,e?(this.splitWidget.showBoth(),this.activeScroller=this.waterfallScroller,this.waterfallScroller.scrollTop=this.dataGridScroller.scrollTop,this.dataGridInternal.setScrollContainer(this.waterfallScroller)):(this.networkLogView.removeAllNodeHighlights(),this.splitWidget.hideSidebar(),this.activeScroller=this.dataGridScroller,this.dataGridInternal.setScrollContainer(this.dataGridScroller)),this.networkLogView.element.classList.toggle("brief-mode",!e),this.updateColumns(),this.updateRowsSize())}toggleColumnVisibility(e){this.loadCustomColumnsAndSettings(),e.visible=!e.visible,this.saveColumnsSettings(),this.updateColumns()}saveColumnsSettings(){const e={};for(const t of this.columns)e[t.id]={visible:t.visible,title:t.title};this.persistantSettings.set(e)}loadCustomColumnsAndSettings(){const e=this.persistantSettings.get(),t=Object.keys(e);for(const i of t){const t=e[i];let r=this.columns.find((e=>e.id===i));r||(r=this.addCustomHeader(t.title,i)||void 0),r&&r.hideable&&"boolean"==typeof t.visible&&(r.visible=Boolean(t.visible)),r&&"string"==typeof t.title&&(r.title=t.title)}}makeHeaderFragment(e,t){const i=document.createDocumentFragment();o.UIUtils.createTextChild(i,e);const r=i.createChild("div","network-header-subtitle");return o.UIUtils.createTextChild(r,t),i}innerHeaderContextMenu(e){const t=this.columns.filter((e=>e.hideable)),i=t.filter((e=>!e.isResponseHeader)),r=new Map,o=[];for(const e of i)if(e.hideableGroup){const t=e.hideableGroup;let i=r.get(t);i||(i=[],r.set(t,i)),i.push(e)}else o.push(e);for(const t of r.values()){const i=t.filter((e=>e.visible));for(const r of t){const t=1===i.length&&i[0]===r,o=r.title instanceof Function?r.title():r.title;e.headerSection().appendCheckboxItem(o,this.toggleColumnVisibility.bind(this,r),r.visible,t)}e.headerSection().appendSeparator()}for(const t of o){const i=t.title instanceof Function?t.title():t.title;e.headerSection().appendCheckboxItem(i,this.toggleColumnVisibility.bind(this,t),t.visible)}const s=e.footerSection().appendSubMenuItem(Ui(Ei.responseHeaders)),n=t.filter((e=>e.isResponseHeader));for(const e of n){const t=e.title instanceof Function?e.title():e.title;s.defaultSection().appendCheckboxItem(t,this.toggleColumnVisibility.bind(this,e),e.visible)}s.footerSection().appendItem(Ui(Ei.manageHeaderColumns),this.manageCustomHeaderDialog.bind(this));const l=Gi,d=e.footerSection().appendSubMenuItem(Ui(Ei.waterfall));function c(e){let t=this.calculatorsMap.get(Vi.Time);const i=Gi;e!==i.Duration&&e!==i.Latency||(t=this.calculatorsMap.get(Vi.Duration)),this.networkLogView.setCalculator(t),this.activeWaterfallSortId=e,this.dataGridInternal.markColumnAsSortedBy("waterfall",a.DataGrid.Order.Ascending),this.sortHandler()}d.defaultSection().appendCheckboxItem(Ui(Ei.startTime),c.bind(this,l.StartTime),this.activeWaterfallSortId===l.StartTime),d.defaultSection().appendCheckboxItem(Ui(Ei.responseTime),c.bind(this,l.ResponseTime),this.activeWaterfallSortId===l.ResponseTime),d.defaultSection().appendCheckboxItem(Ui(Ei.endTime),c.bind(this,l.EndTime),this.activeWaterfallSortId===l.EndTime),d.defaultSection().appendCheckboxItem(Ui(Ei.totalDuration),c.bind(this,l.Duration),this.activeWaterfallSortId===l.Duration),d.defaultSection().appendCheckboxItem(Ui(Ei.latency),c.bind(this,l.Latency),this.activeWaterfallSortId===l.Latency)}manageCustomHeaderDialog(){const e=[];for(const t of this.columns){const i=t.title instanceof Function?t.title():t.title;t.isResponseHeader&&e.push({title:i,editable:t.isCustomHeader})}const t=new Si(e,(e=>Boolean(this.addCustomHeader(e))),this.changeCustomHeader.bind(this),this.removeCustomHeader.bind(this)),i=new o.Dialog.Dialog;t.show(i.contentElement),i.setSizeBehavior("MeasureContent"),i.show(this.networkLogView.element)}removeCustomHeader(e){e=e.toLowerCase();const t=this.columns.findIndex((t=>t.id===e));return-1!==t&&(this.columns.splice(t,1),this.dataGridInternal.removeColumn(e),this.saveColumnsSettings(),this.updateColumns(),!0)}addCustomHeader(e,t,i){t||(t=e.toLowerCase()),void 0===i&&(i=this.columns.length-1);const r=this.columns.find((e=>e.id===t));if(r)return null;const o=Object.assign({},Wi,{id:t,title:e,isResponseHeader:!0,isCustomHeader:!0,visible:!0,sortingFunction:ve.ResponseHeaderStringComparator.bind(null,t)});return this.columns.splice(i,0,o),this.dataGridInternal&&this.dataGridInternal.addColumn(Ai.convertToDataGridDescriptor(o),i),this.saveColumnsSettings(),this.updateColumns(),o}changeCustomHeader(e,t,i){i||(i=t.toLowerCase()),e=e.toLowerCase();const r=this.columns.findIndex((t=>t.id===e)),o=this.columns[r],s=this.columns.find((e=>e.id===i));return!(!o||s&&e!==i)&&(this.removeCustomHeader(e),this.addCustomHeader(t,i,r),!0)}getPopoverRequest(e){if(!this.gridMode)return null;const t=this.networkLogView.hoveredNode();if(!t||!e.target)return null;const i=e.target.enclosingNodeOrSelfWithClass("network-script-initiated");if(!i)return null;const r=t.request();return r?{box:i.boxInWindow(),show:async e=>{this.popupLinkifier.setLiveLocationUpdateCallback((()=>{e.setSizeBehavior("MeasureContent")}));const t=Ze.createStackTracePreview(r,this.popupLinkifier,!1);return!!t&&(e.contentElement.appendChild(t.element),!0)},hide:this.popupLinkifier.reset.bind(this.popupLinkifier)}:null}addEventDividers(e,t){let i="transparent";switch(t){case"network-dcl-divider":i="#0867CB";break;case"network-load-divider":i="#B31412";break;default:return}const r=this.eventDividers.get(i)||[];this.eventDividers.set(i,r.concat(e)),this.networkLogView.scheduleRefresh()}hideEventDividers(){this.eventDividersShown=!0,this.redrawWaterfallColumn()}showEventDividers(){this.eventDividersShown=!1,this.redrawWaterfallColumn()}selectFilmStripFrame(e){this.eventDividers.set(Di,[e]),this.redrawWaterfallColumn()}clearFilmStripFrame(){this.eventDividers.delete(Di),this.redrawWaterfallColumn()}}const Bi="waterfall";var Vi;!function(e){e.Duration="Duration",e.Time="Time"}(Vi||(Vi={}));const Wi={subtitle:null,visible:!1,weight:6,sortable:!0,hideable:!0,hideableGroup:null,nonSelectable:!1,isResponseHeader:!1,isCustomHeader:!1,allowInSortByEvenWhenHidden:!1},Oi=[{id:"name",title:Ni(Ei.name),subtitle:Ni(Ei.path),visible:!0,weight:20,hideable:!0,hideableGroup:"path",sortingFunction:ve.NameComparator},{id:"path",title:Ni(Ei.path),hideable:!0,hideableGroup:"path",sortingFunction:ve.RequestPropertyComparator.bind(null,"pathname")},{id:"url",title:Ni(Ei.url),hideable:!0,hideableGroup:"path",sortingFunction:ve.RequestURLComparator},{id:"method",title:Ni(Ei.method),sortingFunction:ve.RequestPropertyComparator.bind(null,"requestMethod")},{id:"status",title:Ni(Ei.status),visible:!0,subtitle:Ni(Ei.text),sortingFunction:ve.RequestPropertyComparator.bind(null,"statusCode")},{id:"protocol",title:Ni(Ei.protocol),sortingFunction:ve.RequestPropertyComparator.bind(null,"protocol")},{id:"scheme",title:Ni(Ei.scheme),sortingFunction:ve.RequestPropertyComparator.bind(null,"scheme")},{id:"domain",title:Ni(Ei.domain),sortingFunction:ve.RequestPropertyComparator.bind(null,"domain")},{id:"remoteaddress",title:Ni(Ei.remoteAddress),weight:10,align:a.DataGrid.Align.Right,sortingFunction:ve.RemoteAddressComparator},{id:"remoteaddress-space",title:Ni(Ei.remoteAddressSpace),visible:!1,weight:10,sortingFunction:ve.RemoteAddressSpaceComparator},{id:"type",title:Ni(Ei.type),visible:!0,sortingFunction:ve.TypeComparator},{id:"initiator",title:Ni(Ei.initiator),visible:!0,weight:10,sortingFunction:ve.InitiatorComparator},{id:"initiator-address-space",title:Ni(Ei.initiatorAddressSpace),visible:!1,weight:10,sortingFunction:ve.InitiatorAddressSpaceComparator},{id:"cookies",title:Ni(Ei.cookies),align:a.DataGrid.Align.Right,sortingFunction:ve.RequestCookiesCountComparator},{id:"setcookies",title:Ni(Ei.setCookies),align:a.DataGrid.Align.Right,sortingFunction:ve.ResponseCookiesCountComparator},{id:"size",title:Ni(Ei.size),visible:!0,subtitle:Ni(Ei.content),align:a.DataGrid.Align.Right,sortingFunction:ve.SizeComparator},{id:"time",title:Ni(Ei.time),visible:!0,subtitle:Ni(Ei.latency),align:a.DataGrid.Align.Right,sortingFunction:ve.RequestPropertyComparator.bind(null,"duration")},{id:"priority",title:Ni(Ei.priority),sortingFunction:ve.PriorityComparator},{id:"connectionid",title:Ni(Ei.connectionId),sortingFunction:ve.RequestPropertyComparator.bind(null,"connectionId")},{id:"cache-control",isResponseHeader:!0,title:i.i18n.lockedLazyString("Cache-Control"),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"cache-control")},{id:"connection",isResponseHeader:!0,title:i.i18n.lockedLazyString("Connection"),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"connection")},{id:"content-encoding",isResponseHeader:!0,title:i.i18n.lockedLazyString("Content-Encoding"),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"content-encoding")},{id:"content-length",isResponseHeader:!0,title:i.i18n.lockedLazyString("Content-Length"),align:a.DataGrid.Align.Right,sortingFunction:ve.ResponseHeaderNumberComparator.bind(null,"content-length")},{id:"etag",isResponseHeader:!0,title:i.i18n.lockedLazyString("ETag"),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"etag")},{id:"keep-alive",isResponseHeader:!0,title:i.i18n.lockedLazyString("Keep-Alive"),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"keep-alive")},{id:"last-modified",isResponseHeader:!0,title:i.i18n.lockedLazyString("Last-Modified"),sortingFunction:ve.ResponseHeaderDateComparator.bind(null,"last-modified")},{id:"server",isResponseHeader:!0,title:i.i18n.lockedLazyString("Server"),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"server")},{id:"vary",isResponseHeader:!0,title:i.i18n.lockedLazyString("Vary"),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"vary")},{id:"waterfall",title:Ni(Ei.waterfall),visible:!1,hideable:!1,allowInSortByEvenWhenHidden:!0}],Di="#fccc49";var Gi;!function(e){e.StartTime="startTime",e.ResponseTime="responseReceivedTime",e.EndTime="endTime",e.Duration="duration",e.Latency="latency"}(Gi||(Gi={}));var zi=Object.freeze({__proto__:null,NetworkLogViewColumns:Ai,_initialSortColumn:Bi,get _calculatorTypes(){return Vi},_defaultColumnConfig:Wi,_filmStripDividerColor:Di,get WaterfallSortIds(){return Gi}});const _i={invertFilter:"Invert",invertsFilter:"Inverts the search filter",hideDataUrls:"Hide data URLs",hidesDataAndBlobUrls:"Hides data: and blob: URLs",resourceTypesToInclude:"Resource types to include",hasBlockedCookies:"Has blocked cookies",onlyShowRequestsWithBlocked:"Only show requests with blocked response cookies",blockedRequests:"Blocked Requests",onlyShowBlockedRequests:"Only show blocked requests",thirdParty:"3rd-party requests",onlyShowThirdPartyRequests:"Shows only requests with origin different from page origin",dropHarFilesHere:"Drop HAR files here",recordingNetworkActivity:"Recording network activity…",performARequestOrHitSToRecordThe:"Perform a request or hit {PH1} to record the reload.",recordToDisplayNetworkActivity:"Record network log ({PH1}) to display network activity.",learnMore:"Learn more",networkDataAvailable:"Network Data Available",sSRequests:"{PH1} / {PH2} requests",sSTransferred:"{PH1} / {PH2} transferred",sBSBTransferredOverNetwork:"{PH1} B / {PH2} B transferred over network",sSResources:"{PH1} / {PH2} resources",sBSBResourcesLoadedByThePage:"{PH1} B / {PH2} B resources loaded by the page",sRequests:"{PH1} requests",sTransferred:"{PH1} transferred",sBTransferredOverNetwork:"{PH1} B transferred over network",sResources:"{PH1} resources",sBResourcesLoadedByThePage:"{PH1} B resources loaded by the page",finishS:"Finish: {PH1}",domcontentloadedS:"DOMContentLoaded: {PH1}",loadS:"Load: {PH1}",copy:"Copy",copyRequestHeaders:"Copy request headers",copyResponseHeaders:"Copy response headers",copyResponse:"Copy response",copyStacktrace:"Copy stack trace",copyAsPowershell:"Copy as `PowerShell`",copyAsFetch:"Copy as `fetch`",copyAsNodejsFetch:"Copy as `Node.js` `fetch`",copyAsCurlCmd:"Copy as `cURL` (`cmd`)",copyAsCurlBash:"Copy as `cURL` (`bash`)",copyAllAsPowershell:"Copy all as `PowerShell`",copyAllAsFetch:"Copy all as `fetch`",copyAllAsNodejsFetch:"Copy all as `Node.js` `fetch`",copyAllAsCurlCmd:"Copy all as `cURL` (`cmd`)",copyAllAsCurlBash:"Copy all as `cURL` (`bash`)",copyAsCurl:"Copy as `cURL`",copyAllAsCurl:"Copy all as `cURL`",copyAllAsHar:"Copy all as `HAR`",saveAllAsHarWithContent:"Save all as `HAR` with content",clearBrowserCache:"Clear browser cache",clearBrowserCookies:"Clear browser cookies",blockRequestUrl:"Block request URL",unblockS:"Unblock {PH1}",blockRequestDomain:"Block request domain",replayXhr:"Replay XHR",areYouSureYouWantToClearBrowser:"Are you sure you want to clear browser cache?",areYouSureYouWantToClearBrowserCookies:"Are you sure you want to clear browser cookies?",overrideHeaders:"Override headers"},ji=i.i18n.registerUIStrings("panels/network/NetworkLogView.ts",_i),Ki=i.i18n.getLocalizedString.bind(void 0,ji);class $i extends(e.ObjectWrapper.eventMixin(o.Widget.VBox)){networkInvertFilterSetting;networkHideDataURLSetting;networkShowIssuesOnlySetting;networkOnlyBlockedRequestsSetting;networkOnlyThirdPartySetting;networkResourceTypeFiltersSetting;rawRowHeight;progressBarContainer;networkLogLargeRowsSetting;rowHeightInternal;timeCalculatorInternal;durationCalculator;calculatorInternal;columnsInternal;staleRequests;mainRequestLoadTime;mainRequestDOMContentLoadedTime;filters;timeFilter;hoveredNodeInternal;recordingHint;refreshRequestId;highlightedNode;linkifierInternal;recording;needsRefresh;headerHeightInternal;groupLookups;activeGroupLookup;textFilterUI;invertFilterUI;dataURLFilterUI;resourceCategoryFilterUI;onlyIssuesFilterUI;onlyBlockedRequestsUI;onlyThirdPartyFilterUI;filterParser;suggestionBuilder;dataGrid;summaryToolbar;filterBar;textFilterSetting;constructor(t,i,r){function s(){this.rawRowHeight=Boolean(this.networkLogLargeRowsSetting.get())?41:21,this.rowHeightInternal=this.computeRowHeight()}super(),this.setMinimumSize(50,64),this.element.id="network-container",this.element.classList.add("no-node-selected"),this.networkInvertFilterSetting=e.Settings.Settings.instance().createSetting("networkInvertFilter",!1),this.networkHideDataURLSetting=e.Settings.Settings.instance().createSetting("networkHideDataURL",!1),this.networkShowIssuesOnlySetting=e.Settings.Settings.instance().createSetting("networkShowIssuesOnly",!1),this.networkOnlyBlockedRequestsSetting=e.Settings.Settings.instance().createSetting("networkOnlyBlockedRequests",!1),this.networkOnlyThirdPartySetting=e.Settings.Settings.instance().createSetting("networkOnlyThirdPartySetting",!1),this.networkResourceTypeFiltersSetting=e.Settings.Settings.instance().createSetting("networkResourceTypeFilters",{}),this.rawRowHeight=0,this.progressBarContainer=i,this.networkLogLargeRowsSetting=r,this.networkLogLargeRowsSetting.addChangeListener(s.bind(this),this),this.rawRowHeight=0,this.rowHeightInternal=0,s.call(this),this.timeCalculatorInternal=new Bt,this.durationCalculator=new Vt,this.calculatorInternal=this.timeCalculatorInternal,this.columnsInternal=new Ai(this,this.timeCalculatorInternal,this.durationCalculator,r),this.columnsInternal.show(this.element),this.staleRequests=new Set,this.mainRequestLoadTime=-1,this.mainRequestDOMContentLoadedTime=-1,this.filters=[],this.timeFilter=null,this.hoveredNodeInternal=null,this.recordingHint=null,this.refreshRequestId=null,this.highlightedNode=null,this.linkifierInternal=new g.Linkifier.Linkifier,this.recording=!1,this.needsRefresh=!1,this.headerHeightInternal=0,this.groupLookups=new Map,this.groupLookups.set("Frame",new gi(this)),this.activeGroupLookup=null,this.textFilterUI=new o.FilterBar.TextFilterUI,this.textFilterUI.addEventListener("FilterChanged",this.filterChanged,this),t.addFilter(this.textFilterUI),this.invertFilterUI=new o.FilterBar.CheckboxFilterUI("invert-filter",Ki(_i.invertFilter),!0,this.networkInvertFilterSetting),this.invertFilterUI.addEventListener("FilterChanged",this.filterChanged.bind(this),this),o.Tooltip.Tooltip.install(this.invertFilterUI.element(),Ki(_i.invertsFilter)),t.addFilter(this.invertFilterUI),this.dataURLFilterUI=new o.FilterBar.CheckboxFilterUI("hide-data-url",Ki(_i.hideDataUrls),!0,this.networkHideDataURLSetting),this.dataURLFilterUI.addEventListener("FilterChanged",this.filterChanged.bind(this),this),o.Tooltip.Tooltip.install(this.dataURLFilterUI.element(),Ki(_i.hidesDataAndBlobUrls)),t.addFilter(this.dataURLFilterUI);const a=Object.values(e.ResourceType.resourceCategories).map((e=>({name:e.title(),label:()=>e.shortTitle(),title:e.title()})));this.resourceCategoryFilterUI=new o.FilterBar.NamedBitSetFilterUI(a,this.networkResourceTypeFiltersSetting),o.ARIAUtils.setAccessibleName(this.resourceCategoryFilterUI.element(),Ki(_i.resourceTypesToInclude)),this.resourceCategoryFilterUI.addEventListener("FilterChanged",this.filterChanged.bind(this),this),t.addFilter(this.resourceCategoryFilterUI),this.onlyIssuesFilterUI=new o.FilterBar.CheckboxFilterUI("only-show-issues",Ki(_i.hasBlockedCookies),!0,this.networkShowIssuesOnlySetting),this.onlyIssuesFilterUI.addEventListener("FilterChanged",this.filterChanged.bind(this),this),o.Tooltip.Tooltip.install(this.onlyIssuesFilterUI.element(),Ki(_i.onlyShowRequestsWithBlocked)),t.addFilter(this.onlyIssuesFilterUI),this.onlyBlockedRequestsUI=new o.FilterBar.CheckboxFilterUI("only-show-blocked-requests",Ki(_i.blockedRequests),!0,this.networkOnlyBlockedRequestsSetting),this.onlyBlockedRequestsUI.addEventListener("FilterChanged",this.filterChanged.bind(this),this),o.Tooltip.Tooltip.install(this.onlyBlockedRequestsUI.element(),Ki(_i.onlyShowBlockedRequests)),t.addFilter(this.onlyBlockedRequestsUI),this.onlyThirdPartyFilterUI=new o.FilterBar.CheckboxFilterUI("only-show-third-party",Ki(_i.thirdParty),!0,this.networkOnlyThirdPartySetting),this.onlyThirdPartyFilterUI.addEventListener("FilterChanged",this.filterChanged.bind(this),this),o.Tooltip.Tooltip.install(this.onlyThirdPartyFilterUI.element(),Ki(_i.onlyShowThirdPartyRequests)),t.addFilter(this.onlyThirdPartyFilterUI),this.filterParser=new R.TextUtils.FilterParser(Zi),this.suggestionBuilder=new o.FilterSuggestionBuilder.FilterSuggestionBuilder(Zi,$i.sortSearchValues),this.resetSuggestionBuilder(),this.dataGrid=this.columnsInternal.dataGrid(),this.setupDataGrid(),this.columnsInternal.sortByCurrentColumn(),t.filterButton().addEventListener(o.Toolbar.ToolbarButton.Events.Click,this.dataGrid.scheduleUpdate.bind(this.dataGrid,!0)),this.summaryToolbar=new o.Toolbar.Toolbar("network-summary-bar",this.element),this.summaryToolbar.element.setAttribute("role","status"),new o.DropTarget.DropTarget(this.element,[o.DropTarget.Type.File],Ki(_i.dropHarFilesHere),this.handleDrop.bind(this)),e.Settings.Settings.instance().moduleSetting("networkColorCodeResourceTypes").addChangeListener(this.invalidateAllItems.bind(this,!1),this),n.TargetManager.TargetManager.instance().observeModels(n.NetworkManager.NetworkManager,this),h.NetworkLog.NetworkLog.instance().addEventListener(h.NetworkLog.Events.RequestAdded,this.onRequestUpdated,this),h.NetworkLog.NetworkLog.instance().addEventListener(h.NetworkLog.Events.RequestUpdated,this.onRequestUpdated,this),h.NetworkLog.NetworkLog.instance().addEventListener(h.NetworkLog.Events.Reset,this.reset,this),this.updateGroupByFrame(),e.Settings.Settings.instance().moduleSetting("network.group-by-frame").addChangeListener((()=>this.updateGroupByFrame())),this.filterBar=t,this.textFilterSetting=e.Settings.Settings.instance().createSetting("networkTextFilter",""),this.textFilterSetting.get()&&this.textFilterUI.setValue(this.textFilterSetting.get())}updateGroupByFrame(){const t=e.Settings.Settings.instance().moduleSetting("network.group-by-frame").get();this.setGrouping(t?"Frame":null)}static sortSearchValues(e,t){e===p.UIFilter.FilterType.Priority?t.sort(((e,t)=>{const i=m.NetworkPriorities.uiLabelToNetworkPriority(e),r=m.NetworkPriorities.uiLabelToNetworkPriority(t);return m.NetworkPriorities.networkPriorityWeight(i)-m.NetworkPriorities.networkPriorityWeight(r)})):t.sort()}static negativeFilter(e,t){return!e(t)}static requestPathFilter(e,t){return!!e&&e.test(t.path()+"/"+t.name())}static subdomains(e){const t=[e];let i=e.indexOf(".");for(;-1!==i;)t.push("*"+e.substring(i)),i=e.indexOf(".",i+1);return t}static createRequestDomainFilter(e){const t=e.split("*").map(s.StringUtilities.escapeForRegExp).join(".*");return $i.requestDomainFilter.bind(null,new RegExp("^"+t+"$","i"))}static requestDomainFilter(e,t){return e.test(t.domain)}static runningRequestFilter(e){return!e.finished}static fromCacheRequestFilter(e){return e.cached()}static interceptedByServiceWorkerFilter(e){return e.fetchedViaServiceWorker}static initiatedByServiceWorkerFilter(e){return e.initiatedByServiceWorker()}static requestResponseHeaderFilter(e,t){return void 0!==t.responseHeaderValue(e)}static requestResponseHeaderSetCookieFilter(e,t){return Boolean(t.responseHeaderValue("Set-Cookie")?.includes(e))}static requestMethodFilter(e,t){return t.requestMethod===e}static requestPriorityFilter(e,t){return t.priority()===e}static requestMimeTypeFilter(e,t){return t.mimeType===e}static requestMixedContentFilter(e,t){return e===p.UIFilter.MixedContentFilterValues.Displayed?"optionally-blockable"===t.mixedContentType:e===p.UIFilter.MixedContentFilterValues.Blocked?"blockable"===t.mixedContentType&&t.wasBlocked():e===p.UIFilter.MixedContentFilterValues.BlockOverridden?"blockable"===t.mixedContentType&&!t.wasBlocked():e===p.UIFilter.MixedContentFilterValues.All&&"none"!==t.mixedContentType}static requestSchemeFilter(e,t){return t.scheme===e}static requestCookieDomainFilter(e,t){return t.allCookiesIncludingBlockedOnes().some((t=>t.domain()===e))}static requestCookieNameFilter(e,t){return t.allCookiesIncludingBlockedOnes().some((t=>t.name()===e))}static requestCookiePathFilter(e,t){return t.allCookiesIncludingBlockedOnes().some((t=>t.path()===e))}static requestCookieValueFilter(e,t){return t.allCookiesIncludingBlockedOnes().some((t=>t.value()===e))}static requestSetCookieDomainFilter(e,t){return t.responseCookies.some((t=>t.domain()===e))}static requestSetCookieNameFilter(e,t){return t.responseCookies.some((t=>t.name()===e))}static requestSetCookieValueFilter(e,t){return t.responseCookies.some((t=>t.value()===e))}static requestSizeLargerThanFilter(e,t){return t.transferSize>=e}static statusCodeFilter(e,t){return String(t.statusCode)===e}static getHTTPRequestsFilter(e){return e.parsedURL.isValid&&e.scheme in Qi}static resourceTypeFilter(e,t){return t.resourceType().name()===e}static requestUrlFilter(e,t){return new RegExp(s.StringUtilities.escapeForRegExp(e),"i").test(t.url())}static requestTimeFilter(e,t,i){return!(i.issueTime()>t)&&!(-1!==i.endTime&&i.endTime<e)}static copyRequestHeaders(e){t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(e.requestHeadersText())}static copyResponseHeaders(e){t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(e.responseHeadersText)}static async copyResponse(e){const i=await e.contentData();let r=i.content||"";e.contentType().isTextType()?i.encoded&&r&&(r=window.atob(r)):r=R.ContentProvider.contentAsDataURL(r,e.mimeType,i.encoded),t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(r)}handleDrop(e){const t=e.items;if(!t.length)return;const i=t[0].getAsFile();i&&this.onLoadFromFile(i)}async onLoadFromFile(t){const i=new e.StringOutputStream.StringOutputStream,r=new c.FileUtils.ChunkedFileReader(t,1e7);if(!await r.read(i)){const e=r.error();return void(e&&this.harLoadFailed(e.message))}let o;try{o=new L.HARFormat.HARRoot(JSON.parse(i.data()))}catch(e){return void this.harLoadFailed(e)}h.NetworkLog.NetworkLog.instance().importRequests(L.Importer.Importer.requestsFromHARLog(o.log))}harLoadFailed(t){e.Console.Console.instance().error("Failed to load HAR file with following error: "+t)}setGrouping(e){this.activeGroupLookup&&this.activeGroupLookup.reset();const t=e&&this.groupLookups.get(e)||null;this.activeGroupLookup=t,this.invalidateAllItems()}computeRowHeight(){return Math.round(this.rawRowHeight*window.devicePixelRatio)/window.devicePixelRatio}nodeForRequest(e){return Yi.get(e)||null}headerHeight(){return this.headerHeightInternal}setRecording(e){this.recording=e,this.updateSummaryBar()}columns(){return this.columnsInternal}modelAdded(e){if(e.target().parentTarget()?.type()===n.Target.Type.Frame)return;const t=e.target().model(n.ResourceTreeModel.ResourceTreeModel);t&&(t.addEventListener(n.ResourceTreeModel.Events.Load,this.loadEventFired,this),t.addEventListener(n.ResourceTreeModel.Events.DOMContentLoaded,this.domContentLoadedEventFired,this))}modelRemoved(e){if(e.target().parentTarget()?.type()!==n.Target.Type.Frame){const t=e.target().model(n.ResourceTreeModel.ResourceTreeModel);t&&(t.removeEventListener(n.ResourceTreeModel.Events.Load,this.loadEventFired,this),t.removeEventListener(n.ResourceTreeModel.Events.DOMContentLoaded,this.domContentLoadedEventFired,this))}}linkifier(){return this.linkifierInternal}setWindow(e,t){e||t?(this.timeFilter=$i.requestTimeFilter.bind(null,e,t),this.timeCalculatorInternal.setWindow(new Mt(e,t))):(this.timeFilter=null,this.timeCalculatorInternal.setWindow(null)),this.filterRequests()}resetFocus(){this.dataGrid.element.focus()}resetSuggestionBuilder(){this.suggestionBuilder.clear(),this.suggestionBuilder.addItem(p.UIFilter.FilterType.Is,p.UIFilter.IsFilterType.Running),this.suggestionBuilder.addItem(p.UIFilter.FilterType.Is,p.UIFilter.IsFilterType.FromCache),this.suggestionBuilder.addItem(p.UIFilter.FilterType.Is,p.UIFilter.IsFilterType.ServiceWorkerIntercepted),this.suggestionBuilder.addItem(p.UIFilter.FilterType.Is,p.UIFilter.IsFilterType.ServiceWorkerInitiated),this.suggestionBuilder.addItem(p.UIFilter.FilterType.LargerThan,"100"),this.suggestionBuilder.addItem(p.UIFilter.FilterType.LargerThan,"10k"),this.suggestionBuilder.addItem(p.UIFilter.FilterType.LargerThan,"1M"),this.textFilterUI.setSuggestionProvider(this.suggestionBuilder.completions.bind(this.suggestionBuilder))}filterChanged(){this.removeAllNodeHighlights(),this.parseFilterQuery(this.textFilterUI.value(),this.invertFilterUI.checked()),this.filterRequests(),this.textFilterSetting.set(this.textFilterUI.value())}async resetFilter(){this.textFilterUI.clear()}showRecordingHint(){this.hideRecordingHint(),this.recordingHint=this.element.createChild("div","network-status-pane fill");const e=this.recordingHint.createChild("div","recording-hint");if(this.recording){let t=null;const r=o.ShortcutRegistry.ShortcutRegistry.instance().shortcutsForAction("inspector_main.reload")[0];r&&(t=this.recordingHint.createChild("b"),t.textContent=r.title());e.createChild("span").textContent=Ki(_i.recordingNetworkActivity),t&&(e.createChild("br"),e.appendChild(i.i18n.getFormatLocalizedString(ji,_i.performARequestOrHitSToRecordThe,{PH1:t})))}else{const t=e.createChild("b");t.textContent=o.ShortcutRegistry.ShortcutRegistry.instance().shortcutTitleForAction("network.toggle-recording")||"",e.appendChild(i.i18n.getFormatLocalizedString(ji,_i.recordToDisplayNetworkActivity,{PH1:t}))}e.createChild("br"),e.appendChild(o.XLink.XLink.create("https://developer.chrome.com/docs/devtools/network/?utm_source=devtools&utm_campaign=2019Q1",Ki(_i.learnMore))),this.setHidden(!0)}hideRecordingHint(){this.setHidden(!1),this.recordingHint&&this.recordingHint.remove(),o.ARIAUtils.alert(Ki(_i.networkDataAvailable)),this.recordingHint=null}setHidden(e){this.columnsInternal.setHidden(e),o.ARIAUtils.setHidden(this.summaryToolbar.element,e)}elementsToRestoreScrollPositionsFor(){return this.dataGrid?[this.dataGrid.scrollContainer]:[]}columnExtensionResolved(){this.invalidateAllItems(!0)}setupDataGrid(){return this.dataGrid.setRowContextMenuCallback(((e,t)=>{const i=t.request();i&&this.handleContextMenuForRequest(e,i)})),this.dataGrid.setStickToBottom(!0),this.dataGrid.setName("networkLog"),this.dataGrid.setResizeMethod(a.DataGrid.ResizeMethod.Last),this.dataGrid.element.classList.add("network-log-grid"),this.dataGrid.element.addEventListener("mousedown",this.dataGridMouseDown.bind(this),!0),this.dataGrid.element.addEventListener("mousemove",this.dataGridMouseMove.bind(this),!0),this.dataGrid.element.addEventListener("mouseleave",(()=>this.setHoveredNode(null)),!0),this.dataGrid.element.addEventListener("keydown",(e=>{if("ArrowRight"===e.key&&this.dataGrid.selectedNode){const e=this.dataGrid.selectedNode.element().querySelector("span.devtools-link");e&&e.focus()}s.KeyboardUtilities.isEnterOrSpaceKey(e)&&(this.dispatchEventToListeners(me.RequestActivated,{showPanel:!0,takeFocus:!0}),e.consume(!0))})),this.dataGrid.element.addEventListener("keyup",(e=>{if(("r"===e.key||"R"===e.key)&&this.dataGrid.selectedNode){const e=this.dataGrid.selectedNode.request();if(!e)return;n.NetworkManager.NetworkManager.canReplayRequest(e)&&n.NetworkManager.NetworkManager.replayRequest(e)}})),this.dataGrid.element.addEventListener("focus",this.onDataGridFocus.bind(this),!0),this.dataGrid.element.addEventListener("blur",this.onDataGridBlur.bind(this),!0),this.dataGrid}dataGridMouseMove(e){const t=e,i=this.dataGrid.dataGridNodeFromNode(t.target),r=t.shiftKey;this.setHoveredNode(i,r)}hoveredNode(){return this.hoveredNodeInternal}setHoveredNode(e,t){this.hoveredNodeInternal&&this.hoveredNodeInternal.setHovered(!1,!1),this.hoveredNodeInternal=e,this.hoveredNodeInternal&&this.hoveredNodeInternal.setHovered(!0,Boolean(t))}dataGridMouseDown(e){const t=e;!this.dataGrid.selectedNode&&t.button&&t.consume()}updateSummaryBar(){this.hideRecordingHint();let t=0,r=0,a=0,l=0,d=0,c=-1,u=-1,p=0;for(const i of h.NetworkLog.NetworkLog.instance().requests()){const o=Yi.get(i);if(!o)continue;p++;const s=i.transferSize;t+=s;const h=i.resourceSize;r+=h,Ji.has(o)||(a++,l+=s,d+=h);const m=n.NetworkManager.NetworkManager.forRequest(i);m&&i.url()===m.target().inspectedURL()&&i.resourceType()===e.ResourceType.resourceTypes.Document&&!m.target().parentTarget()&&(c=i.startTime),i.endTime>u&&(u=i.endTime)}if(!p)return void this.showRecordingHint();this.summaryToolbar.removeToolbarItems();const m=(e,t)=>{const i=new o.Toolbar.ToolbarText(e);return i.setTitle(t||e),this.summaryToolbar.appendToolbarItem(i),i.element};if(a!==p?(m(Ki(_i.sSRequests,{PH1:a,PH2:p})),this.summaryToolbar.appendSeparator(),m(Ki(_i.sSTransferred,{PH1:s.NumberUtilities.bytesToString(l),PH2:s.NumberUtilities.bytesToString(t)}),Ki(_i.sBSBTransferredOverNetwork,{PH1:l,PH2:t})),this.summaryToolbar.appendSeparator(),m(Ki(_i.sSResources,{PH1:s.NumberUtilities.bytesToString(d),PH2:s.NumberUtilities.bytesToString(r)}),Ki(_i.sBSBResourcesLoadedByThePage,{PH1:d,PH2:r}))):(m(Ki(_i.sRequests,{PH1:p})),this.summaryToolbar.appendSeparator(),m(Ki(_i.sTransferred,{PH1:s.NumberUtilities.bytesToString(t)}),Ki(_i.sBTransferredOverNetwork,{PH1:t})),this.summaryToolbar.appendSeparator(),m(Ki(_i.sResources,{PH1:s.NumberUtilities.bytesToString(r)}),Ki(_i.sBResourcesLoadedByThePage,{PH1:r}))),-1!==c&&-1!==u){if(this.summaryToolbar.appendSeparator(),m(Ki(_i.finishS,{PH1:i.TimeUtilities.secondsToString(u-c)})),-1!==this.mainRequestDOMContentLoadedTime&&this.mainRequestDOMContentLoadedTime>c){this.summaryToolbar.appendSeparator();m(Ki(_i.domcontentloadedS,{PH1:i.TimeUtilities.secondsToString(this.mainRequestDOMContentLoadedTime-c)})).style.color=$i.getDCLEventColor()}if(-1!==this.mainRequestLoadTime){this.summaryToolbar.appendSeparator();m(Ki(_i.loadS,{PH1:i.TimeUtilities.secondsToString(this.mainRequestLoadTime-c)})).style.color=$i.getLoadEventColor()}}}scheduleRefresh(){this.needsRefresh||(this.needsRefresh=!0,this.isShowing()&&!this.refreshRequestId&&(this.refreshRequestId=this.element.window().requestAnimationFrame(this.refresh.bind(this))))}addFilmStripFrames(e){this.columnsInternal.addEventDividers(e,"network-frame-divider")}selectFilmStripFrame(e){this.columnsInternal.selectFilmStripFrame(e)}clearFilmStripFrame(){this.columnsInternal.clearFilmStripFrame()}refreshIfNeeded(){this.needsRefresh&&this.refresh()}invalidateAllItems(e){this.staleRequests=new Set(h.NetworkLog.NetworkLog.instance().requests()),e?this.scheduleRefresh():this.refresh()}timeCalculator(){return this.timeCalculatorInternal}calculator(){return this.calculatorInternal}setCalculator(e){e&&this.calculatorInternal!==e&&(this.calculatorInternal!==e&&(this.calculatorInternal=e,this.columnsInternal.setCalculator(this.calculatorInternal)),this.calculatorInternal.reset(),this.calculatorInternal.startAtZero?this.columnsInternal.hideEventDividers():this.columnsInternal.showEventDividers(),this.invalidateAllItems())}loadEventFired(e){if(!this.recording)return;const t=e.data.loadTime;t&&(this.mainRequestLoadTime=t,this.columnsInternal.addEventDividers([t],"network-load-divider"))}domContentLoadedEventFired(e){if(!this.recording)return;const{data:t}=e;t&&(this.mainRequestDOMContentLoadedTime=t,this.columnsInternal.addEventDividers([t],"network-dcl-divider"))}wasShown(){this.refreshIfNeeded(),this.registerCSSFiles([mi]),this.columnsInternal.wasShown()}willHide(){this.columnsInternal.willHide()}onResize(){this.rowHeightInternal=this.computeRowHeight()}flatNodesList(){return this.dataGrid.rootNode().flatChildren()}onDataGridFocus(){this.dataGrid.element.matches(":focus-visible")&&this.element.classList.add("grid-focused"),this.updateNodeBackground()}onDataGridBlur(){this.element.classList.remove("grid-focused"),this.updateNodeBackground()}updateNodeBackground(){this.dataGrid.selectedNode&&this.dataGrid.selectedNode.updateBackgroundColor()}updateNodeSelectedClass(e){e?this.element.classList.remove("no-node-selected"):this.element.classList.add("no-node-selected")}stylesChanged(){this.columnsInternal.scheduleRefresh()}refresh(){this.needsRefresh=!1,this.refreshRequestId&&(this.element.window().cancelAnimationFrame(this.refreshRequestId),this.refreshRequestId=null),this.removeAllNodeHighlights(),this.timeCalculatorInternal.updateBoundariesForEventTime(this.mainRequestLoadTime),this.durationCalculator.updateBoundariesForEventTime(this.mainRequestLoadTime),this.timeCalculatorInternal.updateBoundariesForEventTime(this.mainRequestDOMContentLoadedTime),this.durationCalculator.updateBoundariesForEventTime(this.mainRequestDOMContentLoadedTime);const e=new Map,t=[],i=new Set;for(;this.staleRequests.size;){const e=this.staleRequests.values().next().value;this.staleRequests.delete(e);let t=Yi.get(e);t||(t=this.createNodeForRequest(e)),i.add(t)}for(const r of i){const i=!this.applyFilter(r);i&&r===this.hoveredNodeInternal&&this.setHoveredNode(null),i||t.push(r);const o=r.request();this.timeCalculatorInternal.updateBoundaries(o),this.durationCalculator.updateBoundaries(o);const s=this.parentNodeForInsert(r);if(Ji.has(r)===i&&r.parent===s)continue;i?Ji.add(r):Ji.delete(r);if(r.parent&&(i||r.parent!==s)){let e=r.parent;if(!e)continue;for(e.removeChild(r);e&&!e.hasChildren()&&e.dataGrid&&e.dataGrid.rootNode()!==e;){const t=e.parent;t.removeChild(e),e=t}}s&&!i&&(s.dataGrid||e.has(s)||(e.set(s,this.dataGrid.rootNode()),t.push(s)),e.set(r,s))}for(const t of e.keys())e.get(t).appendChild(t);for(const e of t)e.refresh();this.updateSummaryBar(),e.size&&this.columnsInternal.sortByCurrentColumn(),this.dataGrid.updateInstantly(),this.didRefreshForTest()}didRefreshForTest(){}parentNodeForInsert(e){if(!this.activeGroupLookup)return this.dataGrid.rootNode();const t=this.activeGroupLookup.groupNodeForRequest(e.request());return t||this.dataGrid.rootNode()}reset(){this.dispatchEventToListeners(me.RequestActivated,{showPanel:!1}),this.setHoveredNode(null),this.columnsInternal.reset(),this.timeFilter=null,this.calculatorInternal.reset(),this.timeCalculatorInternal.setWindow(null),this.linkifierInternal.reset(),this.activeGroupLookup&&this.activeGroupLookup.reset(),this.staleRequests.clear(),this.resetSuggestionBuilder(),this.mainRequestLoadTime=-1,this.mainRequestDOMContentLoadedTime=-1,this.dataGrid.rootNode().removeChildren(),this.updateSummaryBar(),this.dataGrid.setStickToBottom(!0),this.scheduleRefresh()}setTextFilterValue(e){this.textFilterUI.setValue(e),this.dataURLFilterUI.setChecked(!1),this.onlyIssuesFilterUI.setChecked(!1),this.onlyBlockedRequestsUI.setChecked(!1),this.resourceCategoryFilterUI.reset()}createNodeForRequest(e){const t=new ve(this,e);Yi.set(e,t),Ji.add(t);for(let t=e.redirectSource();t;t=t.redirectSource())this.refreshRequest(t);return t}onRequestUpdated(e){const t=e.data;this.refreshRequest(t)}refreshRequest(e){$i.subdomains(e.domain).forEach(this.suggestionBuilder.addItem.bind(this.suggestionBuilder,p.UIFilter.FilterType.Domain)),this.suggestionBuilder.addItem(p.UIFilter.FilterType.Method,e.requestMethod),this.suggestionBuilder.addItem(p.UIFilter.FilterType.MimeType,e.mimeType),this.suggestionBuilder.addItem(p.UIFilter.FilterType.Scheme,String(e.scheme)),this.suggestionBuilder.addItem(p.UIFilter.FilterType.StatusCode,String(e.statusCode)),this.suggestionBuilder.addItem(p.UIFilter.FilterType.ResourceType,e.resourceType().name()),this.suggestionBuilder.addItem(p.UIFilter.FilterType.Url,e.securityOrigin());const t=e.priority();if(t&&this.suggestionBuilder.addItem(p.UIFilter.FilterType.Priority,m.NetworkPriorities.uiLabelForNetworkPriority(t)),"none"!==e.mixedContentType&&this.suggestionBuilder.addItem(p.UIFilter.FilterType.MixedContent,p.UIFilter.MixedContentFilterValues.All),"optionally-blockable"===e.mixedContentType&&this.suggestionBuilder.addItem(p.UIFilter.FilterType.MixedContent,p.UIFilter.MixedContentFilterValues.Displayed),"blockable"===e.mixedContentType){const t=e.wasBlocked()?p.UIFilter.MixedContentFilterValues.Blocked:p.UIFilter.MixedContentFilterValues.BlockOverridden;this.suggestionBuilder.addItem(p.UIFilter.FilterType.MixedContent,t)}const i=e.responseHeaders;for(const e of i)this.suggestionBuilder.addItem(p.UIFilter.FilterType.HasResponseHeader,e.name),"Set-Cookie"===e.name&&this.suggestionBuilder.addItem(p.UIFilter.FilterType.ResponseHeaderValueSetCookie);for(const t of e.responseCookies)this.suggestionBuilder.addItem(p.UIFilter.FilterType.SetCookieDomain,t.domain()),this.suggestionBuilder.addItem(p.UIFilter.FilterType.SetCookieName,t.name()),this.suggestionBuilder.addItem(p.UIFilter.FilterType.SetCookieValue,t.value());for(const t of e.allCookiesIncludingBlockedOnes())this.suggestionBuilder.addItem(p.UIFilter.FilterType.CookieDomain,t.domain()),this.suggestionBuilder.addItem(p.UIFilter.FilterType.CookieName,t.name()),this.suggestionBuilder.addItem(p.UIFilter.FilterType.CookiePath,t.path()),this.suggestionBuilder.addItem(p.UIFilter.FilterType.CookieValue,t.value());this.staleRequests.add(e),this.scheduleRefresh()}rowHeight(){return this.rowHeightInternal}switchViewMode(e){this.columnsInternal.switchViewMode(e)}handleContextMenuForRequest(e,i){e.appendApplicableItems(i);let r=e.clipboardSection().appendSubMenuItem(Ki(_i.copy));const a=r.footerSection();if(i){r.defaultSection().appendItem(o.UIUtils.copyLinkAddressLabel(),t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText.bind(t.InspectorFrontendHost.InspectorFrontendHostInstance,i.contentURL())),i.requestHeadersText()&&r.defaultSection().appendItem(Ki(_i.copyRequestHeaders),$i.copyRequestHeaders.bind(null,i)),i.responseHeadersText&&r.defaultSection().appendItem(Ki(_i.copyResponseHeaders),$i.copyResponseHeaders.bind(null,i)),i.finished&&r.defaultSection().appendItem(Ki(_i.copyResponse),$i.copyResponse.bind(null,i));const e=i.initiator();if(e){const i=e.stack;if(i){const e=Xi(i);""!==e&&r.defaultSection().appendItem(Ki(_i.copyStacktrace),(()=>{t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(e)}))}}const s=i.isBlobRequest();t.Platform.isWin()?(a.appendItem(Ki(_i.copyAsPowershell),this.copyPowerShellCommand.bind(this,i),s),a.appendItem(Ki(_i.copyAsFetch),this.copyFetchCall.bind(this,i,0),s),a.appendItem(Ki(_i.copyAsNodejsFetch),this.copyFetchCall.bind(this,i,1),s),a.appendItem(Ki(_i.copyAsCurlCmd),this.copyCurlCommand.bind(this,i,"win"),s),a.appendItem(Ki(_i.copyAsCurlBash),this.copyCurlCommand.bind(this,i,"unix"),s),a.appendItem(Ki(_i.copyAllAsPowershell),this.copyAllPowerShellCommand.bind(this)),a.appendItem(Ki(_i.copyAllAsFetch),this.copyAllFetchCall.bind(this,0)),a.appendItem(Ki(_i.copyAllAsNodejsFetch),this.copyAllFetchCall.bind(this,1)),a.appendItem(Ki(_i.copyAllAsCurlCmd),this.copyAllCurlCommand.bind(this,"win")),a.appendItem(Ki(_i.copyAllAsCurlBash),this.copyAllCurlCommand.bind(this,"unix"))):(a.appendItem(Ki(_i.copyAsPowershell),this.copyPowerShellCommand.bind(this,i),s),a.appendItem(Ki(_i.copyAsFetch),this.copyFetchCall.bind(this,i,0),s),a.appendItem(Ki(_i.copyAsNodejsFetch),this.copyFetchCall.bind(this,i,1),s),a.appendItem(Ki(_i.copyAsCurl),this.copyCurlCommand.bind(this,i,"unix"),s),a.appendItem(Ki(_i.copyAllAsPowershell),this.copyAllPowerShellCommand.bind(this)),a.appendItem(Ki(_i.copyAllAsFetch),this.copyAllFetchCall.bind(this,0)),a.appendItem(Ki(_i.copyAllAsNodejsFetch),this.copyAllFetchCall.bind(this,1)),a.appendItem(Ki(_i.copyAllAsCurl),this.copyAllCurlCommand.bind(this,"unix")))}else r=e.clipboardSection().appendSubMenuItem(Ki(_i.copy));if(a.appendItem(Ki(_i.copyAllAsHar),this.copyAll.bind(this)),e.saveSection().appendItem(Ki(_i.saveAllAsHarWithContent),this.exportAll.bind(this)),v.Runtime.experiments.isEnabled(v.Runtime.ExperimentName.HEADER_OVERRIDES)&&e.saveSection().appendItem(Ki(_i.overrideHeaders),this.#a.bind(this,i)),e.editSection().appendItem(Ki(_i.clearBrowserCache),this.clearBrowserCache.bind(this)),e.editSection().appendItem(Ki(_i.clearBrowserCookies),this.clearBrowserCookies.bind(this)),i){const t=20,r=n.NetworkManager.MultitargetNetworkManager.instance();let a=r.blockedPatterns();function l(e){a.push({enabled:!0,url:e}),r.setBlockedPatterns(a),r.setBlockingEnabled(!0),o.ViewManager.ViewManager.instance().showView("network.blocked-urls")}function d(e){a=a.filter((t=>t.url!==e)),r.setBlockedPatterns(a),o.ViewManager.ViewManager.instance().showView("network.blocked-urls")}const c=i.parsedURL.urlWithoutScheme();if(c&&!a.find((e=>e.url===c)))e.debugSection().appendItem(Ki(_i.blockRequestUrl),l.bind(null,c));else if(c){const i=s.StringUtilities.trimMiddle(c,t);e.debugSection().appendItem(Ki(_i.unblockS,{PH1:i}),d.bind(null,c))}const h=i.parsedURL.domain();if(h&&!a.find((e=>e.url===h)))e.debugSection().appendItem(Ki(_i.blockRequestDomain),l.bind(null,h));else if(h){const i=s.StringUtilities.trimMiddle(h,t);e.debugSection().appendItem(Ki(_i.unblockS,{PH1:i}),d.bind(null,h))}n.NetworkManager.NetworkManager.canReplayRequest(i)&&e.debugSection().appendItem(Ki(_i.replayXhr),n.NetworkManager.NetworkManager.replayRequest.bind(null,i))}}harRequests(){return h.NetworkLog.NetworkLog.instance().requests().filter($i.getHTTPRequestsFilter).filter((t=>t.finished||t.resourceType()===e.ResourceType.resourceTypes.WebSocket&&t.responseReceivedTime))}async copyAll(){const e={log:await L.Log.Log.build(this.harRequests())};t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(JSON.stringify(e,null,2))}async copyCurlCommand(e,i){const r=await $i.generateCurlCommand(e,i);t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(r)}async copyAllCurlCommand(e){const i=await this.generateAllCurlCommand(h.NetworkLog.NetworkLog.instance().requests(),e);t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(i)}async copyFetchCall(e,i){const r=await this.generateFetchCall(e,i);t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(r)}async copyAllFetchCall(e){const i=await this.generateAllFetchCall(h.NetworkLog.NetworkLog.instance().requests(),e);t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(i)}async copyPowerShellCommand(e){const i=await this.generatePowerShellCommand(e);t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(i)}async copyAllPowerShellCommand(){const e=await this.generateAllPowerShellCommand(h.NetworkLog.NetworkLog.instance().requests());t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(e)}async exportAll(){const t=n.TargetManager.TargetManager.instance().mainFrameTarget();if(!t)return;const i=t.inspectedURL(),r=e.ParsedURL.ParsedURL.fromString(i),s=r?r.host:"network-log",a=new c.FileUtils.FileOutputStream;if(!await a.open(e.ParsedURL.ParsedURL.concatenate(s,".har")))return;const l=new o.ProgressIndicator.ProgressIndicator;this.progressBarContainer.appendChild(l.element),await L.Writer.Writer.write(a,this.harRequests(),l),l.done(),a.close()}async#a(t){const i=p.UIRequestLocation.UIRequestLocation.responseHeaderMatch(t,{name:"",value:""}),r=C.NetworkPersistenceManager.NetworkPersistenceManager.instance();r.project()?(e.Settings.Settings.instance().moduleSetting("persistenceNetworkOverridesEnabled").set(!0),await r.getOrCreateHeadersUISourceCodeFromUrl(t.url()),await e.Revealer.reveal(i)):o.InspectorView.InspectorView.instance().displaySelectOverrideFolderInfobar((async()=>{await T.SourcesNavigator.OverridesNavigatorView.instance().setupNewWorkspace(),await r.getOrCreateHeadersUISourceCodeFromUrl(t.url()),await e.Revealer.reveal(i)}))}clearBrowserCache(){confirm(Ki(_i.areYouSureYouWantToClearBrowser))&&n.NetworkManager.MultitargetNetworkManager.instance().clearBrowserCache()}clearBrowserCookies(){confirm(Ki(_i.areYouSureYouWantToClearBrowserCookies))&&n.NetworkManager.MultitargetNetworkManager.instance().clearBrowserCookies()}removeAllHighlights(){this.removeAllNodeHighlights()}applyFilter(e){const t=e.request();if(this.timeFilter&&!this.timeFilter(t))return!1;const i=t.resourceType().category().title();if(!this.resourceCategoryFilterUI.accept(i))return!1;if(this.dataURLFilterUI.checked()&&(t.parsedURL.isDataURL()||t.parsedURL.isBlobURL()))return!1;if(this.onlyIssuesFilterUI.checked()&&!f.RelatedIssue.hasIssueOfCategory(t,f.Issue.IssueCategory.Cookie))return!1;if(this.onlyBlockedRequestsUI.checked()&&!t.wasBlocked()&&!t.corsErrorStatus())return!1;if(this.onlyThirdPartyFilterUI.checked()&&t.isSameSite())return!1;for(let e=0;e<this.filters.length;++e)if(!this.filters[e](t))return!1;return!0}isValidUrl(e){try{return new URL(e),!0}catch(e){return!1}}parseFilterQuery(e,t){const i=this.filterParser.parse(e);this.filters=i.map((e=>{const i=e.key,r=e.text||"",o=e.regex;let n;if(i){const e=s.StringUtilities.escapeForRegExp(i+":"+r);n=this.createSpecialFilter(i,r)||$i.requestPathFilter.bind(null,new RegExp(e,"i"))}else n=e.regex?$i.requestPathFilter.bind(null,o):this.isValidUrl(r)?$i.requestUrlFilter.bind(null,r):$i.requestPathFilter.bind(null,new RegExp(s.StringUtilities.escapeForRegExp(r),"i"));return e.negative&&!t||!e.negative&&t?$i.negativeFilter.bind(null,n):n}))}createSpecialFilter(e,t){switch(e){case p.UIFilter.FilterType.Domain:return $i.createRequestDomainFilter(t);case p.UIFilter.FilterType.HasResponseHeader:return $i.requestResponseHeaderFilter.bind(null,t);case p.UIFilter.FilterType.ResponseHeaderValueSetCookie:return $i.requestResponseHeaderSetCookieFilter.bind(null,t);case p.UIFilter.FilterType.Is:if(t.toLowerCase()===p.UIFilter.IsFilterType.Running)return $i.runningRequestFilter;if(t.toLowerCase()===p.UIFilter.IsFilterType.FromCache)return $i.fromCacheRequestFilter;if(t.toLowerCase()===p.UIFilter.IsFilterType.ServiceWorkerIntercepted)return $i.interceptedByServiceWorkerFilter;if(t.toLowerCase()===p.UIFilter.IsFilterType.ServiceWorkerInitiated)return $i.initiatedByServiceWorkerFilter;break;case p.UIFilter.FilterType.LargerThan:return this.createSizeFilter(t.toLowerCase());case p.UIFilter.FilterType.Method:return $i.requestMethodFilter.bind(null,t);case p.UIFilter.FilterType.MimeType:return $i.requestMimeTypeFilter.bind(null,t);case p.UIFilter.FilterType.MixedContent:return $i.requestMixedContentFilter.bind(null,t);case p.UIFilter.FilterType.Scheme:return $i.requestSchemeFilter.bind(null,t);case p.UIFilter.FilterType.SetCookieDomain:return $i.requestSetCookieDomainFilter.bind(null,t);case p.UIFilter.FilterType.SetCookieName:return $i.requestSetCookieNameFilter.bind(null,t);case p.UIFilter.FilterType.SetCookieValue:return $i.requestSetCookieValueFilter.bind(null,t);case p.UIFilter.FilterType.CookieDomain:return $i.requestCookieDomainFilter.bind(null,t);case p.UIFilter.FilterType.CookieName:return $i.requestCookieNameFilter.bind(null,t);case p.UIFilter.FilterType.CookiePath:return $i.requestCookiePathFilter.bind(null,t);case p.UIFilter.FilterType.CookieValue:return $i.requestCookieValueFilter.bind(null,t);case p.UIFilter.FilterType.Priority:return $i.requestPriorityFilter.bind(null,m.NetworkPriorities.uiLabelToNetworkPriority(t));case p.UIFilter.FilterType.StatusCode:return $i.statusCodeFilter.bind(null,t);case p.UIFilter.FilterType.ResourceType:return $i.resourceTypeFilter.bind(null,t);case p.UIFilter.FilterType.Url:return $i.requestUrlFilter.bind(null,t)}return null}createSizeFilter(e){let t=1;e.endsWith("k")?(t=1e3,e=e.substring(0,e.length-1)):e.endsWith("m")&&(t=1e6,e=e.substring(0,e.length-1));const i=Number(e);return isNaN(i)?null:$i.requestSizeLargerThanFilter.bind(null,i*t)}filterRequests(){this.removeAllHighlights(),this.invalidateAllItems()}reveal(e){this.removeAllNodeHighlights();const t=Yi.get(e);return t&&t.dataGrid?(t.parent&&t.parent instanceof be&&(t.parent.reveal(),t.parent.expand()),t.reveal(),t):null}revealAndHighlightRequest(e){const t=this.reveal(e);t&&this.highlightNode(t)}revealAndHighlightRequestWithId(e){const t=h.NetworkLog.NetworkLog.instance().requestByManagerAndId(e.manager,e.requestId);t&&this.revealAndHighlightRequest(t)}selectRequest(e,t){const{clearFilter:i}=t||{clearFilter:!0};i&&this.setTextFilterValue("");const r=this.reveal(e);r&&r.select()}removeAllNodeHighlights(){this.highlightedNode&&(this.highlightedNode.element().classList.remove("highlighted-row"),this.highlightedNode=null)}highlightNode(e){o.UIUtils.runCSSAnimationOnce(e.element(),"highlighted-row"),this.highlightedNode=e}filterOutBlobRequests(e){return e.filter((e=>!e.isBlobRequest()))}async generateFetchCall(e,t){const i=new Set(["method","path","scheme","version","accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via","user-agent"]),r=new Set(["cookie","authorization"]),o=JSON.stringify(e.url()),s=e.requestHeaders(),n=s.reduce(((e,t)=>{const r=t.name;return i.has(r.toLowerCase())||r.includes(":")||e.append(r,t.value),e}),new Headers),a={};for(const e of n)a[e[0]]=e[1];const l=e.includedRequestCookies().length||s.some((({name:e})=>r.has(e.toLowerCase())))?"include":"omit",d=s.find((({name:e})=>"referer"===e.toLowerCase())),c=d?d.value:void 0,h=e.referrerPolicy()||void 0,u=await e.requestFormData(),p={headers:Object.keys(a).length?a:void 0,referrer:c,referrerPolicy:h,body:u,method:e.requestMethod,mode:"cors"};if(1===t){const e=s.find((e=>"cookie"===e.name.toLowerCase())),t={};delete p.mode,e&&(t.cookie=e.value),c&&(delete p.referrer,t.Referer=c),c&&(delete p.referrerPolicy,t["Referrer-Policy"]=h),Object.keys(t).length&&(p.headers={...a,...t})}else p.credentials=l;return`fetch(${o}, ${JSON.stringify(p,null,2)});`}async generateAllFetchCall(e,t){const i=this.filterOutBlobRequests(e);return(await Promise.all(i.map((e=>this.generateFetchCall(e,t))))).join(" ;\n")}static async generateCurlCommand(e,t){let i=[];const r=new Set(["accept-encoding","host","method","path","scheme","version"]);const o="win"===t?function(e){const t=/[\r\n]/.test(e)?'^"':'"';return t+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/[^a-zA-Z0-9\s_\-:=+~'\/.',?;()*`&]/g,"^$&").replace(/%(?=[a-zA-Z0-9_])/g,"%^").replace(/\r?\n/g,"^\n\n")+t}:function(e){return/[\0-\x1F\x7F-\x9F!]|\'/.test(e)?"$'"+e.replace(/\\/g,"\\\\").replace(/\'/g,"\\'").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\0-\x1F\x7F-\x9F!]/g,(function(e){let t=e.charCodeAt(0).toString(16);for(;t.length<4;)t="0"+t;return"\\u"+t}))+"'":"'"+e+"'"};i.push(o(e.url()).replace(/[[{}\]]/g,"\\$&"));let s="GET";const n=[],a=await e.requestFormData();a&&(n.push("--data-raw "+o(a)),r.add("content-length"),s="POST"),e.requestMethod!==s&&i.push("-X "+o(e.requestMethod));const l=e.requestHeaders();for(let e=0;e<l.length;e++){const t=l[e],s=t.name.replace(/^:/,"");r.has(s.toLowerCase())||(t.value.trim()?i.push("-H "+o(s+": "+t.value)):i.push("-H "+o(s+";")))}return i=i.concat(n),i.push("--compressed"),"insecure"===e.securityState()&&i.push("--insecure"),"curl "+i.join(i.length>=3?"win"===t?" ^\n  ":" \\\n  ":" ")}async generateAllCurlCommand(e,t){const i=this.filterOutBlobRequests(e),r=await Promise.all(i.map((e=>$i.generateCurlCommand(e,t))));return"win"===t?r.join(" &\r\n"):r.join(" ;\n")}async generatePowerShellCommand(e){const t=[],i=new Set(["host","connection","proxy-connection","content-length","expect","range","content-type","user-agent","cookie"]);function r(e){return'"'+e.replace(/[`\$"]/g,"`$&").replace(/[^\x20-\x7E]/g,(e=>"$([char]"+e.charCodeAt(0)+")"))+'"'}t.push("-Uri "+r(e.url())),"GET"!==e.requestMethod&&t.push("-Method "+r(e.requestMethod));const o=function(e){const t=[],i=e.requestHeaders().find((({name:e})=>"user-agent"===e.toLowerCase()));i&&t.push(`$session.UserAgent = ${r(i.value)}`);for(const i of e.includedRequestCookies()){const e=r(i.name()),o=r(i.value()),s=r(i.domain());t.push(`$session.Cookies.Add((New-Object System.Net.Cookie(${e}, ${o}, "/", ${s})))`)}return t.length?"$session = New-Object Microsoft.PowerShell.Commands.WebRequestSession\n"+t.join("\n")+"\n":null}(e);o&&t.push("-WebSession $session");const s=e.requestHeaders(),n=[];for(const e of s){const t=e.name.replace(/^:/,"");i.has(t.toLowerCase())||n.push(r(t)+"="+r(e.value))}n.length&&t.push("-Headers @{\n"+n.join("\n  ")+"\n}");const a=s.find((({name:e})=>"content-type"===e.toLowerCase()));a&&t.push("-ContentType "+r(a.value));const l=await e.requestFormData();if(l){const e=r(l);/[^\x20-\x7E]/.test(l)?t.push("-Body ([System.Text.Encoding]::UTF8.GetBytes("+e+"))"):t.push("-Body "+e)}return(o||"")+"Invoke-WebRequest -UseBasicParsing "+t.join(t.length>=3?" `\n":" ")}async generateAllPowerShellCommand(e){const t=this.filterOutBlobRequests(e);return(await Promise.all(t.map((e=>this.generatePowerShellCommand(e))))).join(";\r\n")}static getDCLEventColor(){return H.ThemeSupport.instance().getComputedValue("--color-syntax-3")}static getLoadEventColor(){return H.ThemeSupport.instance().getComputedValue("--color-syntax-1")}}function Xi(e){let t="";for(const i of e.callFrames){t+=`${o.UIUtils.beautifyFunctionName(i.functionName)} @ ${i.url}:${i.lineNumber+1}\n`}return e.parent&&(t+=Xi(e.parent)),t}const Ji=new WeakSet,Yi=new WeakMap;const Qi={http:!0,https:!0,ws:!0,wss:!0},Zi=Object.values(p.UIFilter.FilterType);var er=Object.freeze({__proto__:null,NetworkLogView:$i,computeStackTraceText:Xi,isRequestFilteredOut:function(e){return Ji.has(e)},HTTPSchemas:Qi});const tr={url:"URL"},ir=i.i18n.registerUIStrings("panels/network/NetworkSearchScope.ts",tr),rr=i.i18n.getLocalizedString.bind(void 0,ir);class or{performIndexing(e){queueMicrotask((()=>{e.done()}))}async performSearch(e,t,i,r){const o=[],s=h.NetworkLog.NetworkLog.instance().requests().filter((t=>e.filePathMatchesFileQuery(t.url())));t.setTotalWork(s.length);for(const i of s){const r=this.searchRequest(e,i,t);o.push(r)}const n=(await Promise.all(o)).filter((e=>null!==e));if(t.isCanceled())r(!1);else{for(const e of n.sort(((e,t)=>e.label().localeCompare(t.label()))))e.matchesCount()>0&&i(e);t.done(),r(!0)}}async searchRequest(e,t,i){let r=[];if(t.contentType().isTextType()&&(r=await t.searchInContent(e.query(),!e.ignoreCase(),e.isRegex())),i.isCanceled())return null;const o=[];a(t.url())&&o.push(p.UIRequestLocation.UIRequestLocation.urlMatch(t));for(const e of t.requestHeaders())n(e)&&o.push(p.UIRequestLocation.UIRequestLocation.requestHeaderMatch(t,e));for(const e of t.responseHeaders)n(e)&&o.push(p.UIRequestLocation.UIRequestLocation.responseHeaderMatch(t,e));for(const e of r)o.push(p.UIRequestLocation.UIRequestLocation.bodyMatch(t,e));return i.incrementWorked(),new sr(t,o);function n(e){return a(`${e.name}: ${e.value}`)}function a(t){const i=e.ignoreCase()?"i":"",r=e.queries().map((e=>new RegExp(s.StringUtilities.escapeForRegExp(e),i)));let o=0;for(const e of r){const i=t.substr(o).match(e);if(!i||void 0===i.index)return!1;o+=i.index+i[0].length}return!0}}stopSearch(){}}class sr{request;locations;constructor(e,t){this.request=e,this.locations=t}matchesCount(){return this.locations.length}label(){return this.request.displayName}description(){const e=this.request.parsedURL;return e?e.urlWithoutScheme():this.request.url()}matchLineContent(e){const t=this.locations[e];if(t.isUrlMatch)return this.request.url();const i=t?.header?.header;return i?i.value:t.searchMatch.lineContent}matchRevealable(e){return this.locations[e]}matchLabel(e){const t=this.locations[e];if(t.isUrlMatch)return rr(tr.url);const i=t?.header?.header;return i?`${i.name}:`:t.searchMatch.lineNumber+1}}var nr=Object.freeze({__proto__:null,NetworkSearchScope:or,NetworkSearchResult:sr});const ar=new CSSStyleSheet;ar.replaceSync(":root{--override-network-overview-total:#919191;--override-network-overview-blocking:#858585;--override-network-overview-connecting:#d68100;--override-network-overview-service-worker:#d68100;--override-network-overview-service-worker-respond-with:#00a3a3;--override-network-overview-push:#0099e0;--override-network-overview-proxy:#a1887f;--override-network-overview-dns:#009688;--override-network-overview-ssl:#b52dcd;--override-network-overview-sending:#74979a;--override-network-overview-waiting:#00a846;--override-network-overview-receiving:#0299de;--override-network-overview-queueing:#fff;--network-grid-default-color:rgb(255 255 255/100%);--network-grid-stripe-color:rgb(245 245 245/100%);--network-grid-navigation-color:rgb(221 238 255/100%);--network-grid-hovered-color:rgb(235 242 252/70%);--network-grid-initiator-path-color:rgb(58 217 58/40%);--network-grid-initiated-path-color:rgb(217 58 58/40%);--network-grid-selected-color:#dadce0;--network-grid-focus-selected-color:var(--legacy-selection-bg-color);--network-grid-focus-selected-color-has-error:#fad2cf;--network-grid-from-frame-color:rgb(224 247 250/40%);--network-grid-is-product-color:rgb(255 252 225/60%);--network-frame-divider-color:#fccc49}.-theme-with-dark-background{--network-grid-default-color:rgb(36 36 36/100%);--network-grid-stripe-color:rgb(41 41 41/100%);--network-grid-navigation-color:rgb(221 238 255/100%);--network-grid-hovered-color:rgb(20 37 63/70%);--network-grid-initiator-path-color:rgb(58 217 58/40%);--network-grid-initiated-path-color:rgb(217 58 58/40%);--network-grid-selected-color:#454545;--network-grid-focus-selected-color:var(--legacy-selection-bg-color);--network-grid-focus-selected-color-has-error:#482422;--network-grid-from-frame-color:rgb(224 247 250/40%);--network-grid-is-product-color:rgb(255 252 225/60%)}.network-details-view{background:rgb(203 203 203)}.network-details-view-tall-header{border-top:4px solid var(--color-background-elevation-1)}.network-item-view{display:flex;background:var(--color-background)}.network-item-preview-toolbar{border-top:1px solid var(--color-details-hairline);background-color:var(--color-background-elevation-1)}.resource-timing-view{display:block;margin:6px;color:var(--color-text-primary);overflow:auto;background-color:var(--color-background)}.resource-timing-table{width:100%!important}#network-overview-panel{flex:none;position:relative}#network-overview-container{overflow:hidden;flex:auto;display:flex;flex-direction:column;position:relative;border-bottom:1px solid var(--color-details-hairline)}#network-overview-container canvas{width:100%;height:100%}.resources-dividers-label-bar{background-color:var(--color-background)}#network-overview-grid .resources-dividers-label-bar{pointer-events:auto}.network .network-overview{flex:0 0 60px}.network-overview .resources-dividers-label-bar .resources-divider{background-color:transparent}.network-overview .resources-dividers{z-index:250}.request-view.html iframe{width:100%;height:100%;position:absolute}.network-film-strip{border-bottom:solid 1px var(--color-details-hairline);flex:none!important}.network-film-strip-placeholder{flex-shrink:0}.network-tabbed-pane{background-color:var(--color-background-elevation-1)}.network-settings-pane{flex:none;background-color:var(--color-background-elevation-1)}.network-settings-pane .toolbar{flex:1 1}.network-toolbar-container{display:flex;flex:none}.network-toolbar-container > :first-child{flex:1 1 auto}.panel.network .toolbar{background-color:var(--color-background-elevation-1);border-bottom:var(--legacy-divider-border)}@media (forced-colors: active){.panel.network .toolbar{background-color:canvas}}\n/*# sourceURL=networkPanel.css */\n");const lr={close:"Close",search:"Search",clear:"Clear",doNotClearLogOnPageReload:"Do not clear log on page reload / navigation",preserveLog:"Preserve log",disableCacheWhileDevtoolsIsOpen:"Disable cache (while DevTools is open)",disableCache:"Disable cache",networkSettings:"Network settings",showMoreInformationInRequestRows:"Show more information in request rows",useLargeRequestRows:"Use large request rows",showOverviewOfNetworkRequests:"Show overview of network requests",showOverview:"Show overview",groupRequestsByTopLevelRequest:"Group requests by top level request frame",groupByFrame:"Group by frame",captureScreenshotsWhenLoadingA:"Capture screenshots when loading a page",captureScreenshots:"Capture screenshots",importHarFile:"Import `HAR` file...",exportHar:"Export `HAR`...",throttling:"Throttling",hitSToReloadAndCaptureFilmstrip:"Hit {PH1} to reload and capture filmstrip.",revealInNetworkPanel:"Reveal in Network panel",recordingFrames:"Recording frames...",fetchingFrames:"Fetching frames...",moreNetworkConditions:"More network conditions…"},dr=i.i18n.registerUIStrings("panels/network/NetworkPanel.ts",lr),cr=i.i18n.getLocalizedString.bind(void 0,dr);let hr;class ur extends o.Panel.Panel{networkLogShowOverviewSetting;networkLogLargeRowsSetting;networkRecordFilmStripSetting;toggleRecordAction;pendingStopTimer;networkItemView;filmStripView;filmStripRecorder;currentRequest;panelToolbar;rightToolbar;filterBar;settingsPane;showSettingsPaneSetting;filmStripPlaceholderElement;overviewPane;networkOverview;overviewPlaceholderElement;calculator;splitWidget;sidebarLocation;progressBarContainer;networkLogView;fileSelectorElement;detailsWidget;closeButtonElement;preserveLogSetting;recordLogSetting;throttlingSelect;constructor(){super("network"),this.networkLogShowOverviewSetting=e.Settings.Settings.instance().createSetting("networkLogShowOverview",!0),this.networkLogLargeRowsSetting=e.Settings.Settings.instance().createSetting("networkLogLargeRows",!1),this.networkRecordFilmStripSetting=e.Settings.Settings.instance().createSetting("networkRecordFilmStripSetting",!1),this.toggleRecordAction=o.ActionRegistry.ActionRegistry.instance().action("network.toggle-recording"),this.networkItemView=null,this.filmStripView=null,this.filmStripRecorder=null,this.currentRequest=null;const t=new o.Widget.VBox,i=t.contentElement.createChild("div","network-toolbar-container");this.panelToolbar=new o.Toolbar.Toolbar("",i),this.panelToolbar.makeWrappable(!0),this.rightToolbar=new o.Toolbar.Toolbar("",i),this.filterBar=new o.FilterBar.FilterBar("networkPanel",!0),this.filterBar.show(t.contentElement),this.filterBar.addEventListener("Changed",this.handleFilterChanged.bind(this)),this.settingsPane=new o.Widget.HBox,this.settingsPane.element.classList.add("network-settings-pane"),this.settingsPane.show(t.contentElement),this.showSettingsPaneSetting=e.Settings.Settings.instance().createSetting("networkShowSettingsToolbar",!1),this.showSettingsPaneSetting.addChangeListener(this.updateSettingsPaneVisibility.bind(this)),this.updateSettingsPaneVisibility(),this.filmStripPlaceholderElement=t.contentElement.createChild("div","network-film-strip-placeholder"),this.overviewPane=new m.TimelineOverviewPane.TimelineOverviewPane("network"),this.overviewPane.addEventListener(m.TimelineOverviewPane.Events.WindowChanged,this.onWindowChanged.bind(this)),this.overviewPane.element.id="network-overview-panel",this.networkOverview=new Ri,this.overviewPane.setOverviewControls([this.networkOverview]),this.overviewPlaceholderElement=t.contentElement.createChild("div"),this.calculator=new Bt,this.splitWidget=new o.SplitWidget.SplitWidget(!0,!1,"networkPanelSplitViewState"),this.splitWidget.hideMain(),this.splitWidget.show(t.contentElement),t.setDefaultFocusedChild(this.filterBar);const r=new o.SplitWidget.SplitWidget(!0,!1,"networkPanelSidebarState",225);r.hideSidebar(),r.enableShowModeSaving(),r.show(this.element),this.sidebarLocation=o.ViewManager.ViewManager.instance().createTabbedLocation((async()=>{o.ViewManager.ViewManager.instance().showView("network"),r.showBoth()}),"network-sidebar",!0);const a=this.sidebarLocation.tabbedPane();a.setMinimumSize(100,25),a.element.classList.add("network-tabbed-pane"),a.element.addEventListener("keydown",(e=>{e.key===s.KeyboardUtilities.ESCAPE_KEY&&(r.hideSidebar(),e.consume())}));const l=new o.Toolbar.ToolbarButton(cr(lr.close),"largeicon-delete");l.addEventListener(o.Toolbar.ToolbarButton.Events.Click,(()=>r.hideSidebar())),a.rightToolbar().appendToolbarItem(l),r.setSidebarWidget(a),r.setMainWidget(t),r.setDefaultFocusedChild(t),this.setDefaultFocusedChild(r),this.progressBarContainer=document.createElement("div"),this.networkLogView=new $i(this.filterBar,this.progressBarContainer,this.networkLogLargeRowsSetting),this.splitWidget.setSidebarWidget(this.networkLogView),this.fileSelectorElement=o.UIUtils.createFileSelectorElement(this.networkLogView.onLoadFromFile.bind(this.networkLogView)),t.element.appendChild(this.fileSelectorElement),this.detailsWidget=new o.Widget.VBox,this.detailsWidget.element.classList.add("network-details-view"),this.splitWidget.setMainWidget(this.detailsWidget),this.closeButtonElement=document.createElement("div",{is:"dt-close-button"}),this.closeButtonElement.addEventListener("click",(async()=>{const e=o.ActionRegistry.ActionRegistry.instance().action("network.hide-request-details");e&&await e.execute()}),!1),this.closeButtonElement.style.margin="0 5px",this.networkLogShowOverviewSetting.addChangeListener(this.toggleShowOverview,this),this.networkLogLargeRowsSetting.addChangeListener(this.toggleLargerRequests,this),this.networkRecordFilmStripSetting.addChangeListener(this.toggleRecordFilmStrip,this),this.preserveLogSetting=e.Settings.Settings.instance().moduleSetting("network_log.preserve-log"),this.recordLogSetting=e.Settings.Settings.instance().moduleSetting("network_log.record-log"),this.recordLogSetting.addChangeListener((({data:e})=>this.toggleRecord(e))),this.throttlingSelect=this.createThrottlingConditionsSelect(),this.setupToolbarButtons(r),this.toggleRecord(this.recordLogSetting.get()),this.toggleShowOverview(),this.toggleLargerRequests(),this.toggleRecordFilmStrip(),this.updateUI(),n.TargetManager.TargetManager.instance().addModelListener(n.ResourceTreeModel.ResourceTreeModel,n.ResourceTreeModel.Events.WillReloadPage,this.willReloadPage,this),n.TargetManager.TargetManager.instance().addModelListener(n.ResourceTreeModel.ResourceTreeModel,n.ResourceTreeModel.Events.Load,this.load,this),this.networkLogView.addEventListener(me.RequestSelected,this.onRequestSelected,this),this.networkLogView.addEventListener(me.RequestActivated,this.onRequestActivated,this),h.NetworkLog.NetworkLog.instance().addEventListener(h.NetworkLog.Events.RequestAdded,this.onUpdateRequest,this),h.NetworkLog.NetworkLog.instance().addEventListener(h.NetworkLog.Events.RequestUpdated,this.onUpdateRequest,this),h.NetworkLog.NetworkLog.instance().addEventListener(h.NetworkLog.Events.Reset,this.onNetworkLogReset,this)}static instance(e={forceNew:null}){const{forceNew:t}=e;return hr&&!t||(hr=new ur),hr}static revealAndFilter(e){const t=ur.instance();let i="";for(const t of e)t.filterType?i+=`${t.filterType}:${t.filterValue} `:i+=`${t.filterValue} `;return t.networkLogView.setTextFilterValue(i),o.ViewManager.ViewManager.instance().showView("network")}static async selectAndShowRequest(e,t,i){const r=ur.instance();await r.selectAndActivateRequest(e,t,i)}throttlingSelectForTest(){return this.throttlingSelect}onWindowChanged(e){const t=Math.max(this.calculator.minimumBoundary(),e.data.startTime/1e3),i=Math.min(this.calculator.maximumBoundary(),e.data.endTime/1e3);this.networkLogView.setWindow(t,i)}async searchToggleClick(){const e=o.ActionRegistry.ActionRegistry.instance().action("network.search");e&&await e.execute()}setupToolbarButtons(t){const i=new o.Toolbar.ToolbarToggle(cr(lr.search),"largeicon-search");function r(){const e=t.showMode()!==o.SplitWidget.ShowMode.OnlyMain;i.setToggled(e),e||i.element.focus()}this.panelToolbar.appendToolbarItem(o.Toolbar.Toolbar.createActionButton(this.toggleRecordAction));const s=new o.Toolbar.ToolbarButton(cr(lr.clear),"largeicon-clear");s.addEventListener(o.Toolbar.ToolbarButton.Events.Click,(()=>h.NetworkLog.NetworkLog.instance().reset(!0)),this),this.panelToolbar.appendToolbarItem(s),this.panelToolbar.appendSeparator(),this.panelToolbar.appendToolbarItem(this.filterBar.filterButton()),r(),t.addEventListener(o.SplitWidget.Events.ShowModeChanged,r),i.addEventListener(o.Toolbar.ToolbarButton.Events.Click,(()=>{this.searchToggleClick()})),this.panelToolbar.appendToolbarItem(i),this.panelToolbar.appendSeparator(),this.panelToolbar.appendToolbarItem(new o.Toolbar.ToolbarSettingCheckbox(this.preserveLogSetting,cr(lr.doNotClearLogOnPageReload),cr(lr.preserveLog))),this.panelToolbar.appendSeparator();const n=new o.Toolbar.ToolbarSettingCheckbox(e.Settings.Settings.instance().moduleSetting("cacheDisabled"),cr(lr.disableCacheWhileDevtoolsIsOpen),cr(lr.disableCache));this.panelToolbar.appendToolbarItem(n),this.panelToolbar.appendToolbarItem(this.throttlingSelect);const a=new q.Icon.Icon;a.data={iconName:"network_conditions_icon",color:"rgb(110 110 110)",width:"18px",height:"18px"};const l=new o.Toolbar.ToolbarButton(cr(lr.moreNetworkConditions),a);l.addEventListener(o.Toolbar.ToolbarButton.Events.Click,(()=>{o.ViewManager.ViewManager.instance().showView("network.config")}),this),this.panelToolbar.appendToolbarItem(l),this.rightToolbar.appendToolbarItem(new o.Toolbar.ToolbarItem(this.progressBarContainer)),this.rightToolbar.appendSeparator(),this.rightToolbar.appendToolbarItem(new o.Toolbar.ToolbarSettingToggle(this.showSettingsPaneSetting,"largeicon-settings-gear",cr(lr.networkSettings)));const d=new o.Toolbar.Toolbar("",this.settingsPane.element);d.makeVertical(),d.appendToolbarItem(new o.Toolbar.ToolbarSettingCheckbox(this.networkLogLargeRowsSetting,cr(lr.showMoreInformationInRequestRows),cr(lr.useLargeRequestRows))),d.appendToolbarItem(new o.Toolbar.ToolbarSettingCheckbox(this.networkLogShowOverviewSetting,cr(lr.showOverviewOfNetworkRequests),cr(lr.showOverview)));const c=new o.Toolbar.Toolbar("",this.settingsPane.element);c.makeVertical(),c.appendToolbarItem(new o.Toolbar.ToolbarSettingCheckbox(e.Settings.Settings.instance().moduleSetting("network.group-by-frame"),cr(lr.groupRequestsByTopLevelRequest),cr(lr.groupByFrame))),c.appendToolbarItem(new o.Toolbar.ToolbarSettingCheckbox(this.networkRecordFilmStripSetting,cr(lr.captureScreenshotsWhenLoadingA),cr(lr.captureScreenshots))),this.panelToolbar.appendSeparator();const u=new o.Toolbar.ToolbarButton(cr(lr.importHarFile),"largeicon-load");u.addEventListener(o.Toolbar.ToolbarButton.Events.Click,(()=>this.fileSelectorElement.click()),this),this.panelToolbar.appendToolbarItem(u);const p=new o.Toolbar.ToolbarButton(cr(lr.exportHar),"largeicon-download");p.addEventListener(o.Toolbar.ToolbarButton.Events.Click,(e=>{this.networkLogView.exportAll()}),this),this.panelToolbar.appendToolbarItem(p)}updateSettingsPaneVisibility(){this.settingsPane.element.classList.toggle("hidden",!this.showSettingsPaneSetting.get())}createThrottlingConditionsSelect(){const e=new o.Toolbar.ToolbarComboBox(null,cr(lr.throttling));return e.setMaxWidth(160),l.ThrottlingManager.throttlingManager().decorateSelectWithNetworkThrottling(e.selectElement()),e}toggleRecord(e){this.toggleRecordAction.setToggled(e),this.recordLogSetting.get()!==e&&this.recordLogSetting.set(e),this.networkLogView.setRecording(e),!e&&this.filmStripRecorder&&this.filmStripRecorder.stopRecording(this.filmStripAvailable.bind(this))}filmStripAvailable(e){if(!e)return;const t=this.networkLogView.timeCalculator();this.filmStripView&&this.filmStripView.setModel(e,1e3*t.minimumBoundary(),1e3*t.boundarySpan()),this.networkOverview.setFilmStripModel(e);const i=e.frames().map((function(e){return e.timestamp/1e3}));this.networkLogView.addFilmStripFrames(i)}onNetworkLogReset(e){const{clearIfPreserved:t}=e.data;_.reset(),this.preserveLogSetting.get()&&!t||(this.calculator.reset(),this.overviewPane.reset()),this.filmStripView&&this.resetFilmStripView()}willReloadPage(){this.pendingStopTimer&&(clearTimeout(this.pendingStopTimer),delete this.pendingStopTimer),this.isShowing()&&this.filmStripRecorder&&this.filmStripRecorder.startRecording()}load(){this.filmStripRecorder&&this.filmStripRecorder.isRecording()&&(this.pendingStopTimer=window.setTimeout(this.stopFilmStripRecording.bind(this),pr))}stopFilmStripRecording(){this.filmStripRecorder&&this.filmStripRecorder.stopRecording(this.filmStripAvailable.bind(this)),delete this.pendingStopTimer}toggleLargerRequests(){this.updateUI()}toggleShowOverview(){this.networkLogShowOverviewSetting.get()?this.overviewPane.show(this.overviewPlaceholderElement):this.overviewPane.detach(),this.doResize()}toggleRecordFilmStrip(){const e=this.networkRecordFilmStripSetting.get();e&&!this.filmStripRecorder&&(this.filmStripView=new m.FilmStripView.FilmStripView,this.filmStripView.setMode(m.FilmStripView.Modes.FrameBased),this.filmStripView.element.classList.add("network-film-strip"),this.filmStripRecorder=new Rr(this.networkLogView.timeCalculator(),this.filmStripView),this.filmStripView.show(this.filmStripPlaceholderElement),this.filmStripView.addEventListener(m.FilmStripView.Events.FrameSelected,this.onFilmFrameSelected,this),this.filmStripView.addEventListener(m.FilmStripView.Events.FrameEnter,this.onFilmFrameEnter,this),this.filmStripView.addEventListener(m.FilmStripView.Events.FrameExit,this.onFilmFrameExit,this),this.resetFilmStripView()),!e&&this.filmStripRecorder&&(this.filmStripView&&this.filmStripView.detach(),this.filmStripView=null,this.filmStripRecorder=null)}resetFilmStripView(){const e=o.ShortcutRegistry.ShortcutRegistry.instance().shortcutsForAction("inspector_main.reload")[0];this.filmStripView&&(this.filmStripView.reset(),e&&this.filmStripView.setStatusText(cr(lr.hitSToReloadAndCaptureFilmstrip,{PH1:e.title()})))}elementsToRestoreScrollPositionsFor(){return this.networkLogView.elementsToRestoreScrollPositionsFor()}wasShown(){o.Context.Context.instance().setFlavor(ur,this),this.registerCSSFiles([ar]),t.userMetrics.panelLoaded("network","DevTools.Launch.Network")}willHide(){o.Context.Context.instance().setFlavor(ur,null)}revealAndHighlightRequest(e){this.hideRequestPanel(),e&&this.networkLogView.revealAndHighlightRequest(e)}revealAndHighlightRequestWithId(e){this.hideRequestPanel(),e&&this.networkLogView.revealAndHighlightRequestWithId(e)}async selectAndActivateRequest(e,t,i){return await o.ViewManager.ViewManager.instance().showView("network"),this.networkLogView.selectRequest(e,i),this.showRequestPanel(t),this.networkItemView}handleFilterChanged(){this.hideRequestPanel()}onRowSizeChanged(){this.updateUI()}onRequestSelected(e){const t=e.data;this.currentRequest=t,this.networkOverview.setHighlightedRequest(t),this.updateNetworkItemView()}onRequestActivated(e){const{showPanel:t,tab:i,takeFocus:r}=e.data;t?this.showRequestPanel(i,r):this.hideRequestPanel()}showRequestPanel(e,t){if(this.splitWidget.showMode()!==o.SplitWidget.ShowMode.Both||e||t){if(this.clearNetworkItemView(),this.currentRequest){const i=this.createNetworkItemView(e);i&&t&&i.focus()}this.updateUI()}}hideRequestPanel(){this.clearNetworkItemView(),this.splitWidget.hideMain(),this.updateUI()}updateNetworkItemView(){this.splitWidget.showMode()===o.SplitWidget.ShowMode.Both&&(this.clearNetworkItemView(),this.createNetworkItemView(),this.updateUI())}clearNetworkItemView(){this.networkItemView&&(this.networkItemView.detach(),this.networkItemView=null)}createNetworkItemView(e){if(this.currentRequest)return this.networkItemView=new ui(this.currentRequest,this.networkLogView.timeCalculator(),e),this.networkItemView.leftToolbar().appendToolbarItem(new o.Toolbar.ToolbarItem(this.closeButtonElement)),this.networkItemView.show(this.detailsWidget.element),this.splitWidget.showBoth(),this.networkItemView}updateUI(){this.detailsWidget&&this.detailsWidget.element.classList.toggle("network-details-view-tall-header",this.networkLogLargeRowsSetting.get()),this.networkLogView&&this.networkLogView.switchViewMode(!this.splitWidget.isResizable())}appendApplicableItems(e,t,i){function r(e){o.ViewManager.ViewManager.instance().showView("network").then(this.networkLogView.resetFilter.bind(this.networkLogView)).then(this.revealAndHighlightRequest.bind(this,e))}function s(e){t.revealSection().appendItem(cr(lr.revealInNetworkPanel),r.bind(this,e))}if(e.target.isSelfOrDescendant(this.element))return;if(i instanceof n.Resource.Resource){const e=i;return void(e.request&&s.call(this,e.request))}if(i instanceof u.UISourceCode.UISourceCode){const e=i,t=c.ResourceUtils.resourceForURL(e.url());return void(t&&t.request&&s.call(this,t.request))}if(!(i instanceof n.NetworkRequest.NetworkRequest))return;const a=i;this.networkItemView&&this.networkItemView.isShowing()&&this.networkItemView.request()===a||s.call(this,a)}onFilmFrameSelected(e){const t=e.data;this.overviewPane.setWindowTimes(0,t)}onFilmFrameEnter(e){const t=e.data;this.networkOverview.selectFilmStripFrame(t),this.networkLogView.selectFilmStripFrame(t/1e3)}onFilmFrameExit(){this.networkOverview.clearFilmStripFrame(),this.networkLogView.clearFilmStripFrame()}onUpdateRequest(e){const t=e.data;this.calculator.updateBoundaries(t),this.overviewPane.setBounds(1e3*this.calculator.minimumBoundary(),1e3*this.calculator.maximumBoundary()),this.networkOverview.updateRequest(t),this.overviewPane.scheduleUpdate()}resolveLocation(e){return"network-sidebar"===e?this.sidebarLocation:null}}const pr=1e3;let mr,gr,wr,vr,br,kr,fr;class Cr{static instance(e={forceNew:null}){const{forceNew:t}=e;return mr&&!t||(mr=new Cr),mr}appendApplicableItems(e,t,i){ur.instance().appendApplicableItems(e,t,i)}}class Sr{static instance(e={forceNew:null}){const{forceNew:t}=e;return gr&&!t||(gr=new Sr),gr}reveal(e){if(!(e instanceof n.NetworkRequest.NetworkRequest))return Promise.reject(new Error("Internal error: not a network request"));const t=ur.instance();return o.ViewManager.ViewManager.instance().showView("network").then(t.revealAndHighlightRequest.bind(t,e))}}class Tr{static instance(e={forceNew:null}){const{forceNew:t}=e;return wr&&!t||(wr=new Tr),wr}reveal(e){if(!(e instanceof p.NetworkRequestId.NetworkRequestId))return Promise.reject(new Error("Internal error: not a network request ID"));const t=ur.instance();return o.ViewManager.ViewManager.instance().showView("network").then(t.revealAndHighlightRequestWithId.bind(t,e))}}class yr{static instance(e={forceNew:null}){const{forceNew:t}=e;return vr&&!t||(vr=new yr),vr}reveal(e){return e instanceof p.UIFilter.UIRequestFilter?ur.revealAndFilter(e.filters):Promise.reject(new Error("Internal error: not a UIRequestFilter"))}}class Rr{tracingManager;resourceTreeModel;timeCalculator;filmStripView;tracingModel;callback;constructor(e,t){this.tracingManager=null,this.resourceTreeModel=null,this.timeCalculator=e,this.filmStripView=t,this.tracingModel=null,this.callback=null}traceEventsCollected(e){this.tracingModel&&this.tracingModel.addEvents(e)}tracingComplete(){this.tracingModel&&this.tracingManager&&(this.tracingModel.tracingComplete(),this.tracingManager=null,this.callback&&this.callback(new n.FilmStripModel.FilmStripModel(this.tracingModel,1e3*this.timeCalculator.minimumBoundary())),this.callback=null,this.resourceTreeModel&&this.resourceTreeModel.resumeReload(),this.resourceTreeModel=null)}tracingBufferUsage(){}eventsRetrievalProgress(e){}startRecording(){this.filmStripView.reset(),this.filmStripView.setStatusText(cr(lr.recordingFrames));const e=n.TargetManager.TargetManager.instance().models(n.TracingManager.TracingManager);!this.tracingManager&&e.length&&(this.tracingManager=e[0],this.tracingManager&&(this.resourceTreeModel=this.tracingManager.target().model(n.ResourceTreeModel.ResourceTreeModel),this.tracingModel&&this.tracingModel.dispose(),this.tracingModel=new n.TracingModel.TracingModel(new c.TempFile.TempFileBackingStorage),this.tracingManager.start(this,"-*,disabled-by-default-devtools.screenshot",""),t.userMetrics.actionTaken(t.UserMetrics.Action.FilmStripStartedRecording)))}isRecording(){return Boolean(this.tracingManager)}stopRecording(e){this.tracingManager&&(this.tracingManager.stop(),this.resourceTreeModel&&this.resourceTreeModel.suspendReload(),this.callback=e,this.filmStripView.setStatusText(cr(lr.fetchingFrames)))}}class Ir{static instance(e={forceNew:null}){const{forceNew:t}=e;return br&&!t||(br=new Ir),br}handleAction(e,t){const i=o.Context.Context.instance().flavor(ur);if(console.assert(Boolean(i&&i instanceof ur)),!i)return!1;switch(t){case"network.toggle-recording":return i.toggleRecord(!i.recordLogSetting.get()),!0;case"network.hide-request-details":return!!i.networkItemView&&(i.hideRequestPanel(),i.networkLogView.resetFocus(),!0);case"network.search":{const e=o.InspectorView.InspectorView.instance().element.window().getSelection();if(e){let t="";return e.rangeCount&&(t=e.toString().replace(/\r?\n.*/,"")),qr.openSearch(t),!0}}}return!1}}class xr{static instance(e={forceNew:null}){const{forceNew:t}=e;return kr&&!t||(kr=new xr),kr}async reveal(e){const t=e,i=await ur.instance().selectAndActivateRequest(t.request,t.tab,t.filterOptions);i&&(t.searchMatch&&await i.revealResponseBody(t.searchMatch.lineNumber),t.header&&i.revealHeader(t.header.section,t.header.header?.name))}}class qr extends P.SearchView.SearchView{constructor(){super("network")}static instance(e={forceNew:null}){const{forceNew:t}=e;return fr&&!t||(fr=new qr),fr}static async openSearch(e,t){await o.ViewManager.ViewManager.instance().showView("network.search-network-tab");const i=qr.instance();return i.toggle(e,Boolean(t)),i}createScope(){return new or}}var Fr=Object.freeze({__proto__:null,NetworkPanel:ur,displayScreenshotDelay:pr,ContextMenuProvider:Cr,RequestRevealer:Sr,RequestIdRevealer:Tr,NetworkLogWithFilterRevealer:yr,FilmStripRecorder:Rr,ActionDelegate:Ir,RequestLocationRevealer:xr,SearchNetworkView:qr});export{V as BinaryResourceView,j as BlockedURLsPane,te as EventSourceMessagesView,ce as NetworkConfigView,ke as NetworkDataGridNode,vi as NetworkFrameGrouper,pi as NetworkItemView,er as NetworkLogView,zi as NetworkLogViewColumns,Ti as NetworkManageCustomHeadersView,Li as NetworkOverview,Fr as NetworkPanel,nr as NetworkSearchScope,Wt as NetworkTimeCalculator,Pi as NetworkWaterfallColumn,Re as RequestCookiesView,rt as RequestHTMLView,Be as RequestHeadersView,et as RequestInitiatorView,Ke as RequestPayloadView,Lt as RequestPreviewView,dt as RequestResponseView,Xt as RequestTimingView,li as ResourceWebSocketFrameView,vt as SignedExchangeInfoView};
